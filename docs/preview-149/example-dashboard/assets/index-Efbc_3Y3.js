var pt=Object.defineProperty;var ft=(s,r,t)=>r in s?pt(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t;var A=(s,r,t)=>ft(s,typeof r!="symbol"?r+"":r,t);import{r as _t,g as Ke,a as _,b as gt,u as We,L as Z,O as xt,c as Xe,d as vt,H as bt,e as yt,f as Y,R as jt}from"./react-DOgvK_Td.js";import{S as V,F as $,f as wt,a as Nt,b as He,r as St,c as kt,d as At,L as q,e as Rt,g as Et,h as Ct,i as Tt,j as ie,k as oe,l as ae,m as le,n as Mt,o as Ye,p as Ge,O as $t}from"./vendor-BSr5Gcgy.js";import{d as Je,a as qe,b as Qe,c as Lt,o as Ze,l as et,q as Pt,e as Ft,f as Bt,g as It,h as Dt,i as Ot,j as Vt,s as zt}from"./d3-CO-FEQw9.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var be={exports:{}},te={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Le;function Ut(){if(Le)return te;Le=1;var s=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function t(n,i,o){var c=null;if(o!==void 0&&(c=""+o),i.key!==void 0&&(c=""+i.key),"key"in i){o={};for(var l in i)l!=="key"&&(o[l]=i[l])}else o=i;return i=o.ref,{$$typeof:s,type:n,key:c,ref:i!==void 0?i:null,props:o}}return te.Fragment=r,te.jsx=t,te.jsxs=t,te}var Pe;function Kt(){return Pe||(Pe=1,be.exports=Ut()),be.exports}var e=Kt();Array.prototype.sortKey||(Array.prototype.sortKey=function(s){return this.sort((r,t)=>{const n=s(r),i=s(t);if(Array.isArray(n)&&Array.isArray(i)){for(let o=0;o<Math.min(n.length,i.length);o++){if(n[o]<i[o])return-1;if(n[o]>i[o])return 1}return 0}return n<i?-1:n>i?1:0})});var Wt=_t();const Xt=Ke(Wt);function Ee(){const[s,r]=_.useState(!1);return _.useEffect(()=>{function t(){r(window.matchMedia("(max-width: 768px)").matches)}return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),s}function he({value:s,onChange:r,options:t}){const n=Ee();return e.jsx("div",{className:"scale-toggle",children:t.map(i=>e.jsx("button",{className:`scale-toggle__button${s===i.value?" scale-toggle__button--active":""}`,onClick:()=>{if(t.length==2&&s===i.value){const o=t.find(c=>c.value!==i.value).value;r(o)}else r(i.value)},children:n?i.mobileContent??i.content:i.content},String(i.value)))})}const tt=_.createContext(null);function Ht({state:s}){return s.visible?gt.createPortal(e.jsx("div",{className:"cursor-tooltip",style:{position:"fixed",left:`${s.x+10}px`,top:`${s.y-28}px`,display:"block",pointerEvents:"none",zIndex:9999},dangerouslySetInnerHTML:{__html:s.content}}),document.body):null}function Yt({children:s}){const[r,t]=_.useState({visible:!1,content:"",x:0,y:0,owner:null}),c={showTooltip:(l,a,d,h)=>{t({visible:!0,content:l,x:a,y:d,owner:h})},hideTooltip:l=>{t(a=>a.owner===l?{...a,visible:!1,owner:null}:a)},moveTooltip:(l,a,d)=>{t(h=>h.visible&&h.owner===d?{...h,x:l,y:a}:h)},visible:r.visible};return e.jsxs(tt.Provider,{value:c,children:[s,e.jsx(Ht,{state:r})]})}function Ce(){const s=_.useContext(tt);if(!s)throw new Error("useTooltip must be used within a TooltipProvider");return s}function st(s,r=0){return Array.from(s).reduce((t,n)=>t+n,r)}function Se(s,r){let t=null;for(let n=0;n<s.length;n++){const i=s[n],o=r?r(i):i;o!=null&&(t===null||o>t)&&(t=o)}return t}function ye(s,r,t){let n=0,i=s.length;for(;n<i;){const o=n+i>>>1;(t?t(s[o])<=r:s[o]<=r)?n=o+1:i=o}return n}let se=null;function Gt(){return se||(se=document.createElement("div"),se.style.cssText=`
      position: absolute;
      visibility: hidden;
      white-space: nowrap;
      top: -9999px;
      left: -9999px;
      pointer-events: none;
      z-index: -1;
    `,document.body.appendChild(se)),se}function je(s,r=""){const t=Gt();t.className=r,t.textContent=s;const n=t.getBoundingClientRect();return{width:n.width,height:n.height}}function nt(s,r,t){s.metaKey||s.ctrlKey?window.open(r,"_blank"):t(r)}function rt(s){return s.split("::").pop()||s}class it{constructor(r,t,n,i){A(this,"createdAt");this.name=r,this.predicate=t,this.component=n,this.extraData=i,this.createdAt=Date.now()}}const ot=_.createContext(void 0);function Jt({children:s}){const[r,t]=_.useState(new Map([["covering",new Map],["rolling",new Map]])),[n,i]=_.useState("covering"),o=r.get(n)||new Map,c=d=>{t(h=>{const g=new Map(h);return g.set(n,d),g})},a={filters:o,setFilters:c,removeFilter:(d,h)=>{const g=new Map(o),m=(g.get(d)||[]).filter(p=>p.name!==h);m.length===0?g.delete(d):g.set(d,m),c(g)},observationCategory:n,setObservationCategory:i};return e.jsx(ot.Provider,{value:a,children:s})}function _e(){const s=_.useContext(ot);if(s===void 0)throw new Error("useFilters must be used within a FilterProvider");return s}const X={select:Je,scaleLinear:et,scaleOrdinal:Ze,scaleBand:Lt,axisBottom:Qe,axisLeft:qe},Fe=5,W=2.5;function qt({feature:s,observations:r}){const t=_.useRef(null),n=_.useRef(null),{filters:i,setFilters:o}=_e(),{showTooltip:c,hideTooltip:l,moveTooltip:a}=Ce(),d=i.get(s)||[],h=_.useMemo(()=>{if(d.length===0)return V();console.assert(d.length===1);const m=d[0];return V(m.extraData.selectedValues)},[d]),g=_.useMemo(()=>({raw:r.raw.filter(m=>m.status!=="gave_up"),filtered:r.filtered.filter(m=>m.status!=="gave_up")}),[r]),v=m=>{let p=V();h.equals(V([m]))?p=V():p=V([m]);let k;p.size===1?k=p.first():k=p.map(b=>`${b}`).join(" or ");const w=[];p.size>0&&w.push(new it(k,b=>p.some(j=>b.features.get(s)===j),s,{selectedValues:p}));const u=new Map(i);u.set(s,w),o(u)};return _.useEffect(()=>{const m=V(g.raw.map(x=>x.features.get(s)));let p=new Map;for(const x of g.filtered){const N=x.features.get(s);p.set(N,(p.get(N)||0)+1)}const k=st(Array.from(p.values()));p=new Map([...p.entries()].sortKey(([x,N])=>x===me?0:x===pe?1:x)),X.select(n.current).selectAll("*").remove();const w=t.current.clientWidth,u=m.size<Fe?85:170,b=X.select(n.current).attr("width",w).attr("height",u).append("g"),j=function(x,N){const[B,R]=N;c(`${s}<br>${B}: ${R}`,x.clientX,x.clientY,"tyche-nominal")};if(m.size<Fe){const x={top:0,right:15,bottom:20,left:15},N=w-x.left-x.right,B=u-x.top-x.bottom,R=X.scaleLinear().domain([0,1]).range([0,N]);let P;p.has(me)||p.has(pe)?P=D=>D===me?O.SUCCESS:D===pe?O.ERROR:O.PRIMARY:P=X.scaleOrdinal().domain(Array.from(p.keys())).range([O.PRIMARY,O.ACCENT,O.ACCENT2,O.ACCENT3,O.ACCENT4]);const F=b.append("g").attr("transform",`translate(${x.left},${x.top})`);let M=0;const E=B-x.bottom;p.forEach((D,f)=>{const y=D/k*N,C=h.has(f);F.append("rect").attr("x",M).attr("y",0).attr("width",y).attr("height",E).attr("fill",P(f)).style("cursor","pointer").on("click",()=>v(f)).on("mouseover",T=>{j(T,[f,D])}).on("mousemove",T=>a(T.clientX,T.clientY,"tyche-nominal")).on("mouseleave",()=>l("tyche-nominal")),C&&F.append("rect").attr("x",M+W).attr("y",W).attr("width",y-2*W).attr("height",E-2*W).attr("fill",P(f)).attr("stroke","white").attr("stroke-width",W).style("pointer-events","none"),F.append("text").attr("x",M+y/2).attr("y",E/2).attr("text-anchor","middle").attr("dominant-baseline","central").attr("fill","white").text(f).style("font-size","12px"),M+=y}),F.append("g").attr("transform",`translate(0,${E})`).call(X.axisBottom(R).tickFormat(D=>`${Math.round(Number(D)*100)}%`)),F.append("text").attr("x",N/2).attr("y",E+30).attr("text-anchor","middle").text("% of observations").style("font-size","12px")}else{const x={top:5,right:5,bottom:30,left:30},N=w-x.left-x.right,B=u-x.top-x.bottom,R=X.scaleBand().domain(Array.from(p.keys())).range([0,N]).padding(.2),P=X.scaleLinear().domain([0,Se(Array.from(p.values()))||0]).range([B,0]),F=b.append("g").attr("transform",`translate(${x.left},${x.top})`);F.selectAll(".bar").data(Array.from(p.entries())).enter().append("rect").attr("class","bar").attr("x",([M,E])=>R(M)||0).attr("y",([M,E])=>P(E)).attr("width",R.bandwidth()).attr("height",([M,E])=>B-P(E)).attr("fill",O.PRIMARY).style("cursor","pointer").on("click",function(M,[E,D]){v(E)}).on("mouseover",function(M,E){j(M,E)}).on("mousemove",M=>a(M.clientX,M.clientY,"tyche-nominal")).on("mouseleave",()=>l("tyche-nominal")),F.selectAll(".inner-bar").data(Array.from(p.entries()).filter(([M,E])=>h.has(M))).enter().append("rect").attr("class","inner-bar").attr("x",([M,E])=>(R(M)||0)+W).attr("y",([M,E])=>P(E)+W).attr("width",R.bandwidth()-2*W).attr("height",([M,E])=>B-P(E)-2*W).attr("fill",O.PRIMARY).attr("stroke","white").attr("stroke-width",W).style("pointer-events","none"),F.append("g").attr("transform",`translate(0,${B})`).call(X.axisBottom(R)).selectAll("text").attr("transform","rotate(-45)").style("text-anchor","end"),F.append("g").call(X.axisLeft(P).ticks(7).tickFormat(M=>Math.round(Number(M)).toString())),F.append("text").attr("transform","rotate(-90)").attr("y",-30).attr("x",-B/2).attr("text-anchor","middle").text("Count").style("font-size","12px")}},[g]),e.jsxs("div",{children:[e.jsx("div",{className:"tyche__nominal__feature",children:s}),e.jsx("div",{ref:t,className:"tyche__nominal__chart",children:e.jsx("svg",{ref:n,style:{width:"100%"}})})]})}function Qt({title:s,children:r,defaultState:t="open",onStateChange:n,headerClass:i="",contentClass:o=""}){const[c,l]=_.useState(t),a=()=>{const d=c==="open"?"closed":"open";l(d),n==null||n(d)};return e.jsxs("div",{children:[e.jsxs("div",{className:`collapsible__header ${i}`,onClick:a,children:[e.jsx("span",{className:"collapsible__toggle",children:c==="open"?e.jsx($,{icon:wt}):e.jsx($,{icon:Nt})}),s]}),c==="open"&&e.jsx("div",{className:`${o}`,children:r})]})}function Te({title:s,children:r,defaultState:t="open",onStateChange:n}){return e.jsx("div",{className:"tyche__section",children:e.jsx(Qt,{title:s,defaultState:t,onStateChange:n,headerClass:"tyche__section__header",contentClass:"tyche__section__content",children:r})})}function Zt({observations:s}){const r=new Set;return s.raw.forEach(t=>{for(const n of t.features.keys())n.startsWith("Retried draw from")||r.add(n)}),r.size===0?null:e.jsx(Te,{title:"Features",children:Array.from(r).sort().map(t=>e.jsx(qt,{feature:t,observations:s}))})}function es(){const{filters:s,removeFilter:r}=_e(),t=Array.from(s.values()).flat().sortKey(n=>n.createdAt);return t.length===0?null:e.jsxs("div",{className:"tyche__filters",children:[e.jsx("div",{className:"tyche__filters__title",children:"Current Filters"}),t.map(n=>e.jsxs("div",{className:"tyche__filters__filter",children:[e.jsxs("div",{className:"tyche__filters__filter__component",children:[e.jsx("div",{className:"tyche__filters__filter__remove",onClick:()=>r(n.component,n.name),children:e.jsx($,{icon:He})}),n.component]}),e.jsx("div",{className:"tyche__filters__filter__name",children:n.name})]},`${n.component}-${n.name}`))]})}var ts=St();const ce=Ke(ts);function at(s){const r=s.regex,t=new RegExp("[\\p{XID_Start}_]\\p{XID_Continue}*","u"),n=["and","as","assert","async","await","break","case","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","is","lambda","match","nonlocal|10","not","or","pass","raise","return","try","while","with","yield"],l={$pattern:/[A-Za-z]\w+|__\w+__/,keyword:n,built_in:["__import__","abs","all","any","ascii","bin","bool","breakpoint","bytearray","bytes","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","exec","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip"],literal:["__debug__","Ellipsis","False","None","NotImplemented","True"],type:["Any","Callable","Coroutine","Dict","List","Literal","Generic","Optional","Sequence","Set","Tuple","Type","Union"]},a={className:"meta",begin:/^(>>>|\.\.\.) /},d={className:"subst",begin:/\{/,end:/\}/,keywords:l,illegal:/#/},h={begin:/\{\{/,relevance:0},g={className:"string",contains:[s.BACKSLASH_ESCAPE],variants:[{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?'''/,end:/'''/,contains:[s.BACKSLASH_ESCAPE,a],relevance:10},{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?"""/,end:/"""/,contains:[s.BACKSLASH_ESCAPE,a],relevance:10},{begin:/([fF][rR]|[rR][fF]|[fF])'''/,end:/'''/,contains:[s.BACKSLASH_ESCAPE,a,h,d]},{begin:/([fF][rR]|[rR][fF]|[fF])"""/,end:/"""/,contains:[s.BACKSLASH_ESCAPE,a,h,d]},{begin:/([uU]|[rR])'/,end:/'/,relevance:10},{begin:/([uU]|[rR])"/,end:/"/,relevance:10},{begin:/([bB]|[bB][rR]|[rR][bB])'/,end:/'/},{begin:/([bB]|[bB][rR]|[rR][bB])"/,end:/"/},{begin:/([fF][rR]|[rR][fF]|[fF])'/,end:/'/,contains:[s.BACKSLASH_ESCAPE,h,d]},{begin:/([fF][rR]|[rR][fF]|[fF])"/,end:/"/,contains:[s.BACKSLASH_ESCAPE,h,d]},s.APOS_STRING_MODE,s.QUOTE_STRING_MODE]},v="[0-9](_?[0-9])*",m=`(\\b(${v}))?\\.(${v})|\\b(${v})\\.`,p=`\\b|${n.join("|")}`,k={className:"number",relevance:0,variants:[{begin:`(\\b(${v})|(${m}))[eE][+-]?(${v})[jJ]?(?=${p})`},{begin:`(${m})[jJ]?`},{begin:`\\b([1-9](_?[0-9])*|0+(_?0)*)[lLjJ]?(?=${p})`},{begin:`\\b0[bB](_?[01])+[lL]?(?=${p})`},{begin:`\\b0[oO](_?[0-7])+[lL]?(?=${p})`},{begin:`\\b0[xX](_?[0-9a-fA-F])+[lL]?(?=${p})`},{begin:`\\b(${v})[jJ](?=${p})`}]},w={className:"comment",begin:r.lookahead(/# type:/),end:/$/,keywords:l,contains:[{begin:/# type:/},{begin:/#/,end:/\b\B/,endsWithParent:!0}]},u={className:"params",variants:[{className:"",begin:/\(\s*\)/,skip:!0},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:["self",a,k,g,s.HASH_COMMENT_MODE]}]};return d.contains=[g,k,a],{name:"Python",aliases:["py","gyp","ipython"],unicodeRegex:!0,keywords:l,illegal:/(<\/|\?)|=>/,contains:[a,k,{scope:"variable.language",match:/\bself\b/},{beginKeywords:"if",relevance:0},{match:/\bor\b/,scope:"keyword"},g,w,s.HASH_COMMENT_MODE,{match:[/\bdef/,/\s+/,t],scope:{1:"keyword",3:"title.function"},contains:[u]},{variants:[{match:[/\bclass/,/\s+/,t,/\s*/,/\(\s*/,t,/\s*\)/]},{match:[/\bclass/,/\s+/,t]}],scope:{1:"keyword",3:"title.class",6:"title.class.inherited"}},{className:"meta",begin:/^[\t ]*@/,end:/(?=#)|$/,contains:[k,u,g]}]}}function Be({currentPage:s,pageCount:r,onPageChange:t}){console.assert(r>1);function n(){return r<=7?Array.from({length:r},(a,d)=>d):s<=3?[0,1,2,3,4,"ellipsis",r-1]:s>=r-4?[0,"ellipsis",r-5,r-4,r-3,r-2,r-1]:[0,"ellipsis",s-1,s,s+1,"ellipsis",r-1]}const i=n();function o(a){typeof a=="number"&&s!==a&&t(a)}function c(){s>0&&t(s-1)}function l(){s<r-1&&t(s+1)}return e.jsxs("div",{className:"pagination",children:[e.jsx("div",{className:`pagination__nav pagination__nav--left ${s===0?"pagination__nav--disabled":""}`,onClick:c,children:e.jsx($,{icon:kt})}),i.map((a,d)=>{if(a==="ellipsis")return e.jsx("div",{className:" pagination__ellipsis",children:"..."},`ellipsis-${d}`);const h=a===s;return e.jsx("div",{className:`pagination__number ${h?"pagination__number--current":""}`,onClick:()=>o(a),children:a+1},a)}),e.jsx("div",{className:`pagination__nav pagination__nav--right ${s===r-1?"pagination__nav--disabled":""}`,onClick:l,children:e.jsx($,{icon:At})})]})}ce.registerLanguage("python",at);const we=30;function ss({observations:s,observationCategory:r}){const t=_.useRef(null),[n,i]=_.useState(0);_.useEffect(()=>{i(0)},[r]);function o(){t.current&&t.current.querySelectorAll("code:not([data-highlighted='yes'])").forEach(d=>{ce.highlightElement(d)})}_.useEffect(()=>{o()},[s,n]);const c=new Map;s.filtered.forEach(d=>{const h=d.representation;c.set(h,(c.get(h)||0)+1)});const l=Math.ceil(c.size/we),a=Array.from(c.entries()).sortKey(([d,h])=>-h).slice(n*we,(n+1)*we);return e.jsx(Te,{title:"Textual representation",defaultState:"closed",onStateChange:d=>{d==="open"&&requestAnimationFrame(()=>{o()})},children:e.jsxs("div",{ref:t,children:[l>1&&e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"12px"},children:e.jsx(Be,{currentPage:n,pageCount:l,onPageChange:i})}),a.map(([d,h])=>e.jsxs("div",{style:{position:"relative"},className:"tyche__representation__example",children:[e.jsx("pre",{children:e.jsx("code",{className:"language-python",children:d})}),h>1&&e.jsxs("div",{className:"tyche__representation__example__count",children:["x ",h]})]},d)),l>1&&e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"12px"},children:e.jsx(Be,{currentPage:n,pageCount:l,onPageChange:i})})]})})}const Ie=640;function ns({name:s,observations:r,verticalAxis:t,horizontalAxis:n,cssStyle:i=(o,c)=>({})}){const{filters:o,setFilters:c}=_e(),{showTooltip:l,hideTooltip:a,moveTooltip:d}=Ce(),h=o.get(s)||[],g=_.useMemo(()=>{if(h.length===0)return V();console.assert(h.length===1);const f=h[0];return V(f.extraData.selectedCells)},[h]),v=[],m=Array(t.length).fill(0),p=Array(n.length).fill(0);let k=0;for(let f=0;f<t.length;f++){v[f]=[];for(let y=0;y<n.length;y++)v[f][y]={count:0,widthPercent:0}}r.filtered.forEach(f=>{for(let y=0;y<t.length;y++){const[,C]=t[y];if(C(f)){for(let T=0;T<n.length;T++){const[,U]=n[T];if(U(f)){v[y][T].count++,m[y]++,p[T]++,k++;break}}break}}});const w=m.map((f,y)=>f>0?y:null).filter(f=>f!==null),u=p.map((f,y)=>f>0?y:null).filter(f=>f!==null),b=(f,y)=>{let C=V();if(f!==null&&y!==null){const S=q([f,y]);g.equals(V([S]))?C=V():C=V([S])}else f!==null?(console.assert(y===null),u.forEach(S=>{v[f][S].count>0&&(C=C.add(q([f,S])))})):y!==null&&(console.assert(f===null),w.forEach(S=>{v[S][y].count>0&&(C=C.add(q([S,y])))}));function T(){if(C.size===0)return"";let S=C;const K=[],ue=[...w.map(I=>({name:t[I][0],cells:u.filter(z=>v[I][z].count>0).map(z=>q([I,z]))})),...u.map(I=>({name:n[I][0],cells:w.filter(z=>v[z][I].count>0).map(z=>q([z,I]))}))];for(const I of ue)I.cells.length>0&&I.cells.every(z=>S.has(z))&&(K.push(I.name),S=S.subtract(V(I.cells)));for(;S.size>0;){const I=S.first(),[z,ve]=I.toArray();K.push(`${t[z][0]}+${n[ve][0]}`),S=S.delete(I)}return console.assert(S.size==0),K.join(" or ")}const U=[];C.size>0&&U.push(new it(T(),S=>C.some(K=>{const[ue,I]=K.toArray(),z=t[ue][1],ve=n[I][1];return z(S)&&ve(S)}),s,{selectedCells:C}));const H=new Map(o);H.set(s,U),c(H)};if(w.length===0||u.length===0)return e.jsx("div",{children:"No observations"});const j=30,x=30,N=45*w.length;for(let f=0;f<t.length;f++)for(let y=0;y<n.length;y++)v[f][y].widthPercent=m[f]>0?v[f][y].count/m[f]*100:0;const R=w.map(f=>m[f]/k*N).map(f=>Math.max(f,x)),P=u.map((f,y)=>y===0?0:y===u.length-1?100:y/(u.length-1)*100),{rowHeaderWidth:F,columnHeaderHeight:M,rowTotalWidth:E}=_.useMemo(()=>({rowHeaderWidth:Math.max(...w.map(f=>je(t[f][0],"tyche__mosaic__row-header").width)),columnHeaderHeight:Math.max(...u.map(f=>je(n[f][0],"tyche__mosaic__column-header").height)),rowTotalWidth:Math.max(...w.map(f=>je(m[f].toString(),"tyche__mosaic__row-total").width))}),[w,u,t,n,m]),D=Ie-F-E;return w.forEach(f=>{const y=u.map(T=>v[f][T]);if(y.reduce((T,U)=>T+U.widthPercent,0)>0){const U=y.map(S=>S.widthPercent/100*D).map((S,K)=>y[K].count>0&&S>0&&S<j?j:S),H=U.reduce((S,K)=>S+K,0);u.forEach((S,K)=>{v[f][S].widthPercent=H>0?U[K]/H*100:0})}}),e.jsxs("div",{className:"tyche__mosaic__container",style:{maxWidth:`${Ie}px`},children:[e.jsx("div",{className:"tyche__mosaic__column-headers",style:{marginLeft:`${F}px`,marginRight:`${E}px`,height:`${M}px`},children:u.map((f,y)=>{const C=y===0,T=y===u.length-1;return e.jsx("div",{className:"tyche__mosaic__column-header",style:{left:`${P[y]}%`,transform:C?"translateX(0%)":T?"translateX(-100%)":"translateX(-50%)",textAlign:C?"left":T?"right":"center"},onClick:()=>b(null,f),children:n[f][0]},`header-${f}`)})}),w.map((f,y)=>e.jsxs("div",{className:"tyche__mosaic__row",style:{height:`${R[y]}px`},children:[e.jsx("div",{className:"tyche__mosaic__row-header",style:{width:`${F}px`,cursor:"pointer"},onClick:()=>b(f,null),children:t[f][0]}),e.jsx("div",{className:"tyche__mosaic__row-cells",children:u.map(C=>{const T=v[f][C];if(T.count===0)return null;const U=g.has(q([f,C])),H=`${t[f][0]} and ${n[C][0]}<br>Count: ${T.count}`;return e.jsx("div",{className:`tyche__mosaic__cell${U?" tyche__mosaic__cell--selected":""}`,style:{width:`${T.widthPercent}%`,minWidth:`${j}px`,minHeight:`${x}px`,...i(t[f][0],n[C][0])},onClick:()=>b(f,C),onMouseEnter:S=>l(H,S.clientX,S.clientY,"tyche-mosaic"),onMouseMove:S=>d(S.clientX,S.clientY,"tyche-mosaic"),onMouseLeave:()=>a("tyche-mosaic"),children:e.jsx("span",{className:"tyche__mosaic__cell-value",children:T.count})},`cell-${f}-${C}`)})}),e.jsx("div",{className:"tyche__mosaic__row-total",style:{width:`${E}px`},children:m[f]})]},`row-${f}`)),e.jsxs("div",{className:"tyche__mosaic__column-totals-row",style:{height:`${M}px`},children:[e.jsx("div",{style:{width:`${F}px`}}),e.jsx("div",{className:"tyche__mosaic__column-totals",style:{marginRight:`${E}px`},children:u.map((f,y)=>{const C=y===0,T=y===u.length-1;return e.jsx("div",{className:"tyche__mosaic__column-total",style:{left:`${P[y]}%`,transform:C?"translateX(0%)":T?"translateX(-100%)":"translateX(-50%)",textAlign:C?"left":T?"right":"center"},children:p[f]},`total-${f}`)})}),e.jsx("div",{className:"tyche__mosaic__grand-total",style:{width:`${E}px`},children:k})]})]})}function rs({observations:s}){function r(t,n){const i={};return t==="Passed"?i.backgroundColor=O.SUCCESS:t==="Invalid"?i.backgroundColor=O.WARNING:t==="Failed"&&(i.backgroundColor=O.ERROR),n==="Duplicate"&&(i.opacity=.7),i}return e.jsx(Te,{title:"Sample breakdown",children:e.jsx(ns,{name:"samples",observations:s,verticalAxis:[["Passed",t=>t.status==="passed"],["Invalid",t=>t.status==="gave_up"]],horizontalAxis:[["Unique",t=>t.isUnique??!1],["Duplicate",t=>t.isDuplicate??!1]],cssStyle:r})})}const me="Present",pe="Not present";var O=(s=>(s.PRIMARY="#6b8ab5",s.SUCCESS="#8ba86b",s.WARNING="#d59a7e",s.ERROR="#c77a7e",s.ACCENT="#c1a2bb",s.ACCENT2="#9fc7c6",s.ACCENT3="#edd39a",s.ACCENT4="#99c7d6",s.ACCENT5="#8faac6",s))(O||{});function is({test:s}){const{filters:r,observationCategory:t,setObservationCategory:n}=_e(),i=t==="rolling"?s.rolling_observations.sortKey(l=>-l.run_start):s.corpus_observations,o=_.useMemo(()=>{const l=Array.from(r.values()).flat();return l.length===0?i:i.filter(a=>l.every(d=>d.predicate(a)))},[i,r]),c={raw:i,filtered:o};return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:e.jsx("span",{children:"Observations"})}),e.jsx("div",{style:{paddingTop:"10px",paddingBottom:"10px",display:"flex",fontSize:"1.05rem",fontWeight:"500"},children:e.jsx(he,{value:t,onChange:n,options:[{value:"covering",content:"Covering"},{value:"rolling",content:"Rolling"}]})}),e.jsx(es,{}),c.raw.length>0?e.jsxs(e.Fragment,{children:[e.jsx(rs,{observations:c}),e.jsx(Zt,{observations:c}),e.jsx(ss,{observations:c,observationCategory:t})]}):e.jsx("div",{className:"tyche__section",children:"No observations"})]})}function os({test:s}){return e.jsx(Jt,{children:e.jsx(is,{test:s})})}class ge{withProperties(r){return Object.assign(Object.create(this.constructor.prototype),this,r)}}class J extends ge{constructor(r=new Map([[0,0],[1,0],[2,0],[3,0]])){super(),this.counts=r}static fromJson(r){const t=new Map([[0,0],[1,0],[2,0],[3,0]]);for(const[n,i]of Object.entries(r))console.assert(typeof i=="number"),t.set(Number(n),i);return new J(t)}add(r){const t=new Map(this.counts);for(const[n,i]of r.counts.entries())t.set(n,t.get(n)+i);return new J(t)}subtract(r){const t=new Map(this.counts);for(const[n,i]of r.counts.entries())t.set(n,t.get(n)-i);return new J(t)}sum(){return st(this.counts.values())}}var lt=(s=>(s[s.OVERRUN=0]="OVERRUN",s[s.INVALID=1]="INVALID",s[s.VALID=2]="VALID",s[s.INTERESTING=3]="INTERESTING",s))(lt||{});class xe extends ge{constructor(t,n,i,o,c,l,a,d){super();A(this,"status_counts_diff");A(this,"elapsed_time_diff");A(this,"timestamp_monotonic");this.elapsed_time=t,this.timestamp=n,this.status_counts=i,this.behaviors=o,this.fingerprints=c,this.since_new_branch=l,this.phase=a,this.worker_uuid=d,this.status_counts_diff=null,this.elapsed_time_diff=null,this.timestamp_monotonic=null}get ninputs(){return this.status_counts.sum()}static fromJson(t,n){return new xe(n.elapsed_time,n.timestamp,J.fromJson(n.status_counts),n.behaviors,n.fingerprints,n.since_new_branch,n.phase,t)}}function De(s,r){const t=r?r.status_counts:new J,n=r?r.elapsed_time:0,i=s.status_counts.subtract(t),o=s.elapsed_time-n,c=r?Math.max(s.timestamp,r.timestamp_monotonic+o):s.timestamp;return console.assert(Array.from(i.counts.values()).every(l=>l>=0)),console.assert(o>=0),s.withProperties({status_counts_diff:i,elapsed_time_diff:o,timestamp_monotonic:c})}class ee extends ge{constructor(t,n,i,o,c,l,a,d,h,g,v){super();A(this,"isDuplicate",null);A(this,"isUnique",null);this.type=t,this.status=n,this.status_reason=i,this.representation=o,this.arguments_=c,this.how_generated=l,this.features=a,this.timing=d,this.metadata=h,this.property=g,this.run_start=v}static fromJson(t){return new ee(t.type,t.status,t.status_reason,t.representation,new Map(Object.entries(t.arguments)),t.how_generated,new Map(Object.entries(t.features)),new Map(Object.entries(t.timing)),new Map(Object.entries(t.metadata)),t.property,Number(t.run_start))}}var fe=(s=>(s[s.FAILED=0]="FAILED",s[s.SHRINKING=1]="SHRINKING",s[s.RUNNING=2]="RUNNING",s[s.WAITING=3]="WAITING",s))(fe||{});const re=class re extends ge{constructor(t,n,i,o,c,l){super();A(this,"linear_reports");A(this,"_status_counts_cumsum");A(this,"_elapsed_time_cumsum");this.database_key=t,this.nodeid=n,this.rolling_observations=i,this.corpus_observations=o,this.failure=c,this.reports_by_worker=l,this.linear_reports=[],this._status_counts_cumsum=new Map,this._elapsed_time_cumsum=new Map;const a=this.reports_by_worker;this.reports_by_worker=new Map;const d=Array.from(a.entries()).flatMap(([h,g])=>g.map(v=>[h,v])).sortKey(([h,g])=>g.timestamp);for(const[h,g]of d)this.add_report(h,g);this._check_invariants()}static fromJson(t){return new re(t.database_key,t.nodeid,[],[],t.failure?ee.fromJson(t.failure):null,new Map(Object.entries(t.reports_by_worker).map(([n,i])=>[n,i.map(xe.fromJson)])))}_assert_reports_ordered(t){for(let n=0;n<t.length-1;n++)console.assert(t[n].timestamp_monotonic<=t[n+1].timestamp_monotonic)}_check_invariants(){this._assert_reports_ordered(this.linear_reports);const t=this.linear_status_counts(null);for(let i=0;i<t.length-1;i++)console.assert(t[i].sum()<=t[i+1].sum());const n=this.linear_elapsed_time(null);for(let i=0;i<n.length-1;i++)console.assert(n[i]<=n[i+1]);console.assert(n.length===t.length&&t.length===this.linear_reports.length);for(const[i,o]of this.reports_by_worker.entries())this._assert_reports_ordered(o)}add_report(t,n){let i=null,o=0;if(this.reports_by_worker.has(t)){const l=this.reports_by_worker.get(t);o=ye(l,n.elapsed_time,a=>a.elapsed_time),i=o!=0?l[o-1]:null}const c=De(n,i);if(this.reports_by_worker.has(t)||this.reports_by_worker.set(t,[]),this.reports_by_worker.get(t).splice(o,0,c),c.phase!=="replay"){const l=ye(this.linear_reports,c.timestamp_monotonic,a=>a.timestamp_monotonic);if(this.linear_reports.splice(l,0,c),l!=this.linear_reports.length-1){let a=null,d;for(d=0;d<this.linear_reports.length-(l+1);d++){const h=this.linear_reports[l+1+d];if(c.worker_uuid===h.worker_uuid){a=h;break}}a&&(console.assert(this.linear_reports[l+1+d]===a),this.linear_reports[l+1+d]=De(a,c));for(const h of[this._status_counts_cumsum,this._elapsed_time_cumsum])for(const[g,[v,m]]of h.entries())l>=v&&h.set(g,[v,m.slice(0,l-v)])}}}get status(){if(this.failure)return 0;if(this.linear_reports.length===0)return 3;const t=this.linear_reports[this.linear_reports.length-1],n=new Date().getTime()/1e3;return t.phase=="shrink"?1:t.ninputs===0||t.timestamp<n-re.WAITING_STATUS_DURATION?3:2}get behaviors(){return this.linear_reports.length===0?0:this.linear_reports[this.linear_reports.length-1].behaviors}get fingerprints(){return this.linear_reports.length===0?0:this.linear_reports[this.linear_reports.length-1].fingerprints}get since_new_branch(){return this.linear_reports.length===0?null:this.linear_reports[this.linear_reports.length-1].since_new_branch}elapsed_time(t){const n=this.linear_elapsed_time(t);return n.length===0?0:n[n.length-1]}ninputs(t){const n=this.linear_status_counts(t);return n.length===0?0:n[n.length-1].sum()}_cumsum(t,n,i,o,c){if(o===null&&(o=-1/0),t.has(o)){const[h,g]=t.get(o);if(g.length<this.linear_reports.slice(h).length){let v=g.length>0?g[g.length-1]:c;for(const m of this.linear_reports.slice(h+g.length))v=i(v,m[n]),g.push(v);t.set(o,[h,g])}return g}const l=[],a=ye(this.linear_reports,o,h=>h.timestamp_monotonic);let d=c;for(const h of this.linear_reports.slice(a))d=i(d,h[n]),l.push(d);return t.set(o,[a,l]),l}linear_status_counts(t){return this._cumsum(this._status_counts_cumsum,"status_counts_diff",(n,i)=>n.add(i),t,new J)}linear_elapsed_time(t){return this._cumsum(this._elapsed_time_cumsum,"elapsed_time_diff",(n,i)=>n+i,t,0)}};A(re,"WAITING_STATUS_DURATION",120);let ke=re;function as({message:s,onDismiss:r,isVisible:t}){const[n,i]=_.useState(t);return _.useEffect(()=>{if(t){i(!0);return}else{const o=setTimeout(()=>{i(!1)},300);return()=>clearTimeout(o)}},[t]),n?e.jsxs("div",{className:`notification ${t?"notification--visible":"notification--hidden"}`,onClick:r,children:[e.jsx("div",{className:"notification__content",children:s}),e.jsx("button",{className:"notification__close",onClick:o=>{o.stopPropagation(),r()},"aria-label":"Close notification",children:e.jsx($,{icon:He})})]}):null}const ct=_.createContext(null);function ls({children:s}){const[r,t]=_.useState([]),n=_.useRef(new Map),i=_.useRef(0),o=_.useCallback(a=>{clearTimeout(n.current.get(a)),n.current.delete(a),t(d=>d.filter(h=>h.id!==a))},[]),c=_.useCallback((a,d)=>{const h=++i.current,g={id:h,message:a,duration:d};if(t(v=>[...v,g]),d!==null){const v=setTimeout(()=>{o(h)},d);n.current.set(h,v)}return h},[o]),l=_.useCallback((a,d,h)=>{if(t(g=>g.map(v=>v.id===a?{...v,message:d,duration:h}:v)),h!==null){clearTimeout(n.current.get(a));const g=setTimeout(()=>{o(a)},h);n.current.set(a,g)}},[o]);return e.jsxs(ct.Provider,{value:{addNotification:c,updateNotification:l,dismissNotification:o},children:[s,e.jsx("div",{className:"notifications",children:r.map((a,d)=>e.jsx("div",{className:"notification-wrapper",style:{top:`${20+d*80}px`},children:e.jsx(as,{message:a.message,isVisible:!0,onDismiss:()=>o(a.id)})},a.id))})]})}function cs(){const s=_.useContext(ct);if(!s)throw new Error("useNotification must be used within a NotificationProvider");return s}const ut=_.createContext(null);function Oe(s){const r=new Map;s.forEach(n=>{r.set(n.representation,(r.get(n.representation)||0)+1)}),s.forEach(n=>{const i=r.get(n.representation);n.isUnique=i==1,n.isDuplicate=i>1});const t=new Set;s.forEach(n=>{n.features.forEach((i,o)=>{t.add(o)})}),s.forEach(n=>{t.forEach(i=>{n.features.has(i)||n.features.set(i,pe)});for(const[i,o]of n.features)o===""&&n.features.set(i,me)})}function us(s,r){const t=new Map(s);function n(i){if(t.has(i))return t.get(i);{const o=new ke(null,i,[],[],null,new Map);return t.set(o.nodeid,o),o}}switch(r.type){case 1:return s;case 2:{const{tests:i}=r;for(const{database_key:o,nodeid:c,failure:l}of i){const a=n(c);a.database_key=o,a.failure=l?ee.fromJson(l):null}return t}case 3:{const{nodeid:i,worker_uuid:o,reports:c}=r,l=n(i);for(const a of c)l.add_report(o,a);return t}case 5:{const{nodeid:i,failure:o}=r,c=n(i);return c.failure=o,t}case 4:{const{nodeid:i,observation_type:o,observations:c}=r,l=n(i);return o==="rolling"?(l.rolling_observations.push(...c),l.rolling_observations=l.rolling_observations.sortKey(a=>-a.run_start).slice(0,300),Oe(l.rolling_observations)):(console.assert(o==="corpus"),l.corpus_observations.push(...c),Oe(l.corpus_observations)),t}default:throw new Error("non-exhaustive switch in testsReducer")}}function ds({children:s}){const[r,t]=_.useState(null),[n,i]=_.useReducer(us,new Map),[o,c]=_.useState(!1),[l,a]=_.useState(null),{addNotification:d,updateNotification:h,dismissNotification:g}=cs();_.useRef(null);const v=_.useCallback(m=>{c(!0),a(m)},[]);return _.useEffect(()=>{if(o){n.clear();{fetch(new URL("dashboard_state/tests.json",import.meta.url)).then(p=>p.text()).then(p=>JSON.parse(p)).then(p=>{Object.entries(p).forEach(([k,w])=>{i({type:2,tests:[{database_key:w.database_key,nodeid:k,failure:w.failure}]});for(const[u,b]of Object.entries(w.reports_by_worker))i({type:3,nodeid:k,worker_uuid:u,reports:b.map(j=>xe.fromJson(u,j))})})});const m=new Worker(new URL("/preview-149/example-dashboard/assets/jsonWorker-KJVNTzbb.js",import.meta.url));return fetch(new URL("dashboard_state/observations.json",import.meta.url)).then(p=>p.text()).then(p=>new Promise(k=>{m.onmessage=w=>k(w.data),m.postMessage(p)})).then(p=>{for(const[k,w]of Object.entries(p))i({type:4,nodeid:k,observation_type:"rolling",observations:w.rolling.map(ee.fromJson)}),i({type:4,nodeid:k,observation_type:"corpus",observations:w.corpus.map(ee.fromJson)})}),()=>m.terminate()}}},[l,o]),e.jsx(ut.Provider,{value:{tests:n,socket:r,doLoadData:v},children:s})}function Me(s=null){const r=_.useContext(ut);if(!r)throw new Error("useData must be used within a DataProvider");return _.useEffect(()=>{r.doLoadData(s)},[s,r.doLoadData]),r}function de({to:s,children:r,isActive:t}){const n=We();return e.jsx(Z,{to:s,className:`sidebar__link ${t(n.pathname)?"sidebar__link--active":""}`,children:r})}function hs(){const s=We(),[r,t]=_.useState(!1),n=_.useRef(null);return _.useEffect(()=>{function i(o){var c;r&&((c=n.current)==null?void 0:c.contains(o.target))===!1&&t(!1)}return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[r]),_.useEffect(()=>{t(!1)},[s]),e.jsxs("div",{className:"layout",children:[!r&&e.jsx("div",{className:"toggle-sidebar",onClick:()=>t(!0),children:e.jsx($,{icon:Rt,size:"lg"})}),r&&e.jsx("div",{className:"opacity-overlay"}),e.jsxs("div",{ref:n,className:`sidebar ${r?"sidebar--open":""}`,children:[e.jsx(Z,{to:"/",className:"sidebar__title",children:"HypoFuzz"}),e.jsxs("nav",{className:"sidebar__nav",children:[e.jsx(de,{to:"/",isActive:i=>i==="/"||i.startsWith("/tests/"),children:"Tests"}),e.jsx(de,{to:"/patches",isActive:i=>i==="/patches",children:"Patches"}),e.jsx(de,{to:"/collected",isActive:i=>i==="/collected",children:"Collection"}),e.jsx(de,{to:"/workers",isActive:i=>i==="/workers",children:"Workers"}),e.jsx("div",{className:"sidebar__separator"}),e.jsx("a",{href:`${"/preview-149/example-dashboard".replace(/\/$/,"")}/docs/`,className:"sidebar__link",children:"Docs"})]})]}),e.jsx("div",{className:"content",children:e.jsx(xt,{})})]})}function $e({headers:s,data:r,row:t,mobileRow:n,getKey:i,onFilterChange:o,filterStrings:c}){const[l,a]=_.useState(null),[d,h]=_.useState(0),[g,v]=_.useState(""),m=Ee(),p=_.useMemo(()=>{let u=r;if(g&&(u=r.filter(j=>c?c(j).some(x=>x.toLowerCase().includes(g.toLowerCase())):!0)),l===null)return u;const b=[...u].sortKey(j=>s[l].sortKey(j));return d===0?b:b.reverse()},[r,l,d,s,g,t,c,n,m]),k=u=>{s[u].sortKey&&(l===u?h(b=>b===0?1:0):(a(u),h(0)))};function w(u){v(u),o==null||o(u)}return e.jsxs("div",{className:"table",children:[c!==void 0&&e.jsxs("div",{className:"table__filter",children:[e.jsx("input",{type:"text",placeholder:"Filter",value:g,onChange:u=>w(u.target.value),className:"table__filter__input"}),g&&e.jsx("span",{className:"table__filter__clear",onClick:()=>w(""),children:e.jsx($,{icon:Et})})]}),n!==void 0&&m?p.map(u=>e.jsx("div",{children:n(u)},i?i(u):void 0)):e.jsxs("table",{className:"table__table",children:[e.jsx("thead",{children:e.jsx("tr",{children:s.map((u,b)=>e.jsx("th",{onClick:()=>k(b),className:u.sortKey?"table--sortable":"",children:e.jsxs("div",{className:`table__header table__header--${u.align??"left"}`,children:[u.content,u.sortKey&&e.jsx("div",{className:"table__sort",children:[0,1].map(j=>e.jsx("div",{className:`table__sort__arrow table__sort__arrow--${j===0?"asc":"desc"} ${l===b&&d===j?"table__sort__arrow--active":""}`,children:j===0?e.jsx($,{icon:Ct}):e.jsx($,{icon:Tt})}))})]})},b))})}),e.jsx("tbody",{children:p.map(u=>{const b=t(u);return console.assert(b.length===s.length),e.jsx("tr",{children:b.map((j,x)=>e.jsx("td",{children:j},x))},i?i(u):void 0)})})]}),g&&p.length<r.length&&e.jsxs("div",{className:"table__filter-status",children:["Showing ",p.length," of ",r.length," rows",e.jsx("span",{className:"table__filter-status__clear",onClick:()=>{v(""),o==null||o("")},children:"[clear]"})]})]})}async function dt(s){return(await(await fetch(new URL("dashboard_state/api.json",import.meta.url))).json())[s.replace(/\/$/,"")]}const Ve={not_collected:0,collected:1};function ms(){const[s,r]=_.useState(null);if(_.useEffect(()=>{dt("collected_tests/").then(o=>{r(o)})},[]),s===null)return null;if(!s.collection_status.length)return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:"Test collection"}),"No tests collected."]});const t=[...s.collection_status].sortKey(o=>[Ve[o.status],o.status_reason,o.nodeid]),n=[{content:"Test",sortKey:o=>o.nodeid},{content:"Status",sortKey:o=>[Ve[o.status],o.status_reason],align:"center"}],i=o=>[e.jsx("div",{style:{wordBreak:"break-all"},children:o.status=="collected"?e.jsx(Z,{to:`/tests/${encodeURIComponent(o.nodeid)}`,className:"test__link",children:o.nodeid}):o.nodeid}),e.jsx("div",{style:{textAlign:"center"},children:o.status==="collected"?e.jsx("div",{className:"pill pill__success",children:"Collected"}):e.jsxs("div",{className:"pill pill__neutral",children:["Not collected (",o.status_reason,")"]})})];return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:"Test collection status"}),e.jsx($e,{headers:n,data:t,row:i,getKey:o=>o.database_key,filterStrings:o=>[o.nodeid,o.status==="collected"?"Collected":`Not collected (${o.status_reason})`]})]})}function ps(){return e.jsx("h1",{children:"Page not found!"})}function fs(s){const r=s.regex;return{name:"Diff",aliases:["patch"],contains:[{className:"meta",relevance:10,match:r.either(/^@@ +-\d+,\d+ +\+\d+,\d+ +@@/,/^\*\*\* +\d+,\d+ +\*\*\*\*$/,/^--- +\d+,\d+ +----$/)},{className:"comment",variants:[{begin:r.either(/Index: /,/^index/,/={3,}/,/^-{3}/,/^\*{3} /,/^\+{3}/,/^diff --git/),end:/$/},{match:/^\*{15}$/}]},{className:"addition",begin:/^\+/,end:/$/},{className:"deletion",begin:/^-/,end:/$/},{className:"addition",begin:/^!/,end:/$/}]}}ce.registerLanguage("diff",fs);function _s(){const[s,r]=_.useState({}),[t,n]=_.useState(!0);return _.useEffect(()=>{dt("patches").then(i=>{i&&r(i),n(!1)})},[]),_.useEffect(()=>{ce.highlightAll()},[s]),t?e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:"Patches"}),e.jsx("p",{children:"Loading patches..."})]}):Object.values(s).length==0?e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:"Patches"}),e.jsx("p",{children:"No patches yet"})]}):e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:"Patches"}),e.jsx("div",{className:"patches-list",children:Object.entries(s).map(([i,o])=>e.jsxs("div",{className:"patch",children:[e.jsx("h3",{children:i}),e.jsx("pre",{children:e.jsx("code",{className:"language-diff",children:o})})]},i))})]})}function Ne(s,r){const[t,n]=_.useState(()=>{const i=sessionStorage.getItem(s);return i===null?r:JSON.parse(i)});return _.useEffect(()=>{sessionStorage.setItem(s,JSON.stringify(t))},[t,s]),[t,n]}const L={scaleSymlog:zt,scaleLinear:et,select:Je,zoom:Vt,zoomIdentity:Ot,pointer:Dt,line:It,axisBottom:Qe,axisLeft:qe,brush:Bt,scaleOrdinal:Ze,schemeCategory10:Ft,quadtree:Pt};typeof window<"u"&&window.addEventListener("mousemove",s=>{s.clientX,s.clientY});const gs=10;function ze(s,r,t="horizontal",n=12,i=6){const o=s.node().getBBox(),c=L.select(s.node().parentNode);let l,a;l=o.x-n-i,a=o.y+(o.height-n)/2,c.append("svg").attr("x",l).attr("y",a).attr("width",n).attr("height",n).attr("viewBox",`0 0 ${r.icon[0]} ${r.icon[1]}`).append("path").attr("d",r.icon[4])}class xs{constructor(r,t,n,i,o,c,l,a){A(this,"reports");A(this,"scaleSetting");A(this,"axisSettingX");A(this,"axisSettingY");A(this,"xValue");A(this,"yValue");A(this,"width");A(this,"height");A(this,"margin");A(this,"x");A(this,"y");A(this,"g");A(this,"zoom");A(this,"chartArea");A(this,"navigate");A(this,"tooltip");A(this,"brush",null);A(this,"eventListeners",new Map);A(this,"xAxis");A(this,"yAxis");A(this,"reportsColor");A(this,"viewportX");A(this,"viewportY");A(this,"quadtree");this.reports=t,this.scaleSetting=i,this.axisSettingX=o,this.axisSettingY=c,this.navigate=l,this.xValue=u=>o=="time"?u.linear_elapsed_time:u.linear_status_counts.sum(),this.yValue=u=>c=="behaviors"?u.behaviors:u.fingerprints,this.margin={top:20,right:20,bottom:a?40:45,left:a?50:60},this.width=r.clientWidth-this.margin.left-this.margin.right,this.height=300-this.margin.top-this.margin.bottom,this.reportsColor=n;const d=Array.from(t.values()).flat();this.x=(i==="log"?L.scaleSymlog():L.scaleLinear()).domain([0,Se(d,u=>this.xValue(u))||1]).range([0,this.width]),this.y=L.scaleLinear().domain([0,Se(d,u=>this.yValue(u))||0]).range([this.height,0]),this.viewportX=this.x,this.viewportY=this.y,this.g=L.select(r).append("g").attr("transform",`translate(${this.margin.left},${this.margin.top})`),this.g.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",this.width).attr("height",this.height+5).attr("x",0).attr("y",-5),this.chartArea=this.g.append("g").attr("class","chart-area").attr("clip-path","url(#clip)"),this.chartArea.append("rect").attr("width",this.width).attr("height",this.height).attr("fill","none").attr("pointer-events","all"),this.zoom=L.zoom().scaleExtent([1,1/0]).on("zoom",u=>this.zoomTo(u.transform,!1)),this.chartArea.call(this.zoom),this.chartArea.on("dblclick.zoom",()=>{this.chartArea.transition().duration(500).call(this.zoom.transform,L.zoomIdentity)}),this.tooltip=L.select(".coverage-graph__tooltip"),this.xAxis=this.g.append("g").attr("transform",`translate(0,${this.height})`).call(this.createXAxis(this.x)),this.yAxis=this.g.append("g").call(this.createYAxis(this.y));const h=this.g.append("g").attr("transform",`translate(${-this.margin.left}, ${this.height/2}) rotate(-90)`),g=this.axisSettingY=="behaviors"?ie:oe,v=this.axisSettingY=="behaviors"?"Behaviors":"Fingerprints",m=h.append("text").attr("x",0).attr("y",0).attr("dy","1em").style("text-anchor","middle").text(v);ze(m,g,"vertical");const p=this.axisSettingX=="time"?le:ae,k=this.axisSettingX=="time"?"Time (s)":"Inputs",w=this.g.append("text").attr("x",this.width/2).attr("y",this.height+this.margin.bottom-5).style("text-anchor","middle").text(k);ze(w,p,"horizontal"),this.chartArea.on("mousemove",u=>{const[b,j]=L.pointer(u),x=this.quadtree.find(b,j,gs);x?this.tooltip.style("display","block").style("left",`${u.pageX+10}px`).style("top",`${u.pageY-10}px`).html(`
              <strong>${rt(x.nodeid)}</strong><br/>
              ${x.behaviors.toLocaleString()} behaviors / ${x.fingerprints.toLocaleString()} fingerprints<br/>
              ${x.ninputs.toLocaleString()} inputs / ${x.elapsed_time.toFixed(1)} seconds
            `):this.tooltip.style("display","none")}).on("mouseout",()=>{this.tooltip.style("display","none")}),this.drawLines(),this.updateQuadtree()}createXAxis(r){if(this.scaleSetting==="log"){const t=r.domain()[1],n=[0];let i=1;for(;i<=t;)n.push(i),i*=10;return L.axisBottom(r).tickValues(n).tickFormat(o=>{const c=o.valueOf();return console.assert(c>=0),c>=1e6?`${Math.floor(c/1e6)}M`:c>=1e3?`${Math.floor(c/1e3)}k`:c>0?c.toLocaleString():"0"})}else return L.axisBottom(r).ticks(5).tickFormat(t=>t.toLocaleString())}createYAxis(r){return L.axisLeft(r).ticks(5)}updateQuadtree(){const r=Array.from(this.reports.values()).flat();this.quadtree=L.quadtree().x(t=>this.viewportX(this.xValue(t))).y(t=>this.viewportY(this.yValue(t))).addAll(r)}zoomTo(r,t){const n=r.rescaleX(this.x),i=t?r.rescaleY(this.y):this.y;this.viewportX=n,this.viewportY=i,this.xAxis.call(this.createXAxis(n)),t&&this.yAxis.call(this.createYAxis(i)),this.g.selectAll(".chart-area path").attr("d",L.line().x(o=>n(this.xValue(o))).y(o=>i(this.yValue(o)))),this.updateQuadtree()}drawLines(){const r=L.line().x(t=>this.x(this.xValue(t))).y(t=>this.y(this.yValue(t)));Array.from(this.reports.entries()).forEach(([t,n])=>{this.chartArea.append("path").datum(n).attr("fill","none").attr("stroke",this.reportsColor(t)).attr("d",r).attr("class","coverage-line").style("cursor","pointer").on("mouseover",function(){L.select(this).classed("coverage-line__selected",!0)}).on("mouseout",function(){L.select(this).classed("coverage-line__selected",!1)}).on("click",i=>{nt(i,`/tests/${encodeURIComponent(t)}`,this.navigate)})})}enableBoxBrush(){for(const r of["wheel","mousedown","mousemove","mouseup"])this.chartArea.on(`${r}.zoom`,null);this.brush=L.brush().extent([[0,0],[this.width,this.height]]).on("end",r=>{if(!r.selection)return;const[[t,n],[i,o]]=r.selection;if(this.chartArea.call(this.brush.clear),this.chartArea.call(this.zoom),Math.abs(i-t)<5||Math.abs(o-n)<5){this.emit("boxSelectEnd");return}const c=this.width/(i-t),l=this.height/(o-n),a=Math.max(c,l),d=L.zoomIdentity.translate(this.width/2,this.height/2).scale(a).translate(-(t+i)/2,-(n+o)/2);this.chartArea.transition().duration(250).call(this.zoom.transform,d).on("end",()=>{this.emit("boxSelectEnd")})}),this.chartArea.style("cursor","crosshair").call(this.brush)}cleanup(){this.tooltip.style("display","none"),this.g.selectAll("path").classed("coverage-line__selected",!1)}on(r,t){this.eventListeners.has(r)||this.eventListeners.set(r,[]),this.eventListeners.get(r).push(t)}off(r,t){this.eventListeners.has(r)&&this.eventListeners.set(r,this.eventListeners.get(r).filter(n=>n!==t))}emit(r){this.eventListeners.has(r)&&this.eventListeners.get(r).forEach(t=>t())}}function ht({tests:s,filterString:r=""}){const t=_.useRef(null),[n,i]=Ne("graph_scale","log"),[o,c]=Ne("graph_axis_x","time"),[l,a]=Ne("graph_axis_y","behaviors"),[d,h]=_.useState(!0),[g,v]=_.useState({transform:null,zoomY:!1}),[m,p]=_.useState(!1),k=Xe(),w=Ee(),[u,b]=_.useState(!1),j=_.useMemo(()=>new Map(Array.from(s.entries()).sortKey(([R,P])=>R).map(([R,P])=>{const F=P.linear_status_counts(null),M=P.linear_elapsed_time(null),E=[];for(let D=0;D<F.length;D++){const f=P.linear_reports[D];E.push({nodeid:R,linear_status_counts:F[D],linear_elapsed_time:M[D],behaviors:f.behaviors,fingerprints:f.fingerprints,ninputs:f.ninputs,elapsed_time:f.elapsed_time})}return[R,E]})),[s]),x=_.useMemo(()=>r?new Map(Array.from(j.entries()).filter(([R])=>R.toLowerCase().includes(r.toLowerCase()))):j,[j,r]),N=L.scaleOrdinal(L.schemeCategory10).domain(j.keys());_.useEffect(()=>{if(!t.current||!d&&u)return;d&&h(!1),L.select(t.current).selectAll("*").remove();const R=new xs(t.current,x,N,n,o,l,k,w);return g.transform&&R.zoom.transform(R.chartArea,g.transform),R.zoomTo(g.transform??L.zoomIdentity,g.zoomY),R.zoom.on("zoom.saveTransform",P=>{v({transform:P.transform,zoomY:!1})}),m&&R.enableBoxBrush(),R.on("boxSelectEnd",B),()=>{R.cleanup()}},[x,n,o,l,d,m,k]);const B=()=>{p(!m),h(!0)};return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:"Coverage"}),e.jsxs("div",{className:"coverage-graph__controls",children:[e.jsx(he,{value:l,onChange:a,options:[{value:"behaviors",content:e.jsxs(e.Fragment,{children:[e.jsx($,{icon:ie})," Behaviors"]}),mobileContent:e.jsx($,{icon:ie})},{value:"fingerprints",content:e.jsxs(e.Fragment,{children:[e.jsx($,{icon:oe})," Fingerprints"]}),mobileContent:e.jsx($,{icon:oe})}]}),e.jsx(he,{value:o,onChange:c,options:[{value:"inputs",content:e.jsxs(e.Fragment,{children:[e.jsx($,{icon:ae})," Inputs"]}),mobileContent:e.jsx($,{icon:ae})},{value:"time",content:e.jsxs(e.Fragment,{children:[e.jsx($,{icon:le})," Time"]}),mobileContent:e.jsx($,{icon:le})}]}),e.jsx(he,{value:n,onChange:i,options:[{value:"linear",content:"Linear"},{value:"log",content:"Log"}]})]}),e.jsx("div",{className:"coverage-graph__tooltip"}),e.jsx("svg",{className:"coverage-graph__svg",ref:t,style:{width:"100%",height:"300px"},onMouseEnter:()=>b(!0),onMouseLeave:()=>{b(!1),h(!0)}})]})}function Ae({status:s}){return e.jsx("span",{style:{textAlign:"center"},children:s===fe.FAILED?e.jsx("span",{className:"pill pill__failure",children:"Failed"}):s===fe.SHRINKING?e.jsx("span",{className:"pill pill__warning",children:"Shrinking"}):s===fe.RUNNING?e.jsx("span",{className:"pill pill__success",children:"Running"}):e.jsx("span",{className:"pill pill__neutral",children:"Waiting"})})}function G({content:s,tooltip:r}){return e.jsxs("div",{className:"tooltip",children:[s,e.jsx("div",{className:"tooltip__text",children:r})]})}function vs(s){const r=Math.floor(s/3600),t=Math.floor(s%3600/60),n=Math.floor(s%60);return`${r>0?`${r}:${t.toString().padStart(2,"0")}`:t}:${n.toString().padStart(2,"0")}`}function mt(s){const r=s.ninputs(null),t=s.elapsed_time(null);return t===0?null:r/t}function Re(s){var t;if(s.linear_reports.length===0)return{inputs:"—",behaviors:"—",fingerprints:"—",executions:"—",inputsSinceBranch:"—",timeSpent:"—"};const r=mt(s);return{inputs:s.ninputs(null).toLocaleString(),behaviors:s.behaviors.toLocaleString(),fingerprints:s.fingerprints.toLocaleString(),executions:r===null?"—":`${r.toFixed(1).toLocaleString()}/s`,inputsSinceBranch:((t=s.since_new_branch)==null?void 0:t.toLocaleString())??"—",timeSpent:vs(s.elapsed_time(null))}}ce.registerLanguage("python",at);function bs(){const{nodeid:s}=vt(),{tests:r}=Me(s);if(!s||!r.has(s))return e.jsx("div",{children:"Test not found"});const t=r.get(s),n=Re(t),i=[{content:e.jsx(G,{content:e.jsx("div",{className:"table__header__icon",children:e.jsx($,{icon:ae})}),tooltip:"Number of inputs"})},{content:e.jsx(G,{content:e.jsx("div",{className:"table__header__icon",children:e.jsx($,{icon:ie})}),tooltip:"Number of behaviors (typically branches) found"})},{content:e.jsx(G,{content:e.jsx("div",{className:"table__header__icon",children:e.jsx($,{icon:oe})}),tooltip:"Number of fingerprints (sets of behaviors) found"})},{content:e.jsx(G,{content:e.jsx("div",{className:"table__header__icon",children:e.jsx($,{icon:Ye})}),tooltip:"Inputs per second"})},{content:e.jsx(G,{content:e.jsx("div",{className:"table__header__icon",children:e.jsx($,{icon:Ge})}),tooltip:"Number of inputs since a new behavior"})},{content:e.jsx(G,{content:e.jsx("div",{className:"table__header__icon",children:e.jsx($,{icon:le})}),tooltip:"Total time spent running"})}];return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{to:"/",className:"back-link",children:[e.jsx($,{icon:Mt})," Back to all tests"]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.7rem"},children:[e.jsx("span",{style:{wordBreak:"break-all",fontSize:"1.5rem",fontWeight:"bold"},children:s}),e.jsx(Ae,{status:t.status})]}),e.jsx("div",{style:{paddingTop:"1rem",paddingBottom:"1rem"},children:e.jsx($e,{headers:i,data:[n],row:o=>[e.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:o.inputs}),e.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:o.behaviors}),e.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:o.fingerprints}),e.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:o.executions}),e.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:o.inputsSinceBranch}),e.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:o.timeSpent})]})})]}),e.jsx(ht,{tests:new Map([[s,t]])}),e.jsx(os,{test:t}),t.failure&&e.jsxs("div",{className:"test-failure",children:[e.jsx("h2",{children:"Failure"}),e.jsxs("div",{className:"test-failure__item",children:[e.jsx("h3",{children:"Call"}),e.jsx("pre",{children:e.jsx("code",{className:"language-python",children:t.failure.metadata.get("reproduction_decorator")+`
`+t.failure.representation})}),e.jsx("h3",{children:"Traceback"}),e.jsx("pre",{children:e.jsx("code",{className:"language-python",children:t.failure.metadata.get("traceback")})})]})]})]})}function Q({icon:s,tooltip:r}){return e.jsx(G,{content:e.jsx("div",{className:"table__header__icon",children:e.jsx($,{icon:s})}),tooltip:r})}function ne({icon:s,value:r}){return e.jsxs("div",{className:"table__inline-statistic",children:[s,e.jsx("span",{className:"table__inline-statistic__value",children:r})]})}function ys({tests:s,onFilterChange:r}){const t=Array.from(s).sortKey(([m,p])=>[p.status,m]).map(([m,p])=>p),n=e.jsx(Q,{icon:ae,tooltip:"Number of inputs"}),i=e.jsx(Q,{icon:ie,tooltip:"Number of behaviors (typically branches) found"}),o=e.jsx(Q,{icon:oe,tooltip:"Number of fingerprints (sets of behaviors) found"}),c=e.jsx(Q,{icon:Ye,tooltip:"Inputs per second"}),l=e.jsx(Q,{icon:Ge,tooltip:"Number of inputs since a new behavior"}),a=e.jsx(Q,{icon:le,tooltip:"Total time spent running"}),d=[{content:"Test",sortKey:m=>m.nodeid},{content:"Status",sortKey:m=>m.status,align:"center"},{content:n,align:"right",sortKey:m=>m.ninputs(null)},{content:i,align:"right",sortKey:m=>m.behaviors},{content:o,align:"right",sortKey:m=>m.fingerprints},{content:c,align:"right",sortKey:m=>mt(m)??-1},{content:l,align:"right",sortKey:m=>m.since_new_branch??0},{content:a,align:"right",sortKey:m=>m.elapsed_time(null)}],h=m=>{const p=Re(m);return[e.jsx(Z,{to:`/tests/${encodeURIComponent(m.nodeid)}`,className:"test__link",style:{wordBreak:"break-all"},children:m.nodeid}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(Ae,{status:m.status})}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:p.inputs}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:p.behaviors}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:p.fingerprints}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:p.executions}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:p.inputsSinceBranch}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:p.timeSpent})]};function g(m){const p=Re(m);return e.jsxs("div",{className:"table__mobile-row",children:[e.jsxs("div",{className:"table__mobile-row__header",children:[e.jsx(Z,{to:`/tests/${encodeURIComponent(m.nodeid)}`,className:"test__link",style:{wordBreak:"break-all"},children:m.nodeid}),e.jsx(Ae,{status:m.status})]}),e.jsxs("div",{className:"table__mobile-row__statistics",children:[e.jsx(ne,{icon:n,value:p.inputs}),e.jsx(ne,{icon:i,value:p.behaviors}),e.jsx(ne,{icon:c,value:p.executions}),e.jsx(ne,{icon:l,value:p.inputsSinceBranch}),e.jsx(ne,{icon:a,value:p.timeSpent})]})]})}function v(m){return[m.nodeid,lt[m.status]]}return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:"Tests"}),e.jsx($e,{headers:d,data:t,row:h,mobileRow:g,filterStrings:v,onFilterChange:r})]})}function js(){const{tests:s}=Me(),[r,t]=_.useState("");return e.jsxs("div",{className:"dashboard",children:[e.jsx(ht,{tests:s,filterString:r}),e.jsx(ys,{tests:s,onFilterChange:t})]})}function ws({min:s,max:r,value:t,onChange:n,step:i=1}){const[o,c]=_.useState(null),l=_.useRef(null),[a,d]=t,h=r-s,g=h===0?0:(a-s)/h*100,v=h===0?100:(d-s)/h*100,m=g<50?1:2,p=v<50?2:1,k=_.useCallback(x=>{if(!l.current)return s;const N=l.current.getBoundingClientRect(),B=Math.max(0,Math.min(100,(x-N.left)/N.width*100)),R=s+B/100*h,P=Math.round(R/i)*i;return Math.max(s,Math.min(r,P))},[s,r,h,i]),w=x=>N=>{N.preventDefault(),c(x)},u=_.useCallback(x=>{if(!o)return;const N=k(x.clientX);n(o==="min"?[Math.min(N,d),d]:[a,Math.max(N,a)])},[o,k,a,d,n]),b=_.useCallback(()=>{c(null)},[]),j=x=>{if(o)return;const N=k(x.clientX),B=Math.abs(N-a),R=Math.abs(N-d);B<R?n([Math.min(N,d),d]):n([a,Math.max(N,a)])};return _.useEffect(()=>o?(document.addEventListener("mousemove",u),document.addEventListener("mouseup",b),()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",b)}):()=>{},[o,u,b]),e.jsx("div",{className:"range-slider",children:e.jsx("div",{className:"range-slider__container",children:e.jsxs("div",{ref:l,className:"range-slider__track",onClick:j,children:[e.jsx("div",{className:"range-slider__range",style:{left:`${g}%`,width:`${v-g}%`}}),e.jsx("div",{className:"range-slider__thumb range-slider__thumb--min",style:{left:`${g}%`,zIndex:m},onMouseDown:w("min")}),e.jsx("div",{className:"range-slider__thumb range-slider__thumb--max",style:{left:`${v}%`,zIndex:p},onMouseDown:w("max")})]})})})}function Ue(s){return new Date(s*1e3).toLocaleString()}function Ns(s){let r=0;for(let o=0;o<s.length;o++)r=(r<<5)-r+s.charCodeAt(o)&4294967295;const t=Math.abs(r)%360,n=60+Math.abs(r>>8)%30,i=45+Math.abs(r>>16)%20;return`hsl(${t}, ${n}%, ${i}%)`}function Ss(){const{tests:s}=Me(),r=Xe(),{showTooltip:t,hideTooltip:n,moveTooltip:i}=Ce(),o=$t(Array.from(s.values()).map(u=>Array.from(u.reports_by_worker.keys())).flat().sortKey(u=>u)),c=new Map;o.forEach(u=>{const b=[];c.set(u,b),Array.from(s.values()).forEach(j=>{if(!j.reports_by_worker.has(u))return;const x=j.reports_by_worker.get(u);b.push(...x.map(N=>({timestamp_monotonic:N.timestamp_monotonic,nodeid:j.nodeid})))}),b.sortKey(j=>j.timestamp_monotonic)});let l=1/0,a=-1/0;const d=new Map;o.forEach(u=>{const b=c.get(u),j=[];let x=null;b.forEach((N,B)=>{l=Math.min(l,N.timestamp_monotonic),a=Math.max(a,N.timestamp_monotonic),!x||x.nodeid!==N.nodeid?(x&&j.push(x),x={nodeid:N.nodeid,start:N.timestamp_monotonic,end:N.timestamp_monotonic}):x.end=N.timestamp_monotonic,B===b.length-1&&x&&j.push(x)}),d.set(u,j)});const[h,g]=_.useState([l,a]);_.useEffect(()=>{g([l,a])},[l,a]);const[v,m]=h,p=m-v,k=u=>{let b,j;return p===0?(b=0,j=100):(b=(u.start-v)/p*100,j=(u.end-u.start)/p*100),{left:`${b}%`,width:`${j}%`,backgroundColor:Ns(u.nodeid)}};function w(u){return u.filter(b=>b.end>=v&&b.start<=m)}return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:"Workers"}),e.jsx("div",{className:"card__body",children:e.jsxs("div",{className:"workers",children:[e.jsx("div",{className:"workers__time-controls",children:e.jsx(ws,{min:l,max:a,value:h,onChange:u=>g(u),step:(a-l)/1e3})}),e.jsxs("div",{className:"workers__timeline-header",children:[e.jsx("span",{className:"workers__timeline-header__label",children:Ue(v)}),e.jsx("span",{className:"workers__timeline-header__label",children:Ue(m)})]}),o.map(u=>e.jsx("div",{className:"workers__worker",children:w(d.get(u)||[]).map((b,j)=>e.jsx("div",{className:"workers__timeline__segment",style:k(b),onClick:x=>nt(x,`/tests/${encodeURIComponent(b.nodeid)}`,r),onMouseEnter:x=>{t(rt(b.nodeid),x.clientX,x.clientY,"workers")},onMouseLeave:()=>{n("workers")},onMouseMove:x=>{i(x.clientX,x.clientY,"workers")}},j))},u))]})})]})}function ks(){const s=bt;return e.jsx(s,{children:e.jsx(ls,{children:e.jsx(ds,{children:e.jsx(Yt,{children:e.jsx(yt,{children:e.jsxs(Y,{element:e.jsx(hs,{}),children:[e.jsx(Y,{path:"/",element:e.jsx(js,{})}),e.jsx(Y,{path:"/patches",element:e.jsx(_s,{})}),e.jsx(Y,{path:"/collected",element:e.jsx(ms,{})}),e.jsx(Y,{path:"/workers",element:e.jsx(Ss,{})}),e.jsx(Y,{path:"/tests/:nodeid",element:e.jsx(bs,{})}),e.jsx(Y,{path:"*",element:e.jsx(ps,{})})]})})})})})})}Xt.createRoot(document.getElementById("app")).render(e.jsx(jt.StrictMode,{children:e.jsx(ks,{})}));
