var ot=Object.defineProperty;var lt=(s,r,e)=>r in s?ot(s,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[r]=e;var j=(s,r,e)=>lt(s,typeof r!="symbol"?r+"":r,e);import{r as ct,g as ze,u as ut,a as x,L as W,O as dt,b as ht,c as pt,H as mt,d as ft,e as Y,R as _t}from"./react-Di91Mh3L.js";import{F as k,f as gt,S as P,a as xt,b as bt,c as yt,r as vt,d as jt,e as wt,L as G,g as Nt,h as St,i as At,j as ie,k as ae,l as oe,m as le,n as Rt,o as Ue,p as Ke}from"./vendor-BuNSVivD.js";import{d as We,a as He,b as Xe,c as Et,o as Ye,l as Ge,q as kt,e as Ct,f as $t,g as Tt,h as Lt,i as Mt,j as Ft,s as Bt}from"./d3-CO-FEQw9.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=e(i);fetch(i.href,a)}})();var be={exports:{}},ee={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Le;function Pt(){if(Le)return ee;Le=1;var s=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function e(n,i,a){var l=null;if(a!==void 0&&(l=""+a),i.key!==void 0&&(l=""+i.key),"key"in i){a={};for(var o in i)o!=="key"&&(a[o]=i[o])}else a=i;return i=a.ref,{$$typeof:s,type:n,key:l,ref:i!==void 0?i:null,props:a}}return ee.Fragment=r,ee.jsx=e,ee.jsxs=e,ee}var Me;function It(){return Me||(Me=1,be.exports=Pt()),be.exports}var t=It();Array.prototype.sortKey||(Array.prototype.sortKey=function(s){return this.sort((r,e)=>{const n=s(r),i=s(e);if(Array.isArray(n)&&Array.isArray(i)){for(let a=0;a<Math.min(n.length,i.length);a++){if(n[a]<i[a])return-1;if(n[a]>i[a])return 1}return 0}return n<i?-1:n>i?1:0})});var Dt=ct();const Ot=ze(Dt);function Vt(){const s=ut(),r=s.pathname==="/"||s.pathname.startsWith("/tests/"),[e,n]=x.useState(!1),i=x.useRef(null);return x.useEffect(()=>{function a(l){var o;e&&((o=i.current)==null?void 0:o.contains(l.target))===!1&&n(!1)}return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[e]),x.useEffect(()=>{n(!1)},[s]),t.jsxs("div",{className:"layout",children:[!e&&t.jsx("div",{className:"toggle-sidebar",onClick:()=>n(!0),children:t.jsx(k,{icon:gt,size:"lg"})}),e&&t.jsx("div",{className:"opacity-overlay"}),t.jsxs("div",{ref:i,className:`sidebar ${e?"sidebar--open":""}`,children:[t.jsx(W,{to:"/",className:"sidebar__title",children:"HypoFuzz"}),t.jsxs("nav",{className:"sidebar__nav",children:[t.jsx(W,{to:"/",className:`sidebar__link ${r?"sidebar__link--active":""}`,children:"Tests"}),t.jsx(W,{to:"/patches",className:`sidebar__link ${s.pathname==="/patches"?"sidebar__link--active":""}`,children:"Patches"}),t.jsx(W,{to:"/collected",className:`sidebar__link ${s.pathname==="/collected"?"sidebar__link--active":""}`,children:"Collection"}),t.jsx("div",{className:"sidebar__separator"}),t.jsx("a",{href:`${"/example-dashboard".replace(/\/$/,"")}/docs/`,className:"sidebar__link",children:"Docs"})]})]}),t.jsx("div",{className:"content",children:t.jsx(dt,{})})]})}function ke(){const[s,r]=x.useState(!1);return x.useEffect(()=>{function e(){r(window.matchMedia("(max-width: 768px)").matches)}return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),s}function de({value:s,onChange:r,options:e}){const n=ke();return t.jsx("div",{className:"scale-toggle",children:e.map(i=>t.jsx("button",{className:`scale-toggle__button${s===i.value?" scale-toggle__button--active":""}`,onClick:()=>{if(e.length==2&&s===i.value){const a=e.find(l=>l.value!==i.value).value;r(a)}else r(i.value)},children:n?i.mobileContent??i.content:i.content},String(i.value)))})}let J=null;function Ce(){return J||(J=document.createElement("div"),J.className="tyche-tooltip",J.style.cssText=`
      position: absolute;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      border-radius: 4px;
      padding: 8px;
      font-size: 12px;
      pointer-events: none;
      z-index: 10;
      display: none;
    `,document.body.appendChild(J)),J}function Je(s,r,e){const n=Ce();n.innerHTML=s,n.style.left=`${r+10}px`,n.style.top=`${e-28}px`,n.style.display="block"}function Ne(s,r){const e=Ce();e.style.left=`${s+10}px`,e.style.top=`${r-28}px`}function ne(){const s=Ce();s.style.display="none"}function qe(s,r=0){return Array.from(s).reduce((e,n)=>e+n,r)}function Se(s,r){let e=null;for(let n=0;n<s.length;n++){const i=s[n],a=r?r(i):i;a!=null&&(e===null||a>e)&&(e=a)}return e}function ye(s,r,e){let n=0,i=s.length;for(;n<i;){const a=n+i>>>1;(e?e(s[a])<=r:s[a]<=r)?n=a+1:i=a}return n}let te=null;function zt(){return te||(te=document.createElement("div"),te.style.cssText=`
      position: absolute;
      visibility: hidden;
      white-space: nowrap;
      top: -9999px;
      left: -9999px;
      pointer-events: none;
      z-index: -1;
    `,document.body.appendChild(te)),te}function ve(s,r=""){const e=zt();e.className=r,e.textContent=s;const n=e.getBoundingClientRect();return{width:n.width,height:n.height}}class Qe{constructor(r,e,n,i){j(this,"createdAt");this.name=r,this.predicate=e,this.component=n,this.extraData=i,this.createdAt=Date.now()}}const Ze=x.createContext(void 0);function Ut({children:s}){const[r,e]=x.useState(new Map([["covering",new Map],["rolling",new Map]])),[n,i]=x.useState("covering"),a=r.get(n)||new Map,l=c=>{e(u=>{const m=new Map(u);return m.set(n,c),m})},h={filters:a,setFilters:l,removeFilter:(c,u)=>{const m=new Map(a),d=(m.get(c)||[]).filter(_=>_.name!==u);d.length===0?m.delete(c):m.set(c,d),l(m)},observationCategory:n,setObservationCategory:i};return t.jsx(Ze.Provider,{value:h,children:s})}function fe(){const s=x.useContext(Ze);if(s===void 0)throw new Error("useFilters must be used within a FilterProvider");return s}const K={select:We,scaleLinear:Ge,scaleOrdinal:Ye,scaleBand:Et,axisBottom:Xe,axisLeft:He},Fe=5,U=2.5;function Kt({feature:s,observations:r}){const e=x.useRef(null),n=x.useRef(null),{filters:i,setFilters:a}=fe(),l=i.get(s)||[],o=x.useMemo(()=>{if(l.length===0)return P();console.assert(l.length===1);const c=l[0];return P(c.extraData.selectedValues)},[l]);r={raw:r.raw.filter(c=>c.status!=="gave_up"),filtered:r.filtered.filter(c=>c.status!=="gave_up")};const h=c=>{let u=P();o.equals(P([c]))?u=P():u=P([c]);let m;u.size===1?m=u.first():m=u.map(_=>`${_}`).join(" or ");const b=[];u.size>0&&b.push(new Qe(m,_=>u.some(L=>_.features.get(s)===L),s,{selectedValues:u}));const d=new Map(i);d.set(s,b),a(d)};return x.useEffect(()=>{const c=P(r.raw.map(y=>y.features.get(s)));let u=new Map;for(const y of r.filtered){const f=y.features.get(s);u.set(f,(u.get(f)||0)+1)}const m=qe(Array.from(u.values()));u=new Map([...u.entries()].sortKey(([y,f])=>y===he?0:y===pe?1:y)),K.select(n.current).selectAll("*").remove();const b=e.current.clientWidth,d=c.size<Fe?85:170,_=K.select(n.current).attr("width",b).attr("height",d).append("g"),L=function(y,f){const[S,C]=f;Je(`${s}<br>${S}: ${C}`,y.pageX,y.pageY)};if(c.size<Fe){const y={top:0,right:15,bottom:20,left:15},f=b-y.left-y.right,S=d-y.top-y.bottom,C=K.scaleLinear().domain([0,1]).range([0,f]);let R;u.has(he)||u.has(pe)?R=F=>F===he?B.SUCCESS:F===pe?B.ERROR:B.PRIMARY:R=K.scaleOrdinal().domain(Array.from(u.keys())).range([B.PRIMARY,B.ACCENT,B.ACCENT2,B.ACCENT3,B.ACCENT4]);const E=_.append("g").attr("transform",`translate(${y.left},${y.top})`);let v=0;const A=S-y.bottom;u.forEach((F,D)=>{const p=F/m*f,g=o.has(D);E.append("rect").attr("x",v).attr("y",0).attr("width",p).attr("height",A).attr("fill",R(D)).style("cursor","pointer").on("click",()=>h(D)).on("mouseover",w=>{L(w,[D,F])}).on("mousemove",w=>Ne(w.pageX,w.pageY)).on("mouseleave",ne),g&&E.append("rect").attr("x",v+U).attr("y",U).attr("width",p-2*U).attr("height",A-2*U).attr("fill",R(D)).attr("stroke","white").attr("stroke-width",U).style("pointer-events","none"),E.append("text").attr("x",v+p/2).attr("y",A/2).attr("text-anchor","middle").attr("dominant-baseline","central").attr("fill","white").text(D).style("font-size","12px"),v+=p}),E.append("g").attr("transform",`translate(0,${A})`).call(K.axisBottom(C).tickFormat(F=>`${Math.round(Number(F)*100)}%`)),E.append("text").attr("x",f/2).attr("y",A+30).attr("text-anchor","middle").text("% of observations").style("font-size","12px")}else{const y={top:5,right:5,bottom:30,left:30},f=b-y.left-y.right,S=d-y.top-y.bottom,C=K.scaleBand().domain(Array.from(u.keys())).range([0,f]).padding(.2),R=K.scaleLinear().domain([0,Se(Array.from(u.values()))||0]).range([S,0]),E=_.append("g").attr("transform",`translate(${y.left},${y.top})`);E.selectAll(".bar").data(Array.from(u.entries())).enter().append("rect").attr("class","bar").attr("x",([v,A])=>C(v)||0).attr("y",([v,A])=>R(A)).attr("width",C.bandwidth()).attr("height",([v,A])=>S-R(A)).attr("fill",B.PRIMARY).style("cursor","pointer").on("click",function(v,[A,F]){h(A)}).on("mouseover",function(v,A){L(v,A)}).on("mousemove",v=>Ne(v.pageX,v.pageY)).on("mouseleave",ne),E.selectAll(".inner-bar").data(Array.from(u.entries()).filter(([v,A])=>o.has(v))).enter().append("rect").attr("class","inner-bar").attr("x",([v,A])=>(C(v)||0)+U).attr("y",([v,A])=>R(A)+U).attr("width",C.bandwidth()-2*U).attr("height",([v,A])=>S-R(A)-2*U).attr("fill",B.PRIMARY).attr("stroke","white").attr("stroke-width",U).style("pointer-events","none"),E.append("g").attr("transform",`translate(0,${S})`).call(K.axisBottom(C)).selectAll("text").attr("transform","rotate(-45)").style("text-anchor","end"),E.append("g").call(K.axisLeft(R).ticks(7).tickFormat(v=>Math.round(Number(v)).toString())),E.append("text").attr("transform","rotate(-90)").attr("y",-30).attr("x",-S/2).attr("text-anchor","middle").text("Count").style("font-size","12px")}return()=>{ne()}},[r,o,s,h]),t.jsxs("div",{children:[t.jsx("div",{className:"tyche__nominal__feature",children:s}),t.jsx("div",{ref:e,className:"tyche__nominal__chart",children:t.jsx("svg",{ref:n,style:{width:"100%"}})})]})}function Wt({title:s,children:r,defaultState:e="open",onStateChange:n,headerClass:i="",contentClass:a=""}){const[l,o]=x.useState(e),h=()=>{const c=l==="open"?"closed":"open";o(c),n==null||n(c)};return t.jsxs("div",{children:[t.jsxs("div",{className:`collapsible__header ${i}`,onClick:h,children:[t.jsx("span",{className:"collapsible__toggle",children:l==="open"?t.jsx(k,{icon:xt}):t.jsx(k,{icon:bt})}),s]}),l==="open"&&t.jsx("div",{className:`${a}`,children:r})]})}function $e({title:s,children:r,defaultState:e="open",onStateChange:n}){return t.jsx("div",{className:"tyche__section",children:t.jsx(Wt,{title:s,defaultState:e,onStateChange:n,headerClass:"tyche__section__header",contentClass:"tyche__section__content",children:r})})}function Ht({observations:s}){const r=new Set;return s.raw.forEach(e=>{for(const n of e.features.keys())n.startsWith("Retried draw from")||r.add(n)}),r.size===0?null:t.jsx($e,{title:"Features",children:Array.from(r).sort().map(e=>t.jsx(Kt,{feature:e,observations:s}))})}function Xt(){const{filters:s,removeFilter:r}=fe(),e=Array.from(s.values()).flat().sortKey(n=>n.createdAt);return e.length===0?null:t.jsxs("div",{className:"tyche__filters",children:[t.jsx("div",{className:"tyche__filters__title",children:"Current Filters"}),e.map(n=>t.jsxs("div",{className:"tyche__filters__filter",children:[t.jsxs("div",{className:"tyche__filters__filter__component",children:[t.jsx("div",{className:"tyche__filters__filter__remove",onClick:()=>r(n.component,n.name),children:t.jsx(k,{icon:yt})}),n.component]}),t.jsx("div",{className:"tyche__filters__filter__name",children:n.name})]},`${n.component}-${n.name}`))]})}var Yt=vt();const ce=ze(Yt);function et(s){const r=s.regex,e=new RegExp("[\\p{XID_Start}_]\\p{XID_Continue}*","u"),n=["and","as","assert","async","await","break","case","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","is","lambda","match","nonlocal|10","not","or","pass","raise","return","try","while","with","yield"],o={$pattern:/[A-Za-z]\w+|__\w+__/,keyword:n,built_in:["__import__","abs","all","any","ascii","bin","bool","breakpoint","bytearray","bytes","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","exec","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip"],literal:["__debug__","Ellipsis","False","None","NotImplemented","True"],type:["Any","Callable","Coroutine","Dict","List","Literal","Generic","Optional","Sequence","Set","Tuple","Type","Union"]},h={className:"meta",begin:/^(>>>|\.\.\.) /},c={className:"subst",begin:/\{/,end:/\}/,keywords:o,illegal:/#/},u={begin:/\{\{/,relevance:0},m={className:"string",contains:[s.BACKSLASH_ESCAPE],variants:[{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?'''/,end:/'''/,contains:[s.BACKSLASH_ESCAPE,h],relevance:10},{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?"""/,end:/"""/,contains:[s.BACKSLASH_ESCAPE,h],relevance:10},{begin:/([fF][rR]|[rR][fF]|[fF])'''/,end:/'''/,contains:[s.BACKSLASH_ESCAPE,h,u,c]},{begin:/([fF][rR]|[rR][fF]|[fF])"""/,end:/"""/,contains:[s.BACKSLASH_ESCAPE,h,u,c]},{begin:/([uU]|[rR])'/,end:/'/,relevance:10},{begin:/([uU]|[rR])"/,end:/"/,relevance:10},{begin:/([bB]|[bB][rR]|[rR][bB])'/,end:/'/},{begin:/([bB]|[bB][rR]|[rR][bB])"/,end:/"/},{begin:/([fF][rR]|[rR][fF]|[fF])'/,end:/'/,contains:[s.BACKSLASH_ESCAPE,u,c]},{begin:/([fF][rR]|[rR][fF]|[fF])"/,end:/"/,contains:[s.BACKSLASH_ESCAPE,u,c]},s.APOS_STRING_MODE,s.QUOTE_STRING_MODE]},b="[0-9](_?[0-9])*",d=`(\\b(${b}))?\\.(${b})|\\b(${b})\\.`,_=`\\b|${n.join("|")}`,L={className:"number",relevance:0,variants:[{begin:`(\\b(${b})|(${d}))[eE][+-]?(${b})[jJ]?(?=${_})`},{begin:`(${d})[jJ]?`},{begin:`\\b([1-9](_?[0-9])*|0+(_?0)*)[lLjJ]?(?=${_})`},{begin:`\\b0[bB](_?[01])+[lL]?(?=${_})`},{begin:`\\b0[oO](_?[0-7])+[lL]?(?=${_})`},{begin:`\\b0[xX](_?[0-9a-fA-F])+[lL]?(?=${_})`},{begin:`\\b(${b})[jJ](?=${_})`}]},y={className:"comment",begin:r.lookahead(/# type:/),end:/$/,keywords:o,contains:[{begin:/# type:/},{begin:/#/,end:/\b\B/,endsWithParent:!0}]},f={className:"params",variants:[{className:"",begin:/\(\s*\)/,skip:!0},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:o,contains:["self",h,L,m,s.HASH_COMMENT_MODE]}]};return c.contains=[m,L,h],{name:"Python",aliases:["py","gyp","ipython"],unicodeRegex:!0,keywords:o,illegal:/(<\/|\?)|=>/,contains:[h,L,{scope:"variable.language",match:/\bself\b/},{beginKeywords:"if",relevance:0},{match:/\bor\b/,scope:"keyword"},m,y,s.HASH_COMMENT_MODE,{match:[/\bdef/,/\s+/,e],scope:{1:"keyword",3:"title.function"},contains:[f]},{variants:[{match:[/\bclass/,/\s+/,e,/\s*/,/\(\s*/,e,/\s*\)/]},{match:[/\bclass/,/\s+/,e]}],scope:{1:"keyword",3:"title.class",6:"title.class.inherited"}},{className:"meta",begin:/^[\t ]*@/,end:/(?=#)|$/,contains:[L,f,m]}]}}function Be({currentPage:s,pageCount:r,onPageChange:e}){console.assert(r>1);function n(){return r<=7?Array.from({length:r},(h,c)=>c):s<=3?[0,1,2,3,4,"ellipsis",r-1]:s>=r-4?[0,"ellipsis",r-5,r-4,r-3,r-2,r-1]:[0,"ellipsis",s-1,s,s+1,"ellipsis",r-1]}const i=n();function a(h){typeof h=="number"&&s!==h&&e(h)}function l(){s>0&&e(s-1)}function o(){s<r-1&&e(s+1)}return t.jsxs("div",{className:"pagination",children:[t.jsx("div",{className:`pagination__nav pagination__nav--left ${s===0?"pagination__nav--disabled":""}`,onClick:l,children:t.jsx(k,{icon:jt})}),i.map((h,c)=>{if(h==="ellipsis")return t.jsx("div",{className:" pagination__ellipsis",children:"..."},`ellipsis-${c}`);const u=h===s;return t.jsx("div",{className:`pagination__number ${u?"pagination__number--current":""}`,onClick:()=>a(h),children:h+1},h)}),t.jsx("div",{className:`pagination__nav pagination__nav--right ${s===r-1?"pagination__nav--disabled":""}`,onClick:o,children:t.jsx(k,{icon:wt})})]})}ce.registerLanguage("python",et);const je=30;function Gt({observations:s,observationCategory:r}){const e=x.useRef(null),[n,i]=x.useState(0);x.useEffect(()=>{i(0)},[r]);function a(){e.current&&e.current.querySelectorAll("code:not([data-highlighted='yes'])").forEach(c=>{ce.highlightElement(c)})}x.useEffect(()=>{a()},[s,n]);const l=new Map;s.filtered.forEach(c=>{const u=c.representation;l.set(u,(l.get(u)||0)+1)});const o=Math.ceil(l.size/je),h=Array.from(l.entries()).sortKey(([c,u])=>-u).slice(n*je,(n+1)*je);return t.jsx($e,{title:"Textual representation",defaultState:"closed",onStateChange:c=>{c==="open"&&requestAnimationFrame(()=>{a()})},children:t.jsxs("div",{ref:e,children:[o>1&&t.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"12px"},children:t.jsx(Be,{currentPage:n,pageCount:o,onPageChange:i})}),h.map(([c,u])=>t.jsxs("div",{style:{position:"relative"},className:"tyche__representation__example",children:[t.jsx("pre",{children:t.jsx("code",{className:"language-python",children:c})}),u>1&&t.jsxs("div",{className:"tyche__representation__example__count",children:["x ",u]})]},c)),o>1&&t.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"12px"},children:t.jsx(Be,{currentPage:n,pageCount:o,onPageChange:i})})]})})}const Pe=640;function Jt({name:s,observations:r,verticalAxis:e,horizontalAxis:n,cssStyle:i=(a,l)=>({})}){const{filters:a,setFilters:l}=fe(),o=a.get(s)||[],h=x.useMemo(()=>{if(o.length===0)return P();console.assert(o.length===1);const p=o[0];return P(p.extraData.selectedCells)},[o]),c=[],u=Array(e.length).fill(0),m=Array(n.length).fill(0);let b=0;for(let p=0;p<e.length;p++){c[p]=[];for(let g=0;g<n.length;g++)c[p][g]={count:0,widthPercent:0}}r.filtered.forEach(p=>{for(let g=0;g<e.length;g++){const[,w]=e[g];if(w(p)){for(let $=0;$<n.length;$++){const[,O]=n[$];if(O(p)){c[g][$].count++,u[g]++,m[$]++,b++;break}}break}}});const d=u.map((p,g)=>p>0?g:null).filter(p=>p!==null),_=m.map((p,g)=>p>0?g:null).filter(p=>p!==null),L=(p,g)=>{let w=P();if(p!==null&&g!==null){const N=G([p,g]);h.equals(P([N]))?w=P():w=P([N])}else p!==null?(console.assert(g===null),_.forEach(N=>{c[p][N].count>0&&(w=w.add(G([p,N])))})):g!==null&&(console.assert(p===null),d.forEach(N=>{c[N][g].count>0&&(w=w.add(G([N,g])))}));function $(){if(w.size===0)return"";let N=w;const z=[],ue=[...d.map(M=>({name:e[M][0],cells:_.filter(I=>c[M][I].count>0).map(I=>G([M,I]))})),..._.map(M=>({name:n[M][0],cells:d.filter(I=>c[I][M].count>0).map(I=>G([I,M]))}))];for(const M of ue)M.cells.length>0&&M.cells.every(I=>N.has(I))&&(z.push(M.name),N=N.subtract(P(M.cells)));for(;N.size>0;){const M=N.first(),[I,xe]=M.toArray();z.push(`${e[I][0]}+${n[xe][0]}`),N=N.delete(M)}return console.assert(N.size==0),z.join(" or ")}const O=[];w.size>0&&O.push(new Qe($(),N=>w.some(z=>{const[ue,M]=z.toArray(),I=e[ue][1],xe=n[M][1];return I(N)&&xe(N)}),s,{selectedCells:w}));const V=new Map(a);V.set(s,O),l(V)};if(x.useEffect(()=>()=>{ne()},[r]),d.length===0||_.length===0)return t.jsx("div",{children:"No observations"});const y=30,f=30,S=45*d.length;for(let p=0;p<e.length;p++)for(let g=0;g<n.length;g++)c[p][g].widthPercent=u[p]>0?c[p][g].count/u[p]*100:0;const R=d.map(p=>u[p]/b*S).map(p=>Math.max(p,f)),E=_.map((p,g)=>g===0?0:g===_.length-1?100:g/(_.length-1)*100),{rowHeaderWidth:v,columnHeaderHeight:A,rowTotalWidth:F}=x.useMemo(()=>({rowHeaderWidth:Math.max(...d.map(p=>ve(e[p][0],"tyche__mosaic__row-header").width)),columnHeaderHeight:Math.max(..._.map(p=>ve(n[p][0],"tyche__mosaic__column-header").height)),rowTotalWidth:Math.max(...d.map(p=>ve(u[p].toString(),"tyche__mosaic__row-total").width))}),[d,_,e,n,u]),D=Pe-v-F;return d.forEach(p=>{const g=_.map($=>c[p][$]);if(g.reduce(($,O)=>$+O.widthPercent,0)>0){const O=g.map(N=>N.widthPercent/100*D).map((N,z)=>g[z].count>0&&N>0&&N<y?y:N),V=O.reduce((N,z)=>N+z,0);_.forEach((N,z)=>{c[p][N].widthPercent=V>0?O[z]/V*100:0})}}),t.jsxs("div",{className:"tyche__mosaic__container",style:{maxWidth:`${Pe}px`},children:[t.jsx("div",{className:"tyche__mosaic__column-headers",style:{marginLeft:`${v}px`,marginRight:`${F}px`,height:`${A}px`},children:_.map((p,g)=>{const w=g===0,$=g===_.length-1;return t.jsx("div",{className:"tyche__mosaic__column-header",style:{left:`${E[g]}%`,transform:w?"translateX(0%)":$?"translateX(-100%)":"translateX(-50%)",textAlign:w?"left":$?"right":"center"},onClick:()=>L(null,p),children:n[p][0]},`header-${p}`)})}),d.map((p,g)=>t.jsxs("div",{className:"tyche__mosaic__row",style:{height:`${R[g]}px`},children:[t.jsx("div",{className:"tyche__mosaic__row-header",style:{width:`${v}px`,cursor:"pointer"},onClick:()=>L(p,null),children:e[p][0]}),t.jsx("div",{className:"tyche__mosaic__row-cells",children:_.map(w=>{const $=c[p][w];if($.count===0)return null;const O=h.has(G([p,w]));return t.jsx("div",{className:`tyche__mosaic__cell${O?" tyche__mosaic__cell--selected":""}`,style:{width:`${$.widthPercent}%`,minWidth:`${y}px`,minHeight:`${f}px`,...i(e[p][0],n[w][0])},onClick:()=>L(p,w),onMouseEnter:V=>Je(`${e[p][0]} and ${n[w][0]}
                      <br>Count: ${$.count}`,V.pageX,V.pageY),onMouseMove:V=>Ne(V.pageX,V.pageY),onMouseLeave:ne,children:t.jsx("span",{className:"tyche__mosaic__cell-value",children:$.count})},`cell-${p}-${w}`)})}),t.jsx("div",{className:"tyche__mosaic__row-total",style:{width:`${F}px`},children:u[p]})]},`row-${p}`)),t.jsxs("div",{className:"tyche__mosaic__column-totals-row",style:{height:`${A}px`},children:[t.jsx("div",{style:{width:`${v}px`}}),t.jsx("div",{className:"tyche__mosaic__column-totals",style:{marginRight:`${F}px`},children:_.map((p,g)=>{const w=g===0,$=g===_.length-1;return t.jsx("div",{className:"tyche__mosaic__column-total",style:{left:`${E[g]}%`,transform:w?"translateX(0%)":$?"translateX(-100%)":"translateX(-50%)",textAlign:w?"left":$?"right":"center"},children:m[p]},`total-${p}`)})}),t.jsx("div",{className:"tyche__mosaic__grand-total",style:{width:`${F}px`},children:b})]})]})}function qt({observations:s}){function r(e,n){const i={};return e==="Passed"?i.backgroundColor=B.SUCCESS:e==="Invalid"?i.backgroundColor=B.WARNING:e==="Failed"&&(i.backgroundColor=B.ERROR),n==="Duplicate"&&(i.opacity=.7),i}return t.jsx($e,{title:"Sample breakdown",children:t.jsx(Jt,{name:"samples",observations:s,verticalAxis:[["Passed",e=>e.status==="passed"],["Invalid",e=>e.status==="gave_up"]],horizontalAxis:[["Unique",e=>e.isUnique??!1],["Duplicate",e=>e.isDuplicate??!1]],cssStyle:r})})}const he="Present",pe="Not present";var B=(s=>(s.PRIMARY="#6b8ab5",s.SUCCESS="#8ba86b",s.WARNING="#d59a7e",s.ERROR="#c77a7e",s.ACCENT="#c1a2bb",s.ACCENT2="#9fc7c6",s.ACCENT3="#edd39a",s.ACCENT4="#99c7d6",s.ACCENT5="#8faac6",s))(B||{});function Qt({test:s}){const{filters:r,observationCategory:e,setObservationCategory:n}=fe(),i=e==="rolling"?s.rolling_observations.sortKey(o=>-o.run_start):s.corpus_observations,a=x.useMemo(()=>{const o=Array.from(r.values()).flat();return o.length===0?i:i.filter(h=>o.every(c=>c.predicate(h)))},[i,r]),l={raw:i,filtered:a};return t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card__header",children:t.jsx("span",{children:"Observations"})}),t.jsx("div",{style:{paddingTop:"10px",paddingBottom:"10px",display:"flex",fontSize:"1.05rem",fontWeight:"500"},children:t.jsx(de,{value:e,onChange:n,options:[{value:"covering",content:"Covering"},{value:"rolling",content:"Rolling"}]})}),t.jsx(Xt,{}),l.raw.length>0?t.jsxs(t.Fragment,{children:[t.jsx(qt,{observations:l}),t.jsx(Ht,{observations:l}),t.jsx(Gt,{observations:l,observationCategory:e})]}):t.jsx("div",{className:"tyche__section",children:"No observations"})]})}function Zt({test:s}){return t.jsx(Ut,{children:t.jsx(Qt,{test:s})})}class _e{withProperties(r){return Object.assign(Object.create(this.constructor.prototype),this,r)}}class X extends _e{constructor(r=new Map([[0,0],[1,0],[2,0],[3,0]])){super(),this.counts=r}static fromJson(r){const e=new Map([[0,0],[1,0],[2,0],[3,0]]);for(const[n,i]of Object.entries(r))console.assert(typeof i=="number"),e.set(Number(n),i);return new X(e)}add(r){const e=new Map(this.counts);for(const[n,i]of r.counts.entries())e.set(n,e.get(n)+i);return new X(e)}subtract(r){const e=new Map(this.counts);for(const[n,i]of r.counts.entries())e.set(n,e.get(n)-i);return new X(e)}sum(){return qe(this.counts.values())}}var tt=(s=>(s[s.OVERRUN=0]="OVERRUN",s[s.INVALID=1]="INVALID",s[s.VALID=2]="VALID",s[s.INTERESTING=3]="INTERESTING",s))(tt||{});class ge extends _e{constructor(e,n,i,a,l,o,h,c){super();j(this,"status_counts_diff");j(this,"elapsed_time_diff");j(this,"timestamp_monotonic");this.elapsed_time=e,this.timestamp=n,this.status_counts=i,this.behaviors=a,this.fingerprints=l,this.since_new_branch=o,this.phase=h,this.worker_uuid=c,this.status_counts_diff=null,this.elapsed_time_diff=null,this.timestamp_monotonic=null}get ninputs(){return this.status_counts.sum()}static fromJson(e,n){return new ge(n.elapsed_time,n.timestamp,X.fromJson(n.status_counts),n.behaviors,n.fingerprints,n.since_new_branch,n.phase,e)}}function Ie(s,r){const e=r?r.status_counts:new X,n=r?r.elapsed_time:0,i=s.status_counts.subtract(e),a=s.elapsed_time-n,l=r?Math.max(s.timestamp,r.timestamp_monotonic+a):s.timestamp;return console.assert(Array.from(i.counts.values()).every(o=>o>=0)),console.assert(a>=0),s.withProperties({status_counts_diff:i,elapsed_time_diff:a,timestamp_monotonic:l})}class Z extends _e{constructor(e,n,i,a,l,o,h,c,u,m,b){super();j(this,"isDuplicate",null);j(this,"isUnique",null);this.type=e,this.status=n,this.status_reason=i,this.representation=a,this.arguments_=l,this.how_generated=o,this.features=h,this.timing=c,this.metadata=u,this.property=m,this.run_start=b}static fromJson(e){return new Z(e.type,e.status,e.status_reason,e.representation,new Map(Object.entries(e.arguments)),e.how_generated,new Map(Object.entries(e.features)),new Map(Object.entries(e.timing)),new Map(Object.entries(e.metadata)),e.property,Number(e.run_start))}}var me=(s=>(s[s.FAILED=0]="FAILED",s[s.SHRINKING=1]="SHRINKING",s[s.RUNNING=2]="RUNNING",s[s.WAITING=3]="WAITING",s))(me||{});const re=class re extends _e{constructor(e,n,i,a,l,o){super();j(this,"linear_reports");j(this,"_status_counts_cumsum");j(this,"_elapsed_time_cumsum");this.database_key=e,this.nodeid=n,this.rolling_observations=i,this.corpus_observations=a,this.failure=l,this.reports_by_worker=o,this.linear_reports=[],this._status_counts_cumsum=new Map,this._elapsed_time_cumsum=new Map;const h=this.reports_by_worker;this.reports_by_worker=new Map;const c=Array.from(h.entries()).flatMap(([u,m])=>m.map(b=>[u,b])).sortKey(([u,m])=>m.timestamp);for(const[u,m]of c)this.add_report(u,m);this._check_invariants()}static fromJson(e){return new re(e.database_key,e.nodeid,[],[],e.failure?Z.fromJson(e.failure):null,new Map(Object.entries(e.reports_by_worker).map(([n,i])=>[n,i.map(ge.fromJson)])))}_assert_reports_ordered(e){for(let n=0;n<e.length-1;n++)console.assert(e[n].timestamp_monotonic<=e[n+1].timestamp_monotonic)}_check_invariants(){this._assert_reports_ordered(this.linear_reports);const e=this.linear_status_counts(null);for(let i=0;i<e.length-1;i++)console.assert(e[i].sum()<=e[i+1].sum());const n=this.linear_elapsed_time(null);for(let i=0;i<n.length-1;i++)console.assert(n[i]<=n[i+1]);console.assert(n.length===e.length&&e.length===this.linear_reports.length);for(const[i,a]of this.reports_by_worker.entries())this._assert_reports_ordered(a)}add_report(e,n){let i=null,a=0;if(this.reports_by_worker.has(e)){const o=this.reports_by_worker.get(e);a=ye(o,n.elapsed_time,h=>h.elapsed_time),i=a!=0?o[a-1]:null}const l=Ie(n,i);if(e in this.reports_by_worker||this.reports_by_worker.set(e,[]),this.reports_by_worker.get(e).splice(a,0,l),l.phase!=="replay"){const o=ye(this.linear_reports,l.timestamp_monotonic,h=>h.timestamp_monotonic);if(this.linear_reports.splice(o,0,l),o!=this.linear_reports.length-1){let h=null,c;for(c=0;c<this.linear_reports.length-(o+1);c++){const u=this.linear_reports[o+1+c];if(l.worker_uuid===u.worker_uuid){h=u;break}}h&&(console.assert(this.linear_reports[o+1+c]===h),this.linear_reports[o+1+c]=Ie(h,l));for(const u of[this._status_counts_cumsum,this._elapsed_time_cumsum])for(const[m,[b,d]]of u.entries())o>=b&&u.set(m,[b,d.slice(0,o-b)])}}}get status(){if(this.failure)return 0;if(this.linear_reports.length===0)return 3;const e=this.linear_reports[this.linear_reports.length-1],n=new Date().getTime()/1e3;return e.phase=="shrink"?1:e.ninputs===0||e.timestamp<n-re.WAITING_STATUS_DURATION?3:2}get behaviors(){return this.linear_reports.length===0?0:this.linear_reports[this.linear_reports.length-1].behaviors}get fingerprints(){return this.linear_reports.length===0?0:this.linear_reports[this.linear_reports.length-1].fingerprints}get since_new_branch(){return this.linear_reports.length===0?null:this.linear_reports[this.linear_reports.length-1].since_new_branch}elapsed_time(e){const n=this.linear_elapsed_time(e);return n.length===0?0:n[n.length-1]}ninputs(e){const n=this.linear_status_counts(e);return n.length===0?0:n[n.length-1].sum()}_cumsum(e,n,i,a,l){if(a===null&&(a=-1/0),e.has(a)){const[u,m]=e.get(a);if(m.length<this.linear_reports.slice(u).length){let b=m.length>0?m[m.length-1]:l;for(const d of this.linear_reports.slice(u+m.length))b=i(b,d[n]),m.push(b);e.set(a,[u,m])}return m}const o=[],h=ye(this.linear_reports,a,u=>u.timestamp_monotonic);let c=l;for(const u of this.linear_reports.slice(h))c=i(c,u[n]),o.push(c);return e.set(a,[h,o]),o}linear_status_counts(e){return this._cumsum(this._status_counts_cumsum,"status_counts_diff",(n,i)=>n.add(i),e,new X)}linear_elapsed_time(e){return this._cumsum(this._elapsed_time_cumsum,"elapsed_time_diff",(n,i)=>n+i,e,0)}};j(re,"WAITING_STATUS_DURATION",120);let Ae=re;const st=x.createContext(null);function De(s){const r=new Map;s.forEach(n=>{r.set(n.representation,(r.get(n.representation)||0)+1)}),s.forEach(n=>{const i=r.get(n.representation);n.isUnique=i==1,n.isDuplicate=i>1});const e=new Set;s.forEach(n=>{n.features.forEach((i,a)=>{e.add(a)})}),s.forEach(n=>{e.forEach(i=>{n.features.has(i)||n.features.set(i,pe)});for(const[i,a]of n.features)a===""&&n.features.set(i,he)})}function es(s,r){const e=new Map(s);function n(i){if(e.has(i))return e.get(i);{const a=new Ae(null,i,[],[],null,new Map);return e.set(a.nodeid,a),a}}switch(r.type){case 1:{const{tests:i}=r;for(const{database_key:a,nodeid:l,failure:o}of i){const h=n(l);h.database_key=a,h.failure=o?Z.fromJson(o):null}return e}case 2:{const{nodeid:i,worker_uuid:a,reports:l}=r,o=n(i);for(const h of l)o.add_report(a,h);return e}case 4:{const{nodeid:i,failure:a}=r,l=n(i);return l.failure=a,e}case 3:{const{nodeid:i,observation_type:a,observations:l}=r,o=n(i);return a==="rolling"?(o.rolling_observations.push(...l),o.rolling_observations=o.rolling_observations.sortKey(h=>-h.run_start).slice(0,300),De(o.rolling_observations)):(console.assert(a==="corpus"),o.corpus_observations.push(...l),De(o.corpus_observations)),e}default:throw new Error("non-exhaustive switch in testsReducer")}}function ts({children:s}){const[r,e]=x.useState(null),[n,i]=x.useReducer(es,new Map),[a,l]=x.useState(!1),[o,h]=x.useState(null),c=u=>{l(!0),h(u)};return x.useEffect(()=>{if(a){n.clear();{fetch(new URL("dashboard_state/tests.json",import.meta.url)).then(m=>m.text()).then(m=>JSON.parse(m)).then(m=>{Object.entries(m).forEach(([b,d])=>{i({type:1,tests:[{database_key:d.database_key,nodeid:b,failure:d.failure}]});for(const[_,L]of Object.entries(d.reports_by_worker))i({type:2,nodeid:b,worker_uuid:_,reports:L.map(y=>ge.fromJson(_,y))})})});const u=new Worker(new URL("/example-dashboard/assets/jsonWorker-KJVNTzbb.js",import.meta.url));return fetch(new URL("dashboard_state/observations.json",import.meta.url)).then(m=>m.text()).then(m=>new Promise(b=>{u.onmessage=d=>b(d.data),u.postMessage(m)})).then(m=>{for(const[b,d]of Object.entries(m))i({type:3,nodeid:b,observation_type:"rolling",observations:d.rolling.map(Z.fromJson)}),i({type:3,nodeid:b,observation_type:"corpus",observations:d.corpus.map(Z.fromJson)})}),()=>u.terminate()}}},[o,a]),t.jsx(st.Provider,{value:{tests:n,socket:r,doLoadData:c},children:s})}function nt(s=null){const r=x.useContext(st);if(!r)throw new Error("useData must be used within a DataProvider");return r.doLoadData(s),r}function Te({headers:s,data:r,row:e,mobileRow:n,getKey:i,onFilterChange:a,filterStrings:l}){const[o,h]=x.useState(null),[c,u]=x.useState(0),[m,b]=x.useState(""),d=ke(),_=x.useMemo(()=>{let f=r;if(m&&(f=r.filter(C=>l?l(C).some(R=>R.toLowerCase().includes(m.toLowerCase())):!0)),o===null)return f;const S=[...f].sortKey(C=>s[o].sortKey(C));return c===0?S:S.reverse()},[r,o,c,s,m,e,l,n,d]),L=f=>{s[f].sortKey&&(o===f?u(S=>S===0?1:0):(h(f),u(0)))};function y(f){b(f),a==null||a(f)}return t.jsxs("div",{className:"table",children:[l!==void 0&&t.jsxs("div",{className:"table__filter",children:[t.jsx("input",{type:"text",placeholder:"Filter",value:m,onChange:f=>y(f.target.value),className:"table__filter__input"}),m&&t.jsx("span",{className:"table__filter__clear",onClick:()=>y(""),children:t.jsx(k,{icon:Nt})})]}),n!==void 0&&d?_.map(f=>t.jsx("div",{children:n(f)},i?i(f):void 0)):t.jsxs("table",{className:"table__table",children:[t.jsx("thead",{children:t.jsx("tr",{children:s.map((f,S)=>t.jsx("th",{onClick:()=>L(S),className:f.sortKey?"table--sortable":"",children:t.jsxs("div",{className:`table__header table__header--${f.align??"left"}`,children:[f.content,f.sortKey&&t.jsx("div",{className:"table__sort",children:[0,1].map(C=>t.jsx("div",{className:`table__sort__arrow table__sort__arrow--${C===0?"asc":"desc"} ${o===S&&c===C?"table__sort__arrow--active":""}`,children:C===0?t.jsx(k,{icon:St}):t.jsx(k,{icon:At})}))})]})},S))})}),t.jsx("tbody",{children:_.map(f=>{const S=e(f);return console.assert(S.length===s.length),t.jsx("tr",{children:S.map((C,R)=>t.jsx("td",{children:C},R))},i?i(f):void 0)})})]}),m&&_.length<r.length&&t.jsxs("div",{className:"table__filter-status",children:["Showing ",_.length," of ",r.length," rows",t.jsx("span",{className:"table__filter-status__clear",onClick:()=>{b(""),a==null||a("")},children:"[clear]"})]})]})}async function rt(s){return(await(await fetch(new URL("dashboard_state/api.json",import.meta.url))).json())[s.replace(/\/$/,"")]}const Oe={not_collected:0,collected:1};function ss(){const[s,r]=x.useState(null);if(x.useEffect(()=>{rt("collected_tests/").then(a=>{r(a)})},[]),s===null)return null;if(!s.collection_status.length)return t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card__header",children:"Test collection"}),"No tests collected."]});const e=[...s.collection_status].sortKey(a=>[Oe[a.status],a.status_reason,a.nodeid]),n=[{content:"Test",sortKey:a=>a.nodeid},{content:"Status",sortKey:a=>[Oe[a.status],a.status_reason],align:"center"}],i=a=>[t.jsx("div",{style:{wordBreak:"break-all"},children:a.status=="collected"?t.jsx(W,{to:`/tests/${encodeURIComponent(a.nodeid)}`,className:"test__link",children:a.nodeid}):a.nodeid}),t.jsx("div",{style:{textAlign:"center"},children:a.status==="collected"?t.jsx("div",{className:"pill pill__success",children:"Collected"}):t.jsxs("div",{className:"pill pill__neutral",children:["Not collected (",a.status_reason,")"]})})];return t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card__header",children:"Test collection status"}),t.jsx(Te,{headers:n,data:e,row:i,getKey:a=>a.database_key,filterStrings:a=>[a.nodeid,a.status==="collected"?"Collected":`Not collected (${a.status_reason})`]})]})}function ns(){return t.jsx("h1",{children:"Page not found!"})}function rs(s){const r=s.regex;return{name:"Diff",aliases:["patch"],contains:[{className:"meta",relevance:10,match:r.either(/^@@ +-\d+,\d+ +\+\d+,\d+ +@@/,/^\*\*\* +\d+,\d+ +\*\*\*\*$/,/^--- +\d+,\d+ +----$/)},{className:"comment",variants:[{begin:r.either(/Index: /,/^index/,/={3,}/,/^-{3}/,/^\*{3} /,/^\+{3}/,/^diff --git/),end:/$/},{match:/^\*{15}$/}]},{className:"addition",begin:/^\+/,end:/$/},{className:"deletion",begin:/^-/,end:/$/},{className:"addition",begin:/^!/,end:/$/}]}}ce.registerLanguage("diff",rs);function is(){const[s,r]=x.useState({}),[e,n]=x.useState(!0);return x.useEffect(()=>{rt("patches").then(i=>{i&&r(i),n(!1)})},[]),x.useEffect(()=>{ce.highlightAll()},[s]),e?t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card__header",children:"Patches"}),t.jsx("p",{children:"Loading patches..."})]}):Object.values(s).length==0?t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card__header",children:"Patches"}),t.jsx("p",{children:"No patches yet"})]}):t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card__header",children:"Patches"}),t.jsx("div",{className:"patches-list",children:Object.entries(s).map(([i,a])=>t.jsxs("div",{className:"patch",children:[t.jsx("h3",{children:i}),t.jsx("pre",{children:t.jsx("code",{className:"language-diff",children:a})})]},i))})]})}function we(s,r){const[e,n]=x.useState(()=>{const i=sessionStorage.getItem(s);return i===null?r:JSON.parse(i)});return x.useEffect(()=>{sessionStorage.setItem(s,JSON.stringify(e))},[e,s]),[e,n]}const T={scaleSymlog:Bt,scaleLinear:Ge,select:We,zoom:Ft,zoomIdentity:Mt,pointer:Lt,line:Tt,axisBottom:Xe,axisLeft:He,brush:$t,scaleOrdinal:Ye,schemeCategory10:Ct,quadtree:kt},Q={x:0,y:0};typeof window<"u"&&window.addEventListener("mousemove",s=>{Q.x=s.clientX,Q.y=s.clientY});const as=10;function Ve(s,r,e="horizontal",n=12,i=6){const a=s.node().getBBox(),l=T.select(s.node().parentNode);let o,h;o=a.x-n-i,h=a.y+(a.height-n)/2,l.append("svg").attr("x",o).attr("y",h).attr("width",n).attr("height",n).attr("viewBox",`0 0 ${r.icon[0]} ${r.icon[1]}`).append("path").attr("d",r.icon[4])}class os{constructor(r,e,n,i,a,l,o,h){j(this,"reports");j(this,"scaleSetting");j(this,"axisSettingX");j(this,"axisSettingY");j(this,"xValue");j(this,"yValue");j(this,"width");j(this,"height");j(this,"margin");j(this,"x");j(this,"y");j(this,"g");j(this,"zoom");j(this,"chartArea");j(this,"navigate");j(this,"tooltip");j(this,"brush",null);j(this,"eventListeners",new Map);j(this,"xAxis");j(this,"yAxis");j(this,"reportsColor");j(this,"viewportX");j(this,"viewportY");j(this,"quadtree");this.reports=e,this.scaleSetting=i,this.axisSettingX=a,this.axisSettingY=l,this.navigate=o,this.xValue=f=>a=="time"?f.linear_elapsed_time:f.linear_status_counts.sum(),this.yValue=f=>l=="behaviors"?f.behaviors:f.fingerprints,this.margin={top:20,right:20,bottom:h?40:45,left:h?50:60},this.width=r.clientWidth-this.margin.left-this.margin.right,this.height=300-this.margin.top-this.margin.bottom,this.reportsColor=n;const c=Array.from(e.values()).flat();this.x=(i==="log"?T.scaleSymlog():T.scaleLinear()).domain([0,Se(c,f=>this.xValue(f))||1]).range([0,this.width]),this.y=T.scaleLinear().domain([0,Se(c,f=>this.yValue(f))||0]).range([this.height,0]),this.viewportX=this.x,this.viewportY=this.y,this.g=T.select(r).append("g").attr("transform",`translate(${this.margin.left},${this.margin.top})`),this.g.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",this.width).attr("height",this.height+5).attr("x",0).attr("y",-5),this.chartArea=this.g.append("g").attr("class","chart-area").attr("clip-path","url(#clip)"),this.chartArea.append("rect").attr("width",this.width).attr("height",this.height).attr("fill","none").attr("pointer-events","all"),this.zoom=T.zoom().scaleExtent([1,1/0]).on("zoom",f=>this.zoomTo(f.transform,!1)),this.chartArea.call(this.zoom),this.chartArea.on("dblclick.zoom",()=>{this.chartArea.transition().duration(500).call(this.zoom.transform,T.zoomIdentity)}),this.tooltip=T.select(".coverage-graph__tooltip"),this.xAxis=this.g.append("g").attr("transform",`translate(0,${this.height})`).call(this.createXAxis(this.x)),this.yAxis=this.g.append("g").call(this.createYAxis(this.y));const u=this.g.append("g").attr("transform",`translate(${-this.margin.left}, ${this.height/2}) rotate(-90)`),m=this.axisSettingY=="behaviors"?ie:ae,b=this.axisSettingY=="behaviors"?"Behaviors":"Fingerprints",d=u.append("text").attr("x",0).attr("y",0).attr("dy","1em").style("text-anchor","middle").text(b);Ve(d,m,"vertical");const _=this.axisSettingX=="time"?le:oe,L=this.axisSettingX=="time"?"Time (s)":"Inputs",y=this.g.append("text").attr("x",this.width/2).attr("y",this.height+this.margin.bottom-5).style("text-anchor","middle").text(L);Ve(y,_,"horizontal"),this.chartArea.on("mousemove",f=>{const[S,C]=T.pointer(f),R=this.quadtree.find(S,C,as);R?this.tooltip.style("display","block").style("left",`${f.pageX+10}px`).style("top",`${f.pageY-10}px`).html(`
              <strong>${R.nodeid.split("::").pop()||R.nodeid}</strong><br/>
              ${R.behaviors.toLocaleString()} behaviors / ${R.fingerprints.toLocaleString()} fingerprints<br/>
              ${R.ninputs.toLocaleString()} inputs / ${R.elapsed_time.toFixed(1)} seconds
            `):this.tooltip.style("display","none")}).on("mouseout",()=>{this.tooltip.style("display","none")}),this.drawLines(),this.updateQuadtree()}createXAxis(r){if(this.scaleSetting==="log"){const e=r.domain()[1],n=[0];let i=1;for(;i<=e;)n.push(i),i*=10;return T.axisBottom(r).tickValues(n).tickFormat(a=>{const l=a.valueOf();return console.assert(l>=0),l>=1e6?`${Math.floor(l/1e6)}M`:l>=1e3?`${Math.floor(l/1e3)}k`:l>0?l.toLocaleString():"0"})}else return T.axisBottom(r).ticks(5).tickFormat(e=>e.toLocaleString())}createYAxis(r){return T.axisLeft(r).ticks(5)}updateQuadtree(){const r=Array.from(this.reports.values()).flat();this.quadtree=T.quadtree().x(e=>this.viewportX(this.xValue(e))).y(e=>this.viewportY(this.yValue(e))).addAll(r)}zoomTo(r,e){const n=r.rescaleX(this.x),i=e?r.rescaleY(this.y):this.y;this.viewportX=n,this.viewportY=i,this.xAxis.call(this.createXAxis(n)),e&&this.yAxis.call(this.createYAxis(i)),this.g.selectAll(".chart-area path").attr("d",T.line().x(a=>n(this.xValue(a))).y(a=>i(this.yValue(a)))),this.updateQuadtree()}drawLines(){const r=T.line().x(e=>this.x(this.xValue(e))).y(e=>this.y(this.yValue(e)));Array.from(this.reports.entries()).forEach(([e,n])=>{this.chartArea.append("path").datum(n).attr("fill","none").attr("stroke",this.reportsColor(e)).attr("d",r).attr("class","coverage-line").style("cursor","pointer").on("mouseover",function(){T.select(this).classed("coverage-line__selected",!0)}).on("mouseout",function(){T.select(this).classed("coverage-line__selected",!1)}).on("click",i=>{i.metaKey||i.ctrlKey?window.open(`/tests/${encodeURIComponent(e)}`,"_blank"):this.navigate(`/tests/${encodeURIComponent(e)}`)})})}enableBoxBrush(){for(const r of["wheel","mousedown","mousemove","mouseup"])this.chartArea.on(`${r}.zoom`,null);this.brush=T.brush().extent([[0,0],[this.width,this.height]]).on("end",r=>{if(!r.selection)return;const[[e,n],[i,a]]=r.selection;if(this.chartArea.call(this.brush.clear),this.chartArea.call(this.zoom),Math.abs(i-e)<5||Math.abs(a-n)<5){this.emit("boxSelectEnd");return}const l=this.width/(i-e),o=this.height/(a-n),h=Math.max(l,o),c=T.zoomIdentity.translate(this.width/2,this.height/2).scale(h).translate(-(e+i)/2,-(n+a)/2);this.chartArea.transition().duration(250).call(this.zoom.transform,c).on("end",()=>{this.emit("boxSelectEnd")})}),this.chartArea.style("cursor","crosshair").call(this.brush)}cleanup(){this.tooltip.style("display","none"),this.g.selectAll("path").classed("coverage-line__selected",!1)}on(r,e){this.eventListeners.has(r)||this.eventListeners.set(r,[]),this.eventListeners.get(r).push(e)}off(r,e){this.eventListeners.has(r)&&this.eventListeners.set(r,this.eventListeners.get(r).filter(n=>n!==e))}emit(r){this.eventListeners.has(r)&&this.eventListeners.get(r).forEach(e=>e())}}function it({tests:s,filterString:r=""}){const e=x.useRef(null),[n,i]=we("graph_scale","log"),[a,l]=we("graph_axis_x","time"),[o,h]=we("graph_axis_y","behaviors"),[c,u]=x.useState(!0),[m,b]=x.useState({transform:null,zoomY:!1}),[d,_]=x.useState(!1),L=ht(),y=ke(),f=x.useMemo(()=>new Map(Array.from(s.entries()).sortKey(([E,v])=>E).map(([E,v])=>{const A=v.linear_status_counts(null),F=v.linear_elapsed_time(null),D=[];for(let p=0;p<A.length;p++){const g=v.linear_reports[p];D.push({nodeid:E,linear_status_counts:A[p],linear_elapsed_time:F[p],behaviors:g.behaviors,fingerprints:g.fingerprints,ninputs:g.ninputs,elapsed_time:g.elapsed_time})}return[E,D]})),[s]),S=x.useMemo(()=>r?new Map(Array.from(f.entries()).filter(([E])=>E.toLowerCase().includes(r.toLowerCase()))):f,[f,r]),C=T.scaleOrdinal(T.schemeCategory10).domain(f.keys());x.useEffect(()=>{if(!e.current)return;const E=e.current.getBoundingClientRect();if(!c&&Q.x>=E.left&&Q.x<=E.right&&Q.y>=E.top&&Q.y<=E.bottom)return;c&&u(!1),T.select(e.current).selectAll("*").remove();const v=new os(e.current,S,C,n,a,o,L,y);return m.transform&&v.zoom.transform(v.chartArea,m.transform),v.zoomTo(m.transform??T.zoomIdentity,m.zoomY),v.zoom.on("zoom.saveTransform",A=>{b({transform:A.transform,zoomY:!1})}),d&&v.enableBoxBrush(),v.on("boxSelectEnd",R),()=>{v.cleanup()}},[S,n,a,o,c,d,L]);const R=()=>{_(!d),u(!0)};return t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card__header",children:"Coverage"}),t.jsxs("div",{className:"coverage-graph__controls",children:[t.jsx(de,{value:o,onChange:h,options:[{value:"behaviors",content:t.jsxs(t.Fragment,{children:[t.jsx(k,{icon:ie})," Behaviors"]}),mobileContent:t.jsx(k,{icon:ie})},{value:"fingerprints",content:t.jsxs(t.Fragment,{children:[t.jsx(k,{icon:ae})," Fingerprints"]}),mobileContent:t.jsx(k,{icon:ae})}]}),t.jsx(de,{value:a,onChange:l,options:[{value:"inputs",content:t.jsxs(t.Fragment,{children:[t.jsx(k,{icon:oe})," Inputs"]}),mobileContent:t.jsx(k,{icon:oe})},{value:"time",content:t.jsxs(t.Fragment,{children:[t.jsx(k,{icon:le})," Time"]}),mobileContent:t.jsx(k,{icon:le})}]}),t.jsx(de,{value:n,onChange:i,options:[{value:"linear",content:"Linear"},{value:"log",content:"Log"}]})]}),t.jsx("div",{className:"coverage-graph__tooltip"}),t.jsx("svg",{className:"coverage-graph__svg",ref:e,style:{width:"100%",height:"300px"}})]})}function Re({status:s}){return t.jsx("span",{style:{textAlign:"center"},children:s===me.FAILED?t.jsx("span",{className:"pill pill__failure",children:"Failed"}):s===me.SHRINKING?t.jsx("span",{className:"pill pill__warning",children:"Shrinking"}):s===me.RUNNING?t.jsx("span",{className:"pill pill__success",children:"Running"}):t.jsx("span",{className:"pill pill__neutral",children:"Waiting"})})}function H({content:s,tooltip:r}){return t.jsxs("div",{className:"tooltip",children:[s,t.jsx("div",{className:"tooltip__text",children:r})]})}function ls(s){const r=Math.floor(s/3600),e=Math.floor(s%3600/60),n=Math.floor(s%60);return`${r>0?`${r}:${e.toString().padStart(2,"0")}`:e}:${n.toString().padStart(2,"0")}`}function at(s){const r=s.ninputs(null),e=s.elapsed_time(null);return e===0?null:r/e}function Ee(s){var e;if(s.linear_reports.length===0)return{inputs:"—",behaviors:"—",fingerprints:"—",executions:"—",inputsSinceBranch:"—",timeSpent:"—"};const r=at(s);return{inputs:s.ninputs(null).toLocaleString(),behaviors:s.behaviors.toLocaleString(),fingerprints:s.fingerprints.toLocaleString(),executions:r===null?"—":`${r.toFixed(1).toLocaleString()}/s`,inputsSinceBranch:((e=s.since_new_branch)==null?void 0:e.toLocaleString())??"—",timeSpent:ls(s.elapsed_time(null))}}ce.registerLanguage("python",et);function cs(){const{nodeid:s}=pt(),{tests:r}=nt(s);if(!s||!r.has(s))return t.jsx("div",{children:"Test not found"});const e=r.get(s),n=Ee(e),i=[{content:t.jsx(H,{content:t.jsx("div",{className:"table__header__icon",children:t.jsx(k,{icon:oe})}),tooltip:"Number of inputs"})},{content:t.jsx(H,{content:t.jsx("div",{className:"table__header__icon",children:t.jsx(k,{icon:ie})}),tooltip:"Number of behaviors (typically branches) found"})},{content:t.jsx(H,{content:t.jsx("div",{className:"table__header__icon",children:t.jsx(k,{icon:ae})}),tooltip:"Number of fingerprints (sets of behaviors) found"})},{content:t.jsx(H,{content:t.jsx("div",{className:"table__header__icon",children:t.jsx(k,{icon:Ue})}),tooltip:"Inputs per second"})},{content:t.jsx(H,{content:t.jsx("div",{className:"table__header__icon",children:t.jsx(k,{icon:Ke})}),tooltip:"Number of inputs since a new behavior"})},{content:t.jsx(H,{content:t.jsx("div",{className:"table__header__icon",children:t.jsx(k,{icon:le})}),tooltip:"Total time spent running"})}];return t.jsxs(t.Fragment,{children:[t.jsxs(W,{to:"/",className:"back-link",children:[t.jsx(k,{icon:Rt})," Back to all tests"]}),t.jsxs("div",{className:"card",children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.7rem"},children:[t.jsx("span",{style:{wordBreak:"break-all",fontSize:"1.5rem",fontWeight:"bold"},children:s}),t.jsx(Re,{status:e.status})]}),t.jsx("div",{style:{paddingTop:"1rem",paddingBottom:"1rem"},children:t.jsx(Te,{headers:i,data:[n],row:a=>[t.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:a.inputs}),t.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:a.behaviors}),t.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:a.fingerprints}),t.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:a.executions}),t.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:a.inputsSinceBranch}),t.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:a.timeSpent})]})})]}),t.jsx(it,{tests:new Map([[s,e]])}),t.jsx(Zt,{test:e}),e.failure&&t.jsxs("div",{className:"test-failure",children:[t.jsx("h2",{children:"Failure"}),t.jsxs("div",{className:"test-failure__item",children:[t.jsx("h3",{children:"Call"}),t.jsx("pre",{children:t.jsx("code",{className:"language-python",children:e.failure.metadata.get("reproduction_decorator")+`
`+e.failure.representation})}),t.jsx("h3",{children:"Traceback"}),t.jsx("pre",{children:t.jsx("code",{className:"language-python",children:e.failure.metadata.get("traceback")})})]})]})]})}function q({icon:s,tooltip:r}){return t.jsx(H,{content:t.jsx("div",{className:"table__header__icon",children:t.jsx(k,{icon:s})}),tooltip:r})}function se({icon:s,value:r}){return t.jsxs("div",{className:"table__inline-statistic",children:[s,t.jsx("span",{className:"table__inline-statistic__value",children:r})]})}function us({tests:s,onFilterChange:r}){const e=Array.from(s).sortKey(([d,_])=>[_.status,d]).map(([d,_])=>_),n=t.jsx(q,{icon:oe,tooltip:"Number of inputs"}),i=t.jsx(q,{icon:ie,tooltip:"Number of behaviors (typically branches) found"}),a=t.jsx(q,{icon:ae,tooltip:"Number of fingerprints (sets of behaviors) found"}),l=t.jsx(q,{icon:Ue,tooltip:"Inputs per second"}),o=t.jsx(q,{icon:Ke,tooltip:"Number of inputs since a new behavior"}),h=t.jsx(q,{icon:le,tooltip:"Total time spent running"}),c=[{content:"Test",sortKey:d=>d.nodeid},{content:"Status",sortKey:d=>d.status,align:"center"},{content:n,align:"right",sortKey:d=>d.ninputs(null)},{content:i,align:"right",sortKey:d=>d.behaviors},{content:a,align:"right",sortKey:d=>d.fingerprints},{content:l,align:"right",sortKey:d=>at(d)??-1},{content:o,align:"right",sortKey:d=>d.since_new_branch??0},{content:h,align:"right",sortKey:d=>d.elapsed_time(null)}],u=d=>{const _=Ee(d);return[t.jsx(W,{to:`/tests/${encodeURIComponent(d.nodeid)}`,className:"test__link",style:{wordBreak:"break-all"},children:d.nodeid}),t.jsx("div",{style:{textAlign:"center"},children:t.jsx(Re,{status:d.status})}),t.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:_.inputs}),t.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:_.behaviors}),t.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:_.fingerprints}),t.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:_.executions}),t.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:_.inputsSinceBranch}),t.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:_.timeSpent})]};function m(d){const _=Ee(d);return t.jsxs("div",{className:"table__mobile-row",children:[t.jsxs("div",{className:"table__mobile-row__header",children:[t.jsx(W,{to:`/tests/${encodeURIComponent(d.nodeid)}`,className:"test__link",style:{wordBreak:"break-all"},children:d.nodeid}),t.jsx(Re,{status:d.status})]}),t.jsxs("div",{className:"table__mobile-row__statistics",children:[t.jsx(se,{icon:n,value:_.inputs}),t.jsx(se,{icon:i,value:_.behaviors}),t.jsx(se,{icon:l,value:_.executions}),t.jsx(se,{icon:o,value:_.inputsSinceBranch}),t.jsx(se,{icon:h,value:_.timeSpent})]})]})}function b(d){return[d.nodeid,tt[d.status]]}return t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"card__header",children:"Tests"}),t.jsx(Te,{headers:c,data:e,row:u,mobileRow:m,filterStrings:b,onFilterChange:r})]})}function ds(){const{tests:s}=nt(),[r,e]=x.useState("");return t.jsxs("div",{className:"dashboard",children:[t.jsx(it,{tests:s,filterString:r}),t.jsx(us,{tests:s,onFilterChange:e})]})}function hs(){const s=mt;return t.jsx(s,{children:t.jsx(ts,{children:t.jsx(ft,{children:t.jsxs(Y,{element:t.jsx(Vt,{}),children:[t.jsx(Y,{path:"/",element:t.jsx(ds,{})}),t.jsx(Y,{path:"/patches",element:t.jsx(is,{})}),t.jsx(Y,{path:"/collected",element:t.jsx(ss,{})}),t.jsx(Y,{path:"/tests/:nodeid",element:t.jsx(cs,{})}),t.jsx(Y,{path:"*",element:t.jsx(ns,{})})]})})})})}Ot.createRoot(document.getElementById("app")).render(t.jsx(_t.StrictMode,{children:t.jsx(hs,{})}));
