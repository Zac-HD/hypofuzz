var jt=Object.defineProperty;var wt=(t,r,s)=>r in t?jt(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s;var E=(t,r,s)=>wt(t,typeof r!="symbol"?r+"":r,s);import{r as Nt,g as qe,a as h,u as Te,b as St,L as Q,O as kt,c as Je,d as At,H as Rt,e as Ct,f as Y,R as Et}from"./react-DOgvK_Td.js";import{r as Mt,S as O,F as $,f as Tt,a as $t,b as Qe,c as Lt,d as Pt,L as Z,e as Ft,g as It,h as Dt,i as Bt,j as Ot,k as Ut,l as Vt,m as zt,n as re,o as ie,p as ae,q as oe,s as Wt,t as Ze,u as et,O as Kt}from"./vendor-BddXVpZ4.js";import{d as tt,a as st,b as nt,c as Ht,o as rt,l as it,q as Xt,e as Gt,f as Yt,g as qt,h as Jt,i as Qt,j as Zt,s as es}from"./d3-CO-FEQw9.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();var je={exports:{}},te={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ue;function ts(){if(Ue)return te;Ue=1;var t=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function s(n,i,a){var l=null;if(a!==void 0&&(l=""+a),i.key!==void 0&&(l=""+i.key),"key"in i){a={};for(var d in i)d!=="key"&&(a[d]=i[d])}else a=i;return i=a.ref,{$$typeof:t,type:n,key:l,ref:i!==void 0?i:null,props:a}}return te.Fragment=r,te.jsx=s,te.jsxs=s,te}var Ve;function ss(){return Ve||(Ve=1,je.exports=ts()),je.exports}var e=ss();Array.prototype.sortKey||(Array.prototype.sortKey=function(t){return this.sort((r,s)=>{const n=t(r),i=t(s);if(Array.isArray(n)&&Array.isArray(i)){for(let a=0;a<Math.min(n.length,i.length);a++){if(n[a]<i[a])return-1;if(n[a]>i[a])return 1}return 0}return n<i?-1:n>i?1:0})});var ns=Nt();const rs=qe(ns);function $e(){const[t,r]=h.useState(!1);return h.useEffect(()=>{function s(){r(window.matchMedia("(max-width: 768px)").matches)}return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),t}function le({value:t,onChange:r,options:s}){const n=$e();return e.jsx("div",{className:"scale-toggle",children:s.map(i=>e.jsx("button",{className:`scale-toggle__button${t===i.value?" scale-toggle__button--active":""}`,onClick:()=>{if(s.length==2&&t===i.value){const a=s.find(l=>l.value!==i.value).value;r(a)}else r(i.value)},children:n?i.mobileContent??i.content:i.content},String(i.value)))})}const at=h.createContext(null);function is({state:t}){return t.visible?St.createPortal(e.jsx("div",{className:"cursor-tooltip",style:{position:"fixed",left:`${t.x+10}px`,top:`${t.y-28}px`,display:"block",pointerEvents:"none",zIndex:9999},dangerouslySetInnerHTML:{__html:t.content}}),document.body):null}function as({children:t}){const r=Te(),[s,n]=h.useState({visible:!1,content:"",x:0,y:0,owner:null});h.useEffect(()=>{n(c=>({...c,visible:!1,owner:null}))},[r.pathname]);const i=h.useCallback((c,o,u,m)=>{n({visible:!0,content:c,x:o,y:u,owner:m})},[]),a=h.useCallback(c=>{n(o=>o.owner===c?{...o,visible:!1,owner:null}:o)},[]),l=h.useCallback((c,o,u)=>{n(m=>m.visible&&m.owner===u&&(m.x!==c||m.y!==o)?{...m,x:c,y:o}:m)},[]),d=h.useMemo(()=>({showTooltip:i,hideTooltip:a,moveTooltip:l,visible:s.visible}),[i,a,l,s.visible]);return e.jsxs(at.Provider,{value:d,children:[t,e.jsx(is,{state:s})]})}function Le(){const t=h.useContext(at);if(!t)throw new Error("useTooltip must be used within a TooltipProvider");return t}var os=Mt();const de=qe(os);function ot(t,r=0){return Array.from(t).reduce((s,n)=>s+n,r)}function lt(t,r=!1){t.current&&(r&&t.current.querySelectorAll("code").forEach(s=>{s.removeAttribute("data-highlighted")}),t.current.querySelectorAll("code:not([data-highlighted='yes'])").forEach(s=>{de.highlightElement(s)}))}function Ae(t,r){let s=null;for(let n=0;n<t.length;n++){const i=t[n],a=r?r(i):i;a!=null&&(s===null||a>s)&&(s=a)}return s}function we(t,r,s){let n=0,i=t.length;for(;n<i;){const a=n+i>>>1;(s?s(t[a])<=r:t[a]<=r)?n=a+1:i=a}return n}let se=null;function ls(){return se||(se=document.createElement("div"),se.style.cssText=`
      position: absolute;
      visibility: hidden;
      white-space: nowrap;
      top: -9999px;
      left: -9999px;
      pointer-events: none;
      z-index: -1;
    `,document.body.appendChild(se)),se}function Ne(t,r=""){const s=ls();s.className=r,s.textContent=t;const n=s.getBoundingClientRect();return{width:n.width,height:n.height}}function ct(t,r,s){if(t.metaKey||t.ctrlKey){const n=window.location,i=`${n.origin}${n.pathname}#${r}`;console.log(n.origin,n.pathname,r,i),window.open(i,"_blank")}else s(r)}function ut(t){return t.split("::").pop()||t}class dt{constructor(r,s,n,i){E(this,"createdAt");this.name=r,this.predicate=s,this.component=n,this.extraData=i,this.createdAt=Date.now()}}const ht=h.createContext(void 0);function cs({children:t}){const[r,s]=h.useState(new Map([["covering",new Map],["rolling",new Map]])),[n,i]=h.useState("covering"),a=r.get(n)||new Map,l=o=>{s(u=>{const m=new Map(u);return m.set(n,o),m})},c={filters:a,setFilters:l,removeFilter:(o,u)=>{const m=new Map(a),p=(m.get(o)||[]).filter(g=>g.name!==u);p.length===0?m.delete(o):m.set(o,p),l(m)},observationCategory:n,setObservationCategory:i};return e.jsx(ht.Provider,{value:c,children:t})}function ve(){const t=h.useContext(ht);if(t===void 0)throw new Error("useFilters must be used within a FilterProvider");return t}const H={select:tt,scaleLinear:it,scaleOrdinal:rt,scaleBand:Ht,axisBottom:nt,axisLeft:st},ze=5,K=2.5;function us({feature:t,observations:r}){const s=h.useRef(null),n=h.useRef(null),{filters:i,setFilters:a}=ve(),{showTooltip:l,hideTooltip:d,moveTooltip:c}=Le(),o=i.get(t)||[],u=h.useMemo(()=>{if(o.length===0)return O();console.assert(o.length===1);const p=o[0];return O(p.extraData.selectedValues)},[o]),m=h.useMemo(()=>({raw:r.raw.filter(p=>p.status!=="gave_up"),filtered:r.filtered.filter(p=>p.status!=="gave_up")}),[r]),x=p=>{let g=O();u.equals(O([p]))?g=O():g=O([p]);let k;g.size===1?k=g.first():k=g.map(A=>`${A}`).join(" or ");const w=[];g.size>0&&w.push(new dt(k,A=>g.some(M=>A.features.get(t)===M),t,{selectedValues:g}));const f=new Map(i);f.set(t,w),a(f)};return h.useEffect(()=>{const p=O(m.raw.map(j=>j.features.get(t)));let g=new Map;for(const j of m.filtered){const T=j.features.get(t);g.set(T,(g.get(T)||0)+1)}const k=ot(Array.from(g.values()));g=new Map([...g.entries()].sortKey(([j,T])=>j===ge?0:j===xe?1:j)),H.select(n.current).selectAll("*").remove();const w=s.current.clientWidth,f=p.size<ze?85:170,A=H.select(n.current).attr("width",w).attr("height",f).append("g"),M=function(j,T){const[b,N]=T;l(`${t}<br>${b}: ${N}`,j.clientX,j.clientY,"tyche-nominal")};if(p.size<ze){const j={top:0,right:15,bottom:20,left:15},T=w-j.left-j.right,b=f-j.top-j.bottom,N=H.scaleLinear().domain([0,1]).range([0,T]);let v;g.has(ge)||g.has(xe)?v=U=>U===ge?B.SUCCESS:U===xe?B.ERROR:B.PRIMARY:v=H.scaleOrdinal().domain(Array.from(g.keys())).range([B.PRIMARY,B.ACCENT,B.ACCENT2,B.ACCENT3,B.ACCENT4]);const R=A.append("g").attr("transform",`translate(${j.left},${j.top})`);let S=0;const L=b-j.bottom;g.forEach((U,_)=>{const y=U/k*T,P=u.has(_);R.append("rect").attr("x",S).attr("y",0).attr("width",y).attr("height",L).attr("fill",v(_)).style("cursor","pointer").on("click",()=>x(_)).on("mouseover",F=>{M(F,[_,U])}).on("mousemove",F=>c(F.clientX,F.clientY,"tyche-nominal")).on("mouseleave",()=>d("tyche-nominal")),P&&R.append("rect").attr("x",S+K).attr("y",K).attr("width",y-2*K).attr("height",L-2*K).attr("fill",v(_)).attr("stroke","white").attr("stroke-width",K).style("pointer-events","none"),R.append("text").attr("x",S+y/2).attr("y",L/2).attr("text-anchor","middle").attr("dominant-baseline","central").attr("fill","white").text(_).style("font-size","12px"),S+=y}),R.append("g").attr("transform",`translate(0,${L})`).call(H.axisBottom(N).tickFormat(U=>`${Math.round(Number(U)*100)}%`)),R.append("text").attr("x",T/2).attr("y",L+30).attr("text-anchor","middle").text("% of observations").style("font-size","12px")}else{const j={top:5,right:5,bottom:30,left:30},T=w-j.left-j.right,b=f-j.top-j.bottom,N=H.scaleBand().domain(Array.from(g.keys())).range([0,T]).padding(.2),v=H.scaleLinear().domain([0,Ae(Array.from(g.values()))||0]).range([b,0]),R=A.append("g").attr("transform",`translate(${j.left},${j.top})`);R.selectAll(".bar").data(Array.from(g.entries())).enter().append("rect").attr("class","bar").attr("x",([S,L])=>N(S)||0).attr("y",([S,L])=>v(L)).attr("width",N.bandwidth()).attr("height",([S,L])=>b-v(L)).attr("fill",B.PRIMARY).style("cursor","pointer").on("click",function(S,[L,U]){x(L)}).on("mouseover",function(S,L){M(S,L)}).on("mousemove",S=>c(S.clientX,S.clientY,"tyche-nominal")).on("mouseleave",()=>d("tyche-nominal")),R.selectAll(".inner-bar").data(Array.from(g.entries()).filter(([S,L])=>u.has(S))).enter().append("rect").attr("class","inner-bar").attr("x",([S,L])=>(N(S)||0)+K).attr("y",([S,L])=>v(L)+K).attr("width",N.bandwidth()-2*K).attr("height",([S,L])=>b-v(L)-2*K).attr("fill",B.PRIMARY).attr("stroke","white").attr("stroke-width",K).style("pointer-events","none"),R.append("g").attr("transform",`translate(0,${b})`).call(H.axisBottom(N)).selectAll("text").attr("transform","rotate(-45)").style("text-anchor","end"),R.append("g").call(H.axisLeft(v).ticks(7).tickFormat(S=>Math.round(Number(S)).toString())),R.append("text").attr("transform","rotate(-90)").attr("y",-30).attr("x",-b/2).attr("text-anchor","middle").text("Count").style("font-size","12px")}},[m]),e.jsxs("div",{children:[e.jsx("div",{className:"tyche__nominal__feature",children:t}),e.jsx("div",{ref:s,className:"tyche__nominal__chart",children:e.jsx("svg",{ref:n,style:{width:"100%"}})})]})}function Pe({title:t,children:r,defaultState:s="open",onStateChange:n,headerClass:i="",contentClass:a=""}){const[l,d]=h.useState(s),c=()=>{const o=l==="open"?"closed":"open";d(o),n==null||n(o)};return e.jsxs("div",{children:[e.jsxs("div",{className:`collapsible__header ${i}`,onClick:c,children:[e.jsx("span",{className:"collapsible__toggle",children:l==="open"?e.jsx($,{icon:Tt}):e.jsx($,{icon:$t})}),t]}),l==="open"&&e.jsx("div",{className:`${a}`,children:r})]})}function Fe({title:t,children:r,defaultState:s="open",onStateChange:n}){return e.jsx("div",{className:"tyche__section",children:e.jsx(Pe,{title:t,defaultState:s,onStateChange:n,headerClass:"tyche__section__header",contentClass:"tyche__section__content",children:r})})}function ds({observations:t}){const r=new Set;return t.raw.forEach(s=>{for(const n of s.features.keys())n.startsWith("Retried draw from")||r.add(n)}),r.size===0?null:e.jsx(Fe,{title:"Features",children:Array.from(r).sort().map(s=>e.jsx(us,{feature:s,observations:t}))})}function hs(){const{filters:t,removeFilter:r}=ve(),s=Array.from(t.values()).flat().sortKey(n=>n.createdAt);return s.length===0?null:e.jsxs("div",{className:"tyche__filters",children:[e.jsx("div",{className:"tyche__filters__title",children:"Current Filters"}),s.map(n=>e.jsxs("div",{className:"tyche__filters__filter",children:[e.jsxs("div",{className:"tyche__filters__filter__component",children:[e.jsx("div",{className:"tyche__filters__filter__remove",onClick:()=>r(n.component,n.name),children:e.jsx($,{icon:Qe})}),n.component]}),e.jsx("div",{className:"tyche__filters__filter__name",children:n.name})]},`${n.component}-${n.name}`))]})}function mt(t){const r=t.regex,s=new RegExp("[\\p{XID_Start}_]\\p{XID_Continue}*","u"),n=["and","as","assert","async","await","break","case","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","is","lambda","match","nonlocal|10","not","or","pass","raise","return","try","while","with","yield"],d={$pattern:/[A-Za-z]\w+|__\w+__/,keyword:n,built_in:["__import__","abs","all","any","ascii","bin","bool","breakpoint","bytearray","bytes","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","exec","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip"],literal:["__debug__","Ellipsis","False","None","NotImplemented","True"],type:["Any","Callable","Coroutine","Dict","List","Literal","Generic","Optional","Sequence","Set","Tuple","Type","Union"]},c={className:"meta",begin:/^(>>>|\.\.\.) /},o={className:"subst",begin:/\{/,end:/\}/,keywords:d,illegal:/#/},u={begin:/\{\{/,relevance:0},m={className:"string",contains:[t.BACKSLASH_ESCAPE],variants:[{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?'''/,end:/'''/,contains:[t.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?"""/,end:/"""/,contains:[t.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([fF][rR]|[rR][fF]|[fF])'''/,end:/'''/,contains:[t.BACKSLASH_ESCAPE,c,u,o]},{begin:/([fF][rR]|[rR][fF]|[fF])"""/,end:/"""/,contains:[t.BACKSLASH_ESCAPE,c,u,o]},{begin:/([uU]|[rR])'/,end:/'/,relevance:10},{begin:/([uU]|[rR])"/,end:/"/,relevance:10},{begin:/([bB]|[bB][rR]|[rR][bB])'/,end:/'/},{begin:/([bB]|[bB][rR]|[rR][bB])"/,end:/"/},{begin:/([fF][rR]|[rR][fF]|[fF])'/,end:/'/,contains:[t.BACKSLASH_ESCAPE,u,o]},{begin:/([fF][rR]|[rR][fF]|[fF])"/,end:/"/,contains:[t.BACKSLASH_ESCAPE,u,o]},t.APOS_STRING_MODE,t.QUOTE_STRING_MODE]},x="[0-9](_?[0-9])*",p=`(\\b(${x}))?\\.(${x})|\\b(${x})\\.`,g=`\\b|${n.join("|")}`,k={className:"number",relevance:0,variants:[{begin:`(\\b(${x})|(${p}))[eE][+-]?(${x})[jJ]?(?=${g})`},{begin:`(${p})[jJ]?`},{begin:`\\b([1-9](_?[0-9])*|0+(_?0)*)[lLjJ]?(?=${g})`},{begin:`\\b0[bB](_?[01])+[lL]?(?=${g})`},{begin:`\\b0[oO](_?[0-7])+[lL]?(?=${g})`},{begin:`\\b0[xX](_?[0-9a-fA-F])+[lL]?(?=${g})`},{begin:`\\b(${x})[jJ](?=${g})`}]},w={className:"comment",begin:r.lookahead(/# type:/),end:/$/,keywords:d,contains:[{begin:/# type:/},{begin:/#/,end:/\b\B/,endsWithParent:!0}]},f={className:"params",variants:[{className:"",begin:/\(\s*\)/,skip:!0},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:d,contains:["self",c,k,m,t.HASH_COMMENT_MODE]}]};return o.contains=[m,k,c],{name:"Python",aliases:["py","gyp","ipython"],unicodeRegex:!0,keywords:d,illegal:/(<\/|\?)|=>/,contains:[c,k,{scope:"variable.language",match:/\bself\b/},{beginKeywords:"if",relevance:0},{match:/\bor\b/,scope:"keyword"},m,w,t.HASH_COMMENT_MODE,{match:[/\bdef/,/\s+/,s],scope:{1:"keyword",3:"title.function"},contains:[f]},{variants:[{match:[/\bclass/,/\s+/,s,/\s*/,/\(\s*/,s,/\s*\)/]},{match:[/\bclass/,/\s+/,s]}],scope:{1:"keyword",3:"title.class",6:"title.class.inherited"}},{className:"meta",begin:/^[\t ]*@/,end:/(?=#)|$/,contains:[k,f,m]}]}}function We({currentPage:t,pageCount:r,onPageChange:s}){console.assert(r>1);function n(){return r<=7?Array.from({length:r},(c,o)=>o):t<=3?[0,1,2,3,4,"ellipsis",r-1]:t>=r-4?[0,"ellipsis",r-5,r-4,r-3,r-2,r-1]:[0,"ellipsis",t-1,t,t+1,"ellipsis",r-1]}const i=n();function a(c){typeof c=="number"&&t!==c&&s(c)}function l(){t>0&&s(t-1)}function d(){t<r-1&&s(t+1)}return e.jsxs("div",{className:"pagination",children:[e.jsx("div",{className:`pagination__nav pagination__nav--left ${t===0?"pagination__nav--disabled":""}`,onClick:l,children:e.jsx($,{icon:Lt})}),i.map((c,o)=>{if(c==="ellipsis")return e.jsx("div",{className:" pagination__ellipsis",children:"..."},`ellipsis-${o}`);const u=c===t;return e.jsx("div",{className:`pagination__number ${u?"pagination__number--current":""}`,onClick:()=>a(c),children:c+1},c)}),e.jsx("div",{className:`pagination__nav pagination__nav--right ${t===r-1?"pagination__nav--disabled":""}`,onClick:d,children:e.jsx($,{icon:Pt})})]})}de.registerLanguage("python",mt);const Se=30;function ms({observations:t,observationCategory:r}){const s=h.useRef(null),[n,i]=h.useState(0);h.useEffect(()=>{i(0)},[r]);function a(){s.current&&s.current.querySelectorAll("code:not([data-highlighted='yes'])").forEach(o=>{de.highlightElement(o)})}h.useEffect(()=>{a()},[t,n]);const l=new Map;t.filtered.forEach(o=>{const u=o.representation;l.set(u,(l.get(u)||0)+1)});const d=Math.ceil(l.size/Se),c=Array.from(l.entries()).sortKey(([o,u])=>-u).slice(n*Se,(n+1)*Se);return e.jsx(Fe,{title:"Textual representation",defaultState:"closed",onStateChange:o=>{o==="open"&&requestAnimationFrame(()=>{a()})},children:e.jsxs("div",{ref:s,children:[d>1&&e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"12px"},children:e.jsx(We,{currentPage:n,pageCount:d,onPageChange:i})}),c.map(([o,u])=>e.jsxs("div",{style:{position:"relative"},className:"tyche__representation__example",children:[e.jsx("pre",{children:e.jsx("code",{className:"language-python",children:o})}),u>1&&e.jsxs("div",{className:"tyche__representation__example__count",children:["x ",u]})]},o)),d>1&&e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"12px"},children:e.jsx(We,{currentPage:n,pageCount:d,onPageChange:i})})]})})}const Ke=640;function ps({name:t,observations:r,verticalAxis:s,horizontalAxis:n,cssStyle:i=(a,l)=>({})}){const{filters:a,setFilters:l}=ve(),{showTooltip:d,hideTooltip:c,moveTooltip:o}=Le(),u=a.get(t)||[],m=h.useMemo(()=>{if(u.length===0)return O();console.assert(u.length===1);const _=u[0];return O(_.extraData.selectedCells)},[u]),x=[],p=Array(s.length).fill(0),g=Array(n.length).fill(0);let k=0;for(let _=0;_<s.length;_++){x[_]=[];for(let y=0;y<n.length;y++)x[_][y]={count:0,widthPercent:0}}r.filtered.forEach(_=>{for(let y=0;y<s.length;y++){const[,P]=s[y];if(P(_)){for(let F=0;F<n.length;F++){const[,z]=n[F];if(z(_)){x[y][F].count++,p[y]++,g[F]++,k++;break}}break}}});const w=p.map((_,y)=>_>0?y:null).filter(_=>_!==null),f=g.map((_,y)=>_>0?y:null).filter(_=>_!==null),A=(_,y)=>{let P=O();if(_!==null&&y!==null){const C=Z([_,y]);m.equals(O([C]))?P=O():P=O([C])}else _!==null?(console.assert(y===null),f.forEach(C=>{x[_][C].count>0&&(P=P.add(Z([_,C])))})):y!==null&&(console.assert(_===null),w.forEach(C=>{x[C][y].count>0&&(P=P.add(Z([C,y])))}));function F(){if(P.size===0)return"";let C=P;const W=[],me=[...w.map(D=>({name:s[D][0],cells:f.filter(V=>x[D][V].count>0).map(V=>Z([D,V]))})),...f.map(D=>({name:n[D][0],cells:w.filter(V=>x[V][D].count>0).map(V=>Z([V,D]))}))];for(const D of me)D.cells.length>0&&D.cells.every(V=>C.has(V))&&(W.push(D.name),C=C.subtract(O(D.cells)));for(;C.size>0;){const D=C.first(),[V,ye]=D.toArray();W.push(`${s[V][0]}+${n[ye][0]}`),C=C.delete(D)}return console.assert(C.size==0),W.join(" or ")}const z=[];P.size>0&&z.push(new dt(F(),C=>P.some(W=>{const[me,D]=W.toArray(),V=s[me][1],ye=n[D][1];return V(C)&&ye(C)}),t,{selectedCells:P}));const G=new Map(a);G.set(t,z),l(G)};if(w.length===0||f.length===0)return e.jsx("div",{children:"No observations"});const M=30,j=30,T=45*w.length;for(let _=0;_<s.length;_++)for(let y=0;y<n.length;y++)x[_][y].widthPercent=p[_]>0?x[_][y].count/p[_]*100:0;const N=w.map(_=>p[_]/k*T).map(_=>Math.max(_,j)),v=f.map((_,y)=>y===0?0:y===f.length-1?100:y/(f.length-1)*100),{rowHeaderWidth:R,columnHeaderHeight:S,rowTotalWidth:L}=h.useMemo(()=>({rowHeaderWidth:Math.max(...w.map(_=>Ne(s[_][0],"tyche__mosaic__row-header").width)),columnHeaderHeight:Math.max(...f.map(_=>Ne(n[_][0],"tyche__mosaic__column-header").height)),rowTotalWidth:Math.max(...w.map(_=>Ne(p[_].toString(),"tyche__mosaic__row-total").width))}),[w,f,s,n,p]),U=Ke-R-L;return w.forEach(_=>{const y=f.map(F=>x[_][F]);if(y.reduce((F,z)=>F+z.widthPercent,0)>0){const z=y.map(C=>C.widthPercent/100*U).map((C,W)=>y[W].count>0&&C>0&&C<M?M:C),G=z.reduce((C,W)=>C+W,0);f.forEach((C,W)=>{x[_][C].widthPercent=G>0?z[W]/G*100:0})}}),e.jsxs("div",{className:"tyche__mosaic__container",style:{maxWidth:`${Ke}px`},children:[e.jsx("div",{className:"tyche__mosaic__column-headers",style:{marginLeft:`${R}px`,marginRight:`${L}px`,height:`${S}px`},children:f.map((_,y)=>{const P=y===0,F=y===f.length-1;return e.jsx("div",{className:"tyche__mosaic__column-header",style:{left:`${v[y]}%`,transform:P?"translateX(0%)":F?"translateX(-100%)":"translateX(-50%)",textAlign:P?"left":F?"right":"center"},onClick:()=>A(null,_),children:n[_][0]},`header-${_}`)})}),w.map((_,y)=>e.jsxs("div",{className:"tyche__mosaic__row",style:{height:`${N[y]}px`},children:[e.jsx("div",{className:"tyche__mosaic__row-header",style:{width:`${R}px`,cursor:"pointer"},onClick:()=>A(_,null),children:s[_][0]}),e.jsx("div",{className:"tyche__mosaic__row-cells",children:f.map(P=>{const F=x[_][P];if(F.count===0)return null;const z=m.has(Z([_,P])),G=`${s[_][0]} and ${n[P][0]}<br>Count: ${F.count}`;return e.jsx("div",{className:`tyche__mosaic__cell${z?" tyche__mosaic__cell--selected":""}`,style:{width:`${F.widthPercent}%`,minWidth:`${M}px`,minHeight:`${j}px`,...i(s[_][0],n[P][0])},onClick:()=>A(_,P),onMouseEnter:C=>d(G,C.clientX,C.clientY,"tyche-mosaic"),onMouseMove:C=>o(C.clientX,C.clientY,"tyche-mosaic"),onMouseLeave:()=>c("tyche-mosaic"),children:e.jsx("span",{className:"tyche__mosaic__cell-value",children:F.count})},`cell-${_}-${P}`)})}),e.jsx("div",{className:"tyche__mosaic__row-total",style:{width:`${L}px`},children:p[_]})]},`row-${_}`)),e.jsxs("div",{className:"tyche__mosaic__column-totals-row",style:{height:`${S}px`},children:[e.jsx("div",{style:{width:`${R}px`}}),e.jsx("div",{className:"tyche__mosaic__column-totals",style:{marginRight:`${L}px`},children:f.map((_,y)=>{const P=y===0,F=y===f.length-1;return e.jsx("div",{className:"tyche__mosaic__column-total",style:{left:`${v[y]}%`,transform:P?"translateX(0%)":F?"translateX(-100%)":"translateX(-50%)",textAlign:P?"left":F?"right":"center"},children:g[_]},`total-${_}`)})}),e.jsx("div",{className:"tyche__mosaic__grand-total",style:{width:`${L}px`},children:k})]})]})}function fs({observations:t}){function r(s,n){const i={};return s==="Passed"?i.backgroundColor=B.SUCCESS:s==="Invalid"?i.backgroundColor=B.WARNING:s==="Failed"&&(i.backgroundColor=B.ERROR),n==="Duplicate"&&(i.opacity=.7),i}return e.jsx(Fe,{title:"Sample breakdown",children:e.jsx(ps,{name:"samples",observations:t,verticalAxis:[["Passed",s=>s.status==="passed"],["Invalid",s=>s.status==="gave_up"]],horizontalAxis:[["Unique",s=>s.isUnique??!1],["Duplicate",s=>s.isDuplicate??!1]],cssStyle:r})})}const ge="Present",xe="Not present";var B=(t=>(t.PRIMARY="#6b8ab5",t.SUCCESS="#8ba86b",t.WARNING="#d59a7e",t.ERROR="#c77a7e",t.ACCENT="#c1a2bb",t.ACCENT2="#9fc7c6",t.ACCENT3="#edd39a",t.ACCENT4="#99c7d6",t.ACCENT5="#8faac6",t))(B||{});function _s({test:t}){const{filters:r,observationCategory:s,setObservationCategory:n}=ve(),i=s==="rolling"?t.rolling_observations.sortKey(d=>-d.run_start):t.corpus_observations,a=h.useMemo(()=>{const d=Array.from(r.values()).flat();return d.length===0?i:i.filter(c=>d.every(o=>o.predicate(c)))},[i,r]),l={raw:i,filtered:a};return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:e.jsx("span",{children:"Observations"})}),e.jsx("div",{style:{paddingTop:"10px",paddingBottom:"10px",display:"flex",fontSize:"1.05rem",fontWeight:"500"},children:e.jsx(le,{value:s,onChange:n,options:[{value:"covering",content:"Covering"},{value:"rolling",content:"Rolling"}]})}),e.jsx(hs,{}),l.raw.length>0?e.jsxs(e.Fragment,{children:[e.jsx(fs,{observations:l}),e.jsx(ds,{observations:l}),e.jsx(ms,{observations:l,observationCategory:s})]}):e.jsx("div",{className:"tyche__section",children:"No observations"})]})}function gs({test:t}){return e.jsx(cs,{children:e.jsx(_s,{test:t})})}class he{withProperties(r){return Object.assign(Object.create(this.constructor.prototype),this,r)}}class Ie extends he{constructor(r,s){super(),this.state=r,this.observation=s}static fromJson(r){return new Ie(r.state,ue.fromJson(r.observation))}}class J extends he{constructor(r=new Map([[0,0],[1,0],[2,0],[3,0]])){super(),this.counts=r}static fromJson(r){const s=new Map([[0,0],[1,0],[2,0],[3,0]]);for(const[n,i]of Object.entries(r))console.assert(typeof i=="number"),s.set(Number(n),i);return new J(s)}add(r){const s=new Map(this.counts);for(const[n,i]of r.counts.entries())s.set(n,s.get(n)+i);return new J(s)}subtract(r){const s=new Map(this.counts);for(const[n,i]of r.counts.entries())s.set(n,s.get(n)-i);return new J(s)}sum(){return ot(this.counts.values())}}var pt=(t=>(t[t.OVERRUN=0]="OVERRUN",t[t.INVALID=1]="INVALID",t[t.VALID=2]="VALID",t[t.INTERESTING=3]="INTERESTING",t))(pt||{}),Re=(t=>(t.GENERATE="generate",t.REPLAY="replay",t.DISTILL="distill",t.SHRINK="shrink",t.FAILED="failed",t))(Re||{});class be extends he{constructor(s,n,i,a,l,d,c,o){super();E(this,"status_counts_diff");E(this,"elapsed_time_diff");E(this,"timestamp_monotonic");this.elapsed_time=s,this.timestamp=n,this.status_counts=i,this.behaviors=a,this.fingerprints=l,this.since_new_behavior=d,this.phase=c,this.worker_uuid=o,this.status_counts_diff=null,this.elapsed_time_diff=null,this.timestamp_monotonic=null}get ninputs(){return this.status_counts.sum()}static fromJson(s,n){return new be(n.elapsed_time,n.timestamp,J.fromJson(n.status_counts),n.behaviors,n.fingerprints,n.since_new_behavior,n.phase,s)}}class ue extends he{constructor(s,n,i,a,l,d,c,o,u,m,x){super();E(this,"isDuplicate",null);E(this,"isUnique",null);this.type=s,this.status=n,this.status_reason=i,this.representation=a,this.arguments_=l,this.how_generated=d,this.features=c,this.timing=o,this.metadata=u,this.property=m,this.run_start=x}static fromJson(s){return new ue(s.type,s.status,s.status_reason,s.representation,new Map(Object.entries(s.arguments)),s.how_generated,new Map(Object.entries(s.features)),new Map(Object.entries(s.timing)),new Map(Object.entries(s.metadata)),s.property,Number(s.run_start))}}var X=(t=>(t[t.FAILED=0]="FAILED",t[t.SHRINKING=1]="SHRINKING",t[t.RUNNING=2]="RUNNING",t[t.WAITING=3]="WAITING",t))(X||{});function He(t,r){const s=r?r.status_counts:new J,n=r?r.elapsed_time:0,i=t.status_counts.subtract(s),a=t.elapsed_time-n,l=r?Math.max(t.timestamp,r.timestamp_monotonic+a):t.timestamp;return console.assert(Array.from(i.counts.values()).every(d=>d>=0)),console.assert(a>=0),t.withProperties({status_counts_diff:i,elapsed_time_diff:a,timestamp_monotonic:l})}const ce=class ce extends he{constructor(s,n,i,a,l,d){super();E(this,"linear_reports");E(this,"_status_counts_cumsum");E(this,"_elapsed_time_cumsum");E(this,"load_finished_at",null);this.database_key=s,this.nodeid=n,this.rolling_observations=i,this.corpus_observations=a,this.failures=l,this.reports_by_worker=d,this.linear_reports=[],this._status_counts_cumsum=new Map,this._elapsed_time_cumsum=new Map,this.load_finished_at=null;const c=this.reports_by_worker;this.reports_by_worker=new Map;const o=Array.from(c.entries()).flatMap(([u,m])=>m.map(x=>[u,x])).sortKey(([u,m])=>m.timestamp);for(const[u,m]of o)this.add_report(u,m);this._check_invariants()}static fromJson(s){return new ce(s.database_key,s.nodeid,[],[],new Map(Object.entries(s.failures).map(([n,i])=>[n,Ie.fromJson(i)])),new Map(Object.entries(s.reports_by_worker).map(([n,i])=>[n,i.map(be.fromJson)])))}_assert_reports_ordered(s){for(let n=0;n<s.length-1;n++)console.assert(s[n].timestamp_monotonic<=s[n+1].timestamp_monotonic)}_check_invariants(){this._assert_reports_ordered(this.linear_reports);const s=this.linear_status_counts(null);for(let i=0;i<s.length-1;i++)console.assert(s[i].sum()<=s[i+1].sum());const n=this.linear_elapsed_time(null);for(let i=0;i<n.length-1;i++)console.assert(n[i]<=n[i+1]);console.assert(n.length===s.length&&s.length===this.linear_reports.length);for(const[i,a]of this.reports_by_worker.entries())this._assert_reports_ordered(a)}add_report(s,n){let i=null,a=0;if(this.reports_by_worker.has(s)){const d=this.reports_by_worker.get(s);a=we(d,n.elapsed_time,c=>c.elapsed_time),i=a!=0?d[a-1]:null}const l=He(n,i);if(this.reports_by_worker.has(s)||this.reports_by_worker.set(s,[]),this.reports_by_worker.get(s).splice(a,0,l),l.phase!==Re.REPLAY){const d=we(this.linear_reports,l.timestamp_monotonic,c=>c.timestamp_monotonic);if(this.linear_reports.splice(d,0,l),d!=this.linear_reports.length-1){let c=null,o;for(o=0;o<this.linear_reports.length-(d+1);o++){const u=this.linear_reports[d+1+o];if(l.worker_uuid===u.worker_uuid){c=u;break}}c&&(console.assert(this.linear_reports[d+1+o]===c),this.linear_reports[d+1+o]=He(c,l));for(const u of[this._status_counts_cumsum,this._elapsed_time_cumsum])for(const[m,[x,p]]of u.entries())d>=x&&u.set(m,[x,p.slice(0,d-x)])}}}get status(){if(this.failures.size>0)return X.FAILED;if(this.linear_reports.length===0)return X.WAITING;const s=this.linear_reports[this.linear_reports.length-1],n=new Date().getTime()/1e3;return s.phase==Re.SHRINK?X.SHRINKING:s.ninputs===0||s.timestamp<n-ce.WAITING_STATUS_DURATION?X.WAITING:X.RUNNING}get behaviors(){return this.linear_reports.length===0?0:this.linear_reports[this.linear_reports.length-1].behaviors}get fingerprints(){return this.linear_reports.length===0?0:this.linear_reports[this.linear_reports.length-1].fingerprints}get since_new_behavior(){return this.linear_reports.length===0?null:this.linear_reports[this.linear_reports.length-1].since_new_behavior}elapsed_time(s){const n=this.linear_elapsed_time(s);return n.length===0?0:n[n.length-1]}ninputs(s){const n=this.linear_status_counts(s);return n.length===0?0:n[n.length-1].sum()}_cumsum(s,n,i,a,l){if(a===null&&(a=-1/0),s.has(a)){const[u,m]=s.get(a);if(m.length<this.linear_reports.slice(u).length){let x=m.length>0?m[m.length-1]:l;for(const p of this.linear_reports.slice(u+m.length))x=i(x,p[n]),m.push(x);s.set(a,[u,m])}return m}const d=[],c=we(this.linear_reports,a,u=>u.timestamp_monotonic);let o=l;for(const u of this.linear_reports.slice(c))o=i(o,u[n]),d.push(o);return s.set(a,[c,d]),d}linear_status_counts(s){return this._cumsum(this._status_counts_cumsum,"status_counts_diff",(n,i)=>n.add(i),s,new J)}linear_elapsed_time(s){return this._cumsum(this._elapsed_time_cumsum,"elapsed_time_diff",(n,i)=>n+i,s,0)}};E(ce,"WAITING_STATUS_DURATION",120);let Ce=ce;function xs({message:t,onDismiss:r,isVisible:s}){const[n,i]=h.useState(s);return h.useEffect(()=>{if(s){i(!0);return}else{const a=setTimeout(()=>{i(!1)},300);return()=>clearTimeout(a)}},[s]),n?e.jsxs("div",{className:`notification ${s?"notification--visible":"notification--hidden"}`,onClick:r,children:[e.jsx("div",{className:"notification__content",children:t}),e.jsx("button",{className:"notification__close",onClick:a=>{a.stopPropagation(),r()},"aria-label":"Close notification",children:e.jsx($,{icon:Qe})})]}):null}const ft=h.createContext(null);function vs({children:t}){const[r,s]=h.useState([]),n=h.useRef(new Map),i=h.useRef(0),a=h.useCallback(c=>{clearTimeout(n.current.get(c)),n.current.delete(c),s(o=>o.filter(u=>u.id!==c))},[]),l=h.useCallback((c,o)=>{const u=++i.current,m={id:u,message:c,duration:o};if(s(x=>[...x,m]),o!==null){const x=setTimeout(()=>{a(u)},o);n.current.set(u,x)}return u},[a]),d=h.useCallback((c,o,u)=>{if(s(m=>m.map(x=>x.id===c?{...x,message:o,duration:u}:x)),u!==null){clearTimeout(n.current.get(c));const m=setTimeout(()=>{a(c)},u);n.current.set(c,m)}},[a]);return e.jsxs(ft.Provider,{value:{addNotification:l,updateNotification:d,dismissNotification:a},children:[t,e.jsx("div",{className:"notifications",children:r.map((c,o)=>e.jsx("div",{className:"notification-wrapper",style:{top:`${20+o*80}px`},children:e.jsx(xs,{message:c.message,isVisible:!0,onDismiss:()=>a(c.id)})},c.id))})]})}function bs(){const t=h.useContext(ft);if(!t)throw new Error("useNotification must be used within a NotificationProvider");return t}const _t=h.createContext(null);function Xe(t){const r=new Map;t.forEach(n=>{r.set(n.representation,(r.get(n.representation)||0)+1)}),t.forEach(n=>{const i=r.get(n.representation);n.isUnique=i==1,n.isDuplicate=i>1});const s=new Set;t.forEach(n=>{n.features.forEach((i,a)=>{s.add(a)})}),t.forEach(n=>{s.forEach(i=>{n.features.has(i)||n.features.set(i,xe)});for(const[i,a]of n.features)a===""&&n.features.set(i,ge)})}function ys(t,r){const s=new Map(t);function n(i){if(s.has(i))return s.get(i);{const a=new Ce(null,i,[],[],new Map,new Map);return s.set(a.nodeid,a),a}}switch(r.type){case 1:return t;case 2:{const{tests:i}=r;for(const{database_key:a,nodeid:l,failures:d}of i){const c=n(l);c.database_key=a,d.forEach((o,u)=>{c.failures.set(u,o)})}return s}case 3:{const{nodeid:i,worker_uuid:a,reports:l}=r,d=n(i);for(const c of l)d.add_report(a,c);return s}case 5:{const{nodeid:i,failures:a}=r,l=n(i);return a.forEach((d,c)=>{l.failures.set(c,d)}),s}case 4:{const{nodeid:i,observation_type:a,observations:l}=r,d=n(i);return a==="rolling"?(d.rolling_observations.push(...l),d.rolling_observations=d.rolling_observations.sortKey(c=>-c.run_start).slice(0,300),Xe(d.rolling_observations)):(console.assert(a==="corpus"),d.corpus_observations.push(...l),Xe(d.corpus_observations)),s}case 7:{const{nodeid:i}=r,a=n(i);return a.load_finished_at=Date.now(),s}default:throw new Error("non-exhaustive switch in testsReducer")}}function js({children:t}){const[r,s]=h.useState(null),[n,i]=h.useReducer(ys,new Map),[a,l]=h.useState(!1),[d,c]=h.useState(null),[o,u]=h.useState({count_tests:null,count_tests_loaded:null}),{addNotification:m,updateNotification:x,dismissNotification:p}=bs();h.useRef(null);const g=h.useCallback(w=>{l(!0),c(w)},[]),k=h.useCallback(()=>{const w=Date.now();return o.count_tests_loaded!==null&&o.count_tests!==null&&o.count_tests_loaded===o.count_tests&&Array.from(n.values()).every(f=>f.load_finished_at===null?!1:w-f.load_finished_at>200)},[o,n]);return h.useEffect(()=>{if(a){n.clear(),u({count_tests:null,count_tests_loaded:null});{fetch(new URL("dashboard_state/tests.json",import.meta.url)).then(f=>f.text()).then(f=>JSON.parse(f)).then(f=>{Object.entries(f).forEach(([A,M])=>{i({type:2,tests:[{database_key:M.database_key,nodeid:A,failures:M.failures}]});for(const[j,T]of Object.entries(M.reports_by_worker))i({type:3,nodeid:A,worker_uuid:j,reports:T.map(b=>be.fromJson(j,b))});i({type:7,nodeid:A})})});const w=new Worker(new URL("/preview-174/example-dashboard/assets/jsonWorker-KJVNTzbb.js",import.meta.url));return fetch(new URL("dashboard_state/observations.json",import.meta.url)).then(f=>f.text()).then(f=>new Promise(A=>{w.onmessage=M=>A(M.data),w.postMessage(f)})).then(f=>{for(const[A,M]of Object.entries(f))i({type:4,nodeid:A,observation_type:"rolling",observations:M.rolling.map(ue.fromJson)}),i({type:4,nodeid:A,observation_type:"corpus",observations:M.corpus.map(ue.fromJson)})}),()=>w.terminate()}}},[d,a]),e.jsx(_t.Provider,{value:{tests:n,socket:r,doLoadData:g,testsLoaded:k},children:t})}function De(t=null){const r=h.useContext(_t);if(!r)throw new Error("useData must be used within a DataProvider");return h.useEffect(()=>{r.doLoadData(t)},[t,r.doLoadData]),r}function pe({to:t,children:r,isActive:s}){const n=Te();return e.jsx(Q,{to:t,className:`sidebar__link ${s(n.pathname)?"sidebar__link--active":""}`,children:r})}function ws(){const t=Te(),[r,s]=h.useState(!1),n=h.useRef(null);return h.useEffect(()=>{function i(a){var l;r&&((l=n.current)==null?void 0:l.contains(a.target))===!1&&s(!1)}return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[r]),h.useEffect(()=>{s(!1)},[t]),e.jsxs("div",{className:"layout",children:[!r&&e.jsx("div",{className:"toggle-sidebar",onClick:()=>s(!0),children:e.jsx($,{icon:Ft,size:"lg"})}),r&&e.jsx("div",{className:"opacity-overlay"}),e.jsxs("div",{ref:n,className:`sidebar ${r?"sidebar--open":""}`,children:[e.jsx(Q,{to:"/",className:"sidebar__title",children:"HypoFuzz"}),e.jsxs("nav",{className:"sidebar__nav",children:[e.jsx(pe,{to:"/",isActive:i=>i==="/"||i.startsWith("/tests/"),children:"Tests"}),e.jsx(pe,{to:"/patches",isActive:i=>i==="/patches",children:"Patches"}),e.jsx(pe,{to:"/collected",isActive:i=>i==="/collected",children:"Collection"}),e.jsx(pe,{to:"/workers",isActive:i=>i==="/workers",children:"Workers"}),e.jsx("div",{className:"sidebar__separator"}),e.jsx("a",{href:`${"/preview-174/example-dashboard".replace(/\/$/,"")}/docs/`,className:"sidebar__link",children:"Docs"})]})]}),e.jsx("div",{className:"content",children:e.jsx(kt,{})})]})}function Be({headers:t,data:r,row:s,mobileRow:n,getKey:i,onFilterChange:a,filterStrings:l}){const[d,c]=h.useState(null),[o,u]=h.useState(0),[m,x]=h.useState(""),p=$e(),g=h.useMemo(()=>{let f=r;if(m&&(f=r.filter(M=>l?l(M).some(j=>j.toLowerCase().includes(m.toLowerCase())):!0)),d===null)return f;const A=[...f].sortKey(M=>t[d].sortKey(M));return o===0?A:A.reverse()},[r,d,o,t,m,s,l,n,p]),k=f=>{t[f].sortKey&&(d===f?u(A=>A===0?1:0):(c(f),u(0)))};function w(f){x(f),a==null||a(f)}return e.jsxs("div",{className:"table",children:[l!==void 0&&e.jsxs("div",{className:"table__filter",children:[e.jsx("input",{type:"text",placeholder:"Filter",value:m,onChange:f=>w(f.target.value),className:"table__filter__input"}),m&&e.jsx("span",{className:"table__filter__clear",onClick:()=>w(""),children:e.jsx($,{icon:It})})]}),n!==void 0&&p?g.map(f=>e.jsx("div",{children:n(f)},i?i(f):void 0)):e.jsxs("table",{className:"table__table",children:[e.jsx("thead",{children:e.jsx("tr",{children:t.map((f,A)=>e.jsx("th",{onClick:()=>k(A),className:f.sortKey?"table--sortable":"",children:e.jsxs("div",{className:`table__header table__header--${f.align??"left"}`,children:[f.content,f.sortKey&&e.jsx("div",{className:"table__sort",children:[0,1].map(M=>e.jsx("div",{className:`table__sort__arrow table__sort__arrow--${M===0?"asc":"desc"} ${d===A&&o===M?"table__sort__arrow--active":""}`,children:M===0?e.jsx($,{icon:Dt}):e.jsx($,{icon:Bt})}))})]})},A))})}),e.jsx("tbody",{children:g.map(f=>{const A=s(f);return console.assert(A.length===t.length),e.jsx("tr",{children:A.map((M,j)=>e.jsx("td",{children:M},j))},i?i(f):void 0)})})]}),m&&g.length<r.length&&e.jsxs("div",{className:"table__filter-status",children:["Showing ",g.length," of ",r.length," rows",e.jsx("span",{className:"table__filter-status__clear",onClick:()=>{x(""),a==null||a("")},children:"[clear]"})]})]})}async function Oe(t){return await(await fetch(new URL("dashboard_state/api.json",import.meta.url))).json()}async function Ns(t){var s;const r=await Oe();return(s=r==null?void 0:r.patches)==null?void 0:s[t]}async function gt(){const t=await Oe();return t==null?void 0:t.available_patches}async function Ss(){const t=await Oe();return t==null?void 0:t.collected_tests.collection_status}const Ge={not_collected:0,collected:1};function ks(){const[t,r]=h.useState(null);if(h.useEffect(()=>{Ss().then(a=>{r(a)})},[]),t===null)return null;if(!t.length)return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:"Test collection"}),"No tests collected."]});const s=[...t].sortKey(a=>[Ge[a.status],a.status_reason,a.nodeid]),n=[{content:"Test",sortKey:a=>a.nodeid},{content:"Status",sortKey:a=>[Ge[a.status],a.status_reason],align:"center"}],i=a=>[e.jsx("div",{style:{wordBreak:"break-all"},children:a.status=="collected"?e.jsx(Q,{to:`/tests/${encodeURIComponent(a.nodeid)}`,className:"test__link",children:a.nodeid}):a.nodeid}),e.jsx("div",{style:{textAlign:"center"},children:a.status==="collected"?e.jsx("div",{className:"pill pill__success",children:"Collected"}):e.jsxs("div",{className:"pill pill__neutral",children:["Not collected (",a.status_reason,")"]})})];return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:"Test collection status"}),e.jsx(Be,{headers:n,data:s,row:i,getKey:a=>a.database_key,filterStrings:a=>[a.nodeid,a.status==="collected"?"Collected":`Not collected (${a.status_reason})`]})]})}function As(){return e.jsx("h1",{children:"Page not found!"})}function Rs(t){const r=t.regex;return{name:"Diff",aliases:["patch"],contains:[{className:"meta",relevance:10,match:r.either(/^@@ +-\d+,\d+ +\+\d+,\d+ +@@/,/^\*\*\* +\d+,\d+ +\*\*\*\*$/,/^--- +\d+,\d+ +----$/)},{className:"comment",variants:[{begin:r.either(/Index: /,/^index/,/={3,}/,/^-{3}/,/^\*{3} /,/^\+{3}/,/^diff --git/),end:/$/},{match:/^\*{15}$/}]},{className:"addition",begin:/^\+/,end:/$/},{className:"deletion",begin:/^-/,end:/$/},{className:"addition",begin:/^!/,end:/$/}]}}de.registerLanguage("diff",Rs);function xt({nodeid:t}){const[r,s]=h.useState({}),[n,i]=h.useState(!0),[a,l]=h.useState(null),[d,c]=h.useState(!1),o=h.useRef(null);if(h.useEffect(()=>{Ns(t).then(k=>{k&&s(k),i(!1)})},[t]),h.useEffect(()=>{lt(o,!0)},[r,a]),n)return e.jsx("div",{className:"card",children:e.jsx("p",{children:"Loading patches..."})});if(Object.values(r).every(k=>k===null))return e.jsx("div",{className:"card",children:e.jsx("p",{children:"No patches for this test"})});const u=new Map([["failing","Failing"],["covering","Covering"]]),m=a??Array.from(u.keys()).find(k=>r[k]),x=r[m],p=async()=>{await navigator.clipboard.writeText(x),c(!0),setTimeout(()=>{c(!1)},2e3)},g=()=>{const k=new Blob([x],{type:"text/plain"}),w=URL.createObjectURL(k),f=document.createElement("a");f.href=w,f.download=`${m}-${t.split("::").pop()}.patch`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(w)};return e.jsxs("div",{ref:o,children:[e.jsx("div",{style:{paddingTop:"10px",paddingBottom:"10px",display:"flex",fontSize:"1.05rem",fontWeight:"500"},children:e.jsx(le,{value:m,onChange:l,options:Array.from(u.entries()).filter(([k])=>r[k]).map(([k,w])=>({value:k,content:w}))})}),e.jsxs("pre",{className:"patch__pre",children:[e.jsxs("div",{className:"patch__controls",children:[e.jsx("div",{className:`patch__controls__control ${d?"patch__controls__control--success":""}`,onClick:p,title:"Copy patch",children:e.jsx($,{icon:d?Ot:Ut})}),e.jsx("div",{className:"patch__controls__control",onClick:g,title:"Download patch",children:e.jsx($,{icon:Vt})})]}),e.jsx("code",{className:"language-diff",children:x})]})]})}function Cs(){const[t,r]=h.useState(null);return h.useEffect(()=>{gt().then(s=>{r(s)})},[]),t===null||t.length===0?e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:"Patches"}),e.jsx("p",{children:"No tests collected"})]}):e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",style:{marginBottom:"1rem"},children:"Patches"}),t.map(s=>e.jsx(Pe,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("span",{children:s}),e.jsxs(Q,{to:`/tests/${encodeURIComponent(s)}`,style:{color:"var(--secondary-color, #888)",fontSize:"0.9em",textDecoration:"none",marginLeft:"12px"},children:["View test ",e.jsx($,{icon:zt})]})]}),headerClass:"patches__test",defaultState:"closed",children:e.jsx(xt,{nodeid:s})}))]})}function ke(t,r){const[s,n]=h.useState(()=>{const i=sessionStorage.getItem(t);return i===null?r:JSON.parse(i)});return h.useEffect(()=>{sessionStorage.setItem(t,JSON.stringify(s))},[s,t]),[s,n]}const I={scaleSymlog:es,scaleLinear:it,select:tt,zoom:Zt,zoomIdentity:Qt,pointer:Jt,line:qt,axisBottom:nt,axisLeft:st,brush:Yt,scaleOrdinal:rt,schemeCategory10:Gt,quadtree:Xt};typeof window<"u"&&window.addEventListener("mousemove",t=>{t.clientX,t.clientY});const Es=10;class Ms{constructor(r,s,n,i,a,l,d,c){E(this,"reports");E(this,"scaleSetting");E(this,"axisSettingX");E(this,"axisSettingY");E(this,"xValue");E(this,"yValue");E(this,"width");E(this,"height");E(this,"margin");E(this,"x");E(this,"y");E(this,"g");E(this,"zoom");E(this,"chartArea");E(this,"navigate");E(this,"tooltip");E(this,"brush",null);E(this,"eventListeners",new Map);E(this,"xAxis");E(this,"yAxis");E(this,"reportsColor");E(this,"viewportX");E(this,"viewportY");E(this,"quadtree");this.reports=s,this.scaleSetting=i,this.axisSettingX=a,this.axisSettingY=l,this.navigate=d,this.xValue=u=>a=="time"?u.linear_elapsed_time:u.linear_status_counts.sum(),this.yValue=u=>l=="behaviors"?u.behaviors:u.fingerprints,this.margin={top:5,right:5,bottom:10,left:40},this.width=r.clientWidth-this.margin.left-this.margin.right,this.height=270-this.margin.top-this.margin.bottom,this.reportsColor=n;const o=Array.from(s.values()).flat();this.x=(i==="log"?I.scaleSymlog():I.scaleLinear()).domain([0,Ae(o,u=>this.xValue(u))||1]).range([0,this.width]),this.y=I.scaleLinear().domain([0,Ae(o,u=>this.yValue(u))||0]).range([this.height,0]),this.viewportX=this.x,this.viewportY=this.y,this.g=I.select(r).append("g").attr("transform",`translate(${this.margin.left},${this.margin.top})`),this.g.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",this.width).attr("height",this.height+5).attr("x",0).attr("y",-5),this.chartArea=this.g.append("g").attr("class","chart-area").attr("clip-path","url(#clip)"),this.chartArea.append("rect").attr("width",this.width).attr("height",this.height).attr("fill","none").attr("pointer-events","all"),this.zoom=I.zoom().scaleExtent([1,1/0]).on("zoom",u=>this.zoomTo(u.transform,!1)),this.chartArea.call(this.zoom),this.chartArea.on("dblclick.zoom",()=>{this.chartArea.transition().duration(500).call(this.zoom.transform,I.zoomIdentity)}),this.tooltip=I.select(".coverage-graph__tooltip"),this.xAxis=this.g.append("g").attr("transform",`translate(0,${this.height})`).call(this.createXAxis(this.x)),this.yAxis=this.g.append("g").call(this.createYAxis(this.y)),this.chartArea.on("mousemove",u=>{const[m,x]=I.pointer(u),p=this.quadtree.find(m,x,Es);p?this.tooltip.style("display","block").style("left",`${u.pageX+10}px`).style("top",`${u.pageY-10}px`).html(`
              <strong>${ut(p.nodeid)}</strong><br/>
              ${p.behaviors.toLocaleString()} behaviors / ${p.fingerprints.toLocaleString()} fingerprints<br/>
              ${p.linear_status_counts.sum().toLocaleString()} inputs / ${p.linear_elapsed_time.toFixed(1)} seconds
            `):this.tooltip.style("display","none")}).on("mouseout",()=>{this.tooltip.style("display","none")}),this.drawLines(),this.updateQuadtree()}createXAxis(r){if(this.scaleSetting==="log"){const s=r.domain()[1],n=[0];let i=1;for(;i<=s;)n.push(i),i*=10;return I.axisBottom(r).tickValues(n).tickFormat(a=>{const l=a.valueOf();return console.assert(l>=0),l>=1e6?`${Math.floor(l/1e6)}M`:l>=1e3?`${Math.floor(l/1e3)}k`:l>0?l.toLocaleString():"0"})}else return I.axisBottom(r).ticks(5).tickFormat(s=>s.toLocaleString())}createYAxis(r){return I.axisLeft(r).ticks(5)}updateQuadtree(){const r=Array.from(this.reports.values()).flat();this.quadtree=I.quadtree().x(s=>this.viewportX(this.xValue(s))).y(s=>this.viewportY(this.yValue(s))).addAll(r)}zoomTo(r,s){const n=r.rescaleX(this.x),i=s?r.rescaleY(this.y):this.y;this.viewportX=n,this.viewportY=i,this.xAxis.call(this.createXAxis(n)),s&&this.yAxis.call(this.createYAxis(i)),this.g.selectAll(".chart-area path").attr("d",I.line().x(a=>n(this.xValue(a))).y(a=>i(this.yValue(a)))),this.updateQuadtree()}drawLines(){const r=I.line().x(s=>this.x(this.xValue(s))).y(s=>this.y(this.yValue(s)));Array.from(this.reports.entries()).forEach(([s,n])=>{this.chartArea.append("path").datum(n).attr("fill","none").attr("stroke",this.reportsColor(s)).attr("d",r).attr("class","coverage-line").style("cursor","pointer").on("mouseover",function(){I.select(this).classed("coverage-line__selected",!0)}).on("mouseout",function(){I.select(this).classed("coverage-line__selected",!1)}).on("click",i=>{ct(i,`/tests/${encodeURIComponent(s)}`,this.navigate)})})}enableBoxBrush(){for(const r of["wheel","mousedown","mousemove","mouseup"])this.chartArea.on(`${r}.zoom`,null);this.brush=I.brush().extent([[0,0],[this.width,this.height]]).on("end",r=>{if(!r.selection)return;const[[s,n],[i,a]]=r.selection;if(this.chartArea.call(this.brush.clear),this.chartArea.call(this.zoom),Math.abs(i-s)<5||Math.abs(a-n)<5){this.emit("boxSelectEnd");return}const l=this.width/(i-s),d=this.height/(a-n),c=Math.max(l,d),o=I.zoomIdentity.translate(this.width/2,this.height/2).scale(c).translate(-(s+i)/2,-(n+a)/2);this.chartArea.transition().duration(250).call(this.zoom.transform,o).on("end",()=>{this.emit("boxSelectEnd")})}),this.chartArea.style("cursor","crosshair").call(this.brush)}cleanup(){this.tooltip.style("display","none"),this.g.selectAll("path").classed("coverage-line__selected",!1)}on(r,s){this.eventListeners.has(r)||this.eventListeners.set(r,[]),this.eventListeners.get(r).push(s)}off(r,s){this.eventListeners.has(r)&&this.eventListeners.set(r,this.eventListeners.get(r).filter(n=>n!==s))}emit(r){this.eventListeners.has(r)&&this.eventListeners.get(r).forEach(s=>s())}}function vt({tests:t,filterString:r="",testsLoaded:s}){const n=h.useRef(null),[i,a]=ke("graph_scale","log"),[l,d]=ke("graph_axis_x","time"),[c,o]=ke("graph_axis_y","behaviors"),[u,m]=h.useState(!0),[x,p]=h.useState({transform:null,zoomY:!1}),[g,k]=h.useState(!1),w=Je(),f=$e(),[A,M]=h.useState(!1),j=h.useMemo(()=>new Map(Array.from(t.entries()).sortKey(([v,R])=>v).map(([v,R])=>{const S=R.linear_status_counts(null),L=R.linear_elapsed_time(null),U=[];for(let _=0;_<S.length;_++){const y=R.linear_reports[_];U.push({nodeid:v,linear_status_counts:S[_],linear_elapsed_time:L[_],behaviors:y.behaviors,fingerprints:y.fingerprints})}return[v,U]})),[t]),T=h.useMemo(()=>r?new Map(Array.from(j.entries()).filter(([v])=>v.toLowerCase().includes(r.toLowerCase()))):j,[j,r]),b=I.scaleOrdinal(I.schemeCategory10).domain(j.keys());h.useEffect(()=>{if(!n.current||!u&&A&&s())return;u&&m(!1),I.select(n.current).selectAll("*").remove();const v=new Ms(n.current,T,b,i,l,c,w,f);return x.transform&&v.zoom.transform(v.chartArea,x.transform),v.zoomTo(x.transform??I.zoomIdentity,x.zoomY),v.zoom.on("zoom.saveTransform",R=>{p({transform:R.transform,zoomY:!1})}),g&&v.enableBoxBrush(),v.on("boxSelectEnd",N),()=>{v.cleanup()}},[t,i,l,c,u,g,w]);const N=()=>{k(!g),m(!0)};return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:"Coverage"}),e.jsxs("div",{className:"coverage-graph__controls",style:{marginBottom:"15px"},children:[e.jsx(le,{value:c,onChange:o,options:[{value:"behaviors",content:e.jsxs(e.Fragment,{children:[e.jsx($,{icon:re})," Behaviors"]}),mobileContent:e.jsx($,{icon:re})},{value:"fingerprints",content:e.jsxs(e.Fragment,{children:[e.jsx($,{icon:ie})," Fingerprints"]}),mobileContent:e.jsx($,{icon:ie})}]}),e.jsx(le,{value:l,onChange:d,options:[{value:"inputs",content:e.jsxs(e.Fragment,{children:[e.jsx($,{icon:ae})," Inputs"]}),mobileContent:e.jsx($,{icon:ae})},{value:"time",content:e.jsxs(e.Fragment,{children:[e.jsx($,{icon:oe})," Time"]}),mobileContent:e.jsx($,{icon:oe})}]}),e.jsx(le,{value:i,onChange:a,options:[{value:"linear",content:"Linear"},{value:"log",content:"Log"}]})]}),e.jsx("div",{className:"coverage-graph__tooltip"}),e.jsxs("div",{className:"coverage-graph__grid",style:{marginRight:"15px"},children:[e.jsxs("div",{className:"coverage-graph__label coverage-graph__label--y",children:[e.jsx($,{icon:c==="behaviors"?re:ie,className:"coverage-graph__label__icon"}),c==="behaviors"?"Behaviors":"Fingerprints"]}),e.jsx("svg",{className:"coverage-graph__svg",ref:n,style:{width:"100%",height:"100%"},onMouseEnter:()=>M(!0),onMouseLeave:()=>{M(!1),m(!0)}}),e.jsx("div",{}),e.jsxs("div",{className:"coverage-graph__label coverage-graph__label--x",children:[e.jsx($,{icon:l==="time"?oe:ae,className:"coverage-graph__label__icon"}),l==="time"?"Time (s)":"Inputs"]})]})]})}function Ee({status:t}){return e.jsx("span",{style:{textAlign:"center"},children:t===X.FAILED?e.jsx("span",{className:"pill pill__failure",children:"Failed"}):t===X.SHRINKING?e.jsx("span",{className:"pill pill__warning",children:"Shrinking"}):t===X.RUNNING?e.jsx("span",{className:"pill pill__success",children:"Running"}):e.jsx("span",{className:"pill pill__neutral",children:"Waiting"})})}function q({content:t,tooltip:r}){return e.jsxs("span",{className:"tooltip",children:[t,e.jsx("div",{className:"tooltip__text",children:r})]})}function bt(t){const r=Math.floor(t/3600),s=Math.floor(t%3600/60),n=Math.floor(t%60);return`${r>0?`${r}:${s.toString().padStart(2,"0")}`:s}:${n.toString().padStart(2,"0")}`}function yt(t){const r=t.ninputs(null),s=t.elapsed_time(null);return s===0?null:r/s}function Me(t){var s;if(t.linear_reports.length===0)return{inputs:"—",behaviors:"—",fingerprints:"—",executions:"—",inputsSinceBranch:"—",timeSpent:"—"};const r=yt(t);return{inputs:t.ninputs(null).toLocaleString(),behaviors:t.behaviors.toLocaleString(),fingerprints:t.fingerprints.toLocaleString(),executions:r===null?"—":`${r.toFixed(1).toLocaleString()}/s`,inputsSinceBranch:((s=t.since_new_behavior)==null?void 0:s.toLocaleString())??"—",timeSpent:bt(t.elapsed_time(null))}}de.registerLanguage("python",mt);function Ts({failure:t}){return e.jsx("span",{style:{textAlign:"center"},children:t.state==="shrunk"?e.jsx("span",{className:"pill pill__neutral",children:"Fully shrunk"}):t.state==="unshrunk"?e.jsx("span",{className:"pill pill__neutral",children:"Still shrinking..."}):e.jsx(e.Fragment,{})})}function $s({failure:t}){return e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.7rem",marginBottom:"1rem"},children:[e.jsx("div",{className:"failure__title",children:"Failure"}),e.jsx(Ts,{failure:t})]}),e.jsxs("div",{className:"failure__item",children:[e.jsx("div",{className:"failure__item__subtitle",children:"Call"}),e.jsx("pre",{children:e.jsx("code",{className:"language-python",children:t.observation.metadata.get("reproduction_decorator")+`
`+t.observation.representation})}),e.jsx("div",{className:"failure__item__subtitle",children:"Traceback"}),e.jsx("pre",{children:e.jsx("code",{className:"language-python",children:t.observation.metadata.get("traceback")})})]})]})}function Ls(){const{nodeid:t}=At(),{tests:r,testsLoaded:s}=De(t),n=h.useRef(null),[i,a]=h.useState(null);h.useEffect(()=>{gt().then(o=>{a(o)})},[]);const l=r.get(t)??null;if(h.useEffect(()=>{l&&lt(n)},[l==null?void 0:l.failures]),!t||!l)return e.jsx("div",{children:"Test not found"});const d=Me(l),c=[{content:e.jsx(q,{content:e.jsx("div",{className:"table__header__icon",children:e.jsx($,{icon:ae})}),tooltip:"Number of inputs"})},{content:e.jsx(q,{content:e.jsx("div",{className:"table__header__icon",children:e.jsx($,{icon:re})}),tooltip:"Number of behaviors (typically branches) found"})},{content:e.jsx(q,{content:e.jsx("div",{className:"table__header__icon",children:e.jsx($,{icon:ie})}),tooltip:"Number of fingerprints (sets of behaviors) found"})},{content:e.jsx(q,{content:e.jsx("div",{className:"table__header__icon",children:e.jsx($,{icon:Ze})}),tooltip:"Inputs per second"})},{content:e.jsx(q,{content:e.jsx("div",{className:"table__header__icon",children:e.jsx($,{icon:et})}),tooltip:"Number of inputs since a new behavior"})},{content:e.jsx(q,{content:e.jsx("div",{className:"table__header__icon",children:e.jsx($,{icon:oe})}),tooltip:"Total time spent running"})}];return e.jsxs("div",{ref:n,children:[e.jsxs(Q,{to:"/",className:"back-link",children:[e.jsx($,{icon:Wt})," Back to all tests"]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.7rem"},children:[e.jsx("span",{style:{wordBreak:"break-all",fontSize:"1.5rem",fontWeight:"bold"},children:t}),e.jsx(Ee,{status:l.status})]}),e.jsx("div",{style:{paddingTop:"1rem",paddingBottom:"1rem"},children:e.jsx(Be,{headers:c,data:[d],row:o=>[e.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:o.inputs}),e.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:o.behaviors}),e.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:o.fingerprints}),e.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:o.executions}),e.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:o.inputsSinceBranch}),e.jsx("div",{style:{fontVariantNumeric:"tabular-nums"},children:o.timeSpent})]})})]}),e.jsx(vt,{tests:new Map([[t,l]]),testsLoaded:s}),Array.from(l.failures.values()).map(o=>e.jsx($s,{failure:o})),e.jsx(gs,{test:l}),(i==null?void 0:i.includes(t))&&e.jsx("div",{className:"card",children:e.jsx(Pe,{title:"Patches",defaultState:"closed",headerClass:"card__header",children:e.jsx(xt,{nodeid:t})})})]})}function ee({icon:t,tooltip:r}){return e.jsx(q,{content:e.jsx("div",{className:"table__header__icon",children:e.jsx($,{icon:t})}),tooltip:r})}function ne({icon:t,value:r}){return e.jsxs("div",{className:"table__inline-statistic",children:[t,e.jsx("span",{className:"table__inline-statistic__value",children:r})]})}function Ps({tests:t,onFilterChange:r}){const s=Array.from(t).sortKey(([p,g])=>[g.status,p]).map(([p,g])=>g),n=e.jsx(ee,{icon:ae,tooltip:"Number of inputs"}),i=e.jsx(ee,{icon:re,tooltip:"Number of behaviors (typically branches) found"}),a=e.jsx(ee,{icon:ie,tooltip:"Number of fingerprints (sets of behaviors) found"}),l=e.jsx(ee,{icon:Ze,tooltip:"Inputs per second"}),d=e.jsx(ee,{icon:et,tooltip:"Number of inputs since a new behavior"}),c=e.jsx(ee,{icon:oe,tooltip:"Total time spent running"}),o=[{content:"Test",sortKey:p=>p.nodeid},{content:"Status",sortKey:p=>p.status,align:"center"},{content:n,align:"right",sortKey:p=>p.ninputs(null)},{content:i,align:"right",sortKey:p=>p.behaviors},{content:a,align:"right",sortKey:p=>p.fingerprints},{content:l,align:"right",sortKey:p=>yt(p)??-1},{content:d,align:"right",sortKey:p=>p.since_new_behavior??0},{content:c,align:"right",sortKey:p=>p.elapsed_time(null)}],u=p=>{const g=Me(p);return[e.jsx(Q,{to:`/tests/${encodeURIComponent(p.nodeid)}`,className:"test__link",style:{wordBreak:"break-all"},children:p.nodeid}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(Ee,{status:p.status})}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:g.inputs}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:g.behaviors}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:g.fingerprints}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:g.executions}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:g.inputsSinceBranch}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:g.timeSpent})]};function m(p){const g=Me(p);return e.jsxs("div",{className:"table__mobile-row",children:[e.jsxs("div",{className:"table__mobile-row__header",children:[e.jsx(Q,{to:`/tests/${encodeURIComponent(p.nodeid)}`,className:"test__link",style:{wordBreak:"break-all"},children:p.nodeid}),e.jsx(Ee,{status:p.status})]}),e.jsxs("div",{className:"table__mobile-row__statistics",children:[e.jsx(ne,{icon:n,value:g.inputs}),e.jsx(ne,{icon:i,value:g.behaviors}),e.jsx(ne,{icon:l,value:g.executions}),e.jsx(ne,{icon:d,value:g.inputsSinceBranch}),e.jsx(ne,{icon:c,value:g.timeSpent})]})]})}function x(p){return[p.nodeid,pt[p.status]]}return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:"Tests"}),e.jsx(Be,{headers:o,data:s,row:u,mobileRow:m,filterStrings:x,onFilterChange:r})]})}function Fs(){const{tests:t,testsLoaded:r}=De(),[s,n]=h.useState("");return e.jsxs("div",{className:"dashboard",children:[e.jsx(vt,{tests:t,filterString:s,testsLoaded:r}),e.jsx(Ps,{tests:t,onFilterChange:n})]})}function Is({min:t,max:r,value:s,onChange:n,step:i=1}){const[a,l]=h.useState(null),d=h.useRef(null);console.assert(t<=r,`min: ${t} max: ${r}`);const[c,o]=s,u=r-t,m=u===0?0:(c-t)/u*100,x=u===0?100:(o-t)/u*100,p=m<50?1:2,g=x<50?2:1,k=h.useCallback(j=>{if(!d.current)return t;const T=d.current.getBoundingClientRect(),b=Math.max(0,Math.min(100,(j-T.left)/T.width*100)),N=t+b/100*u,v=Math.round(N/i)*i;return Math.max(t,Math.min(r,v))},[t,r,u,i]),w=j=>T=>{T.preventDefault(),l(j)},f=h.useCallback(j=>{if(!a)return;const T=k(j.clientX);n(a==="min"?[Math.min(T,o),o]:[c,Math.max(T,c)])},[a,k,c,o,n]),A=h.useCallback(()=>{l(null)},[]),M=j=>{if(a)return;const T=k(j.clientX),b=Math.abs(T-c),N=Math.abs(T-o);b<N?n([Math.min(T,o),o]):n([c,Math.max(T,c)])};return h.useEffect(()=>a?(document.addEventListener("mousemove",f),document.addEventListener("mouseup",A),()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",A)}):()=>{},[a,f,A]),e.jsx("div",{className:"range-slider",children:e.jsx("div",{className:"range-slider__container",children:e.jsxs("div",{ref:d,className:"range-slider__track",onClick:M,children:[e.jsx("div",{className:"range-slider__range",style:{left:`${m}%`,width:`${x-m}%`}}),e.jsx("div",{className:"range-slider__thumb range-slider__thumb--min",style:{left:`${m}%`,zIndex:p},onMouseDown:w("min")}),e.jsx("div",{className:"range-slider__thumb range-slider__thumb--max",style:{left:`${x}%`,zIndex:g},onMouseDown:w("max")})]})})})}function fe(t){return new Date(t*1e3).toLocaleString()}const Ds=24*60*60;function Ye(t,r){return[Math.max(t,r-Ds),r]}function Bs(t){let r=0;for(let a=0;a<t.length;a++)r=(r<<5)-r+t.charCodeAt(a)&4294967295;const s=Math.abs(r)%360,n=45+Math.abs(r>>8)%30,i=45+Math.abs(r>>16)%20;return`hsl(${s}, ${n}%, ${i}%)`}function _e({label:t,value:r}){return e.jsxs("div",{className:"workers__worker__details__item",children:[e.jsx("span",{className:"workers__worker__details__label",children:t}),e.jsx("span",{className:"workers__worker__details__value",children:r})]})}function Os(){const{tests:t}=De(),r=Je(),{showTooltip:s,hideTooltip:n,moveTooltip:i}=Le(),[a,l]=h.useState(new Set),d=Kt(Array.from(t.values()).map(b=>Array.from(b.reports_by_worker.keys())).flat().sortKey(b=>b)),c=new Map;d.forEach(b=>{const N=[];c.set(b,N),Array.from(t.values()).forEach(v=>{if(!v.reports_by_worker.has(b))return;const R=v.reports_by_worker.get(b);N.push(...R.map(S=>({timestamp_monotonic:S.timestamp_monotonic,nodeid:v.nodeid})))}),N.sortKey(v=>v.timestamp_monotonic)});let o=1/0,u=-1/0,m=new Map;d.forEach(b=>{const N=c.get(b),v=[];let R=null;N.forEach((S,L)=>{o=Math.min(o,S.timestamp_monotonic),u=Math.max(u,S.timestamp_monotonic),!R||R.nodeid!==S.nodeid?(R&&v.push(R),R={nodeid:S.nodeid,start:S.timestamp_monotonic,end:S.timestamp_monotonic}):R.end=S.timestamp_monotonic,L===N.length-1&&R&&v.push(R)}),m.set(b,v)}),m=new Map([...m.entries()].sortKey(([b,N])=>N[0].start));const[x,p]=h.useState(Ye(o,u));h.useEffect(()=>{p(Ye(o,u))},[o,u]);const[g,k]=x,w=k-g,f=h.useCallback(b=>{let N,v;return w===0?(N=0,v=100):(N=(b.start-g)/w*100,v=(b.end-b.start)/w*100),{left:`${N}%`,width:`${v}%`,backgroundColor:Bs(b.nodeid)}},[w,g,k]),A=h.useMemo(()=>{const b=new Map;for(const[N,v]of m.entries())b.set(N,v.filter(R=>R.end>=g&&R.start<=k));return b},[m,g,k]);function M(b){l(N=>{const v=new Set(N);return v.has(b)?v.delete(b):v.add(b),v})}function j({uuid:b,segments:N}){return e.jsxs("div",{className:`workers__worker ${a.has(b)?"workers__worker--expanded":""}`,onClick:()=>M(b),onMouseLeave:()=>n("workers"),children:[e.jsx("div",{className:"workers__worker__bar",onMouseLeave:()=>n("workers"),children:N.map((v,R)=>e.jsx("div",{className:"workers__timeline__segment",style:f(v),onClick:S=>{ct(S,`/tests/${encodeURIComponent(v.nodeid)}`,r),S.stopPropagation()},onMouseEnter:S=>s(ut(v.nodeid),S.clientX,S.clientY,"workers"),onMouseLeave:()=>n("workers"),onMouseMove:S=>i(S.clientX,S.clientY,"workers")},R))}),a.has(b)&&e.jsx(T,{uuid:b,segments:N})]},b)}function T({uuid:b,segments:N}){return e.jsx("div",{className:"workers__worker__details",children:e.jsxs("div",{className:"workers__worker__details__grid",children:[e.jsx(_e,{label:"Worker UUID",value:b}),e.jsx(_e,{label:"Lifetime",value:bt(N[N.length-1].end-N[0].start)}),e.jsx(_e,{label:"Started",value:fe(N[0].start)}),e.jsx(_e,{label:"Last seen",value:fe(N[N.length-1].end)})]})})}return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card__header",children:"Workers "}),e.jsxs("div",{className:"card__body",children:[e.jsxs("div",{className:"card__text",children:[e.jsx("div",{className:"card__text__paragraph",children:"This page shows the history of your workers, and what tests they have been fuzzing."}),e.jsx("div",{className:"card__text__paragraph",children:'Roughly speaking, "one worker" = "one CPU core".'})]}),e.jsxs("div",{className:"workers",children:[e.jsx("div",{className:"workers__controls",children:e.jsx(Is,{min:o,max:u,value:x,onChange:b=>p(b),step:(u-o)/1e3})}),e.jsxs("div",{className:"workers__timeline-header",children:[e.jsx("span",{className:"workers__timeline-header__label",children:fe(g)}),e.jsx("span",{className:"workers__timeline-header__label",children:fe(k)})]}),Array.from(A.entries()).map(([b,N])=>N.length>0&&e.jsx(j,{uuid:b,segments:N}))]})]})]})}function Us(){const t=Rt;return e.jsx(t,{children:e.jsx(vs,{children:e.jsx(js,{children:e.jsx(as,{children:e.jsx(Ct,{children:e.jsxs(Y,{element:e.jsx(ws,{}),children:[e.jsx(Y,{path:"/",element:e.jsx(Fs,{})}),e.jsx(Y,{path:"/patches",element:e.jsx(Cs,{})}),e.jsx(Y,{path:"/collected",element:e.jsx(ks,{})}),e.jsx(Y,{path:"/workers",element:e.jsx(Os,{})}),e.jsx(Y,{path:"/tests/:nodeid",element:e.jsx(Ls,{})}),e.jsx(Y,{path:"*",element:e.jsx(As,{})})]})})})})})})}rs.createRoot(document.getElementById("app")).render(e.jsx(Et.StrictMode,{children:e.jsx(Us,{})}));
